(self["webpackChunkmy_index_web"]=self["webpackChunkmy_index_web"]||[]).push([[93],{6265:function(t,e,n){t.exports=n(9435)},4951:function(t,e,n){"use strict";n(2801);var i=n(6642),r=n(6806),a=n(3833),o=n(4360),s=n(5047),c=n(5976),h=n(9896),l=n(8507),u=n(3303),f=n(6090),d=n(1874);t.exports=function(t){return new Promise((function(e,n){var p,v=t.data,_=t.headers,m=t.responseType;function y(){t.cancelToken&&t.cancelToken.unsubscribe(p),t.signal&&t.signal.removeEventListener("abort",p)}i.isFormData(v)&&i.isStandardBrowserEnv()&&delete _["Content-Type"];var g=new XMLHttpRequest;if(t.auth){var x=t.auth.username||"",S=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";_.Authorization="Basic "+btoa(x+":"+S)}var k=s(t.baseURL,t.url);function w(){if(g){var i="getAllResponseHeaders"in g?c(g.getAllResponseHeaders()):null,a=m&&"text"!==m&&"json"!==m?g.response:g.responseText,o={data:a,status:g.status,statusText:g.statusText,headers:i,config:t,request:g};r((function(t){e(t),y()}),(function(t){n(t),y()}),o),g=null}}if(g.open(t.method.toUpperCase(),o(k,t.params,t.paramsSerializer),!0),g.timeout=t.timeout,"onloadend"in g?g.onloadend=w:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(w)},g.onabort=function(){g&&(n(new u("Request aborted",u.ECONNABORTED,t,g)),g=null)},g.onerror=function(){n(new u("Network Error",u.ERR_NETWORK,t,g,g)),g=null},g.ontimeout=function(){var e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",i=t.transitional||l;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(new u(e,i.clarifyTimeoutError?u.ETIMEDOUT:u.ECONNABORTED,t,g)),g=null},i.isStandardBrowserEnv()){var b=(t.withCredentials||h(k))&&t.xsrfCookieName?a.read(t.xsrfCookieName):void 0;b&&(_[t.xsrfHeaderName]=b)}"setRequestHeader"in g&&i.forEach(_,(function(t,e){"undefined"===typeof v&&"content-type"===e.toLowerCase()?delete _[e]:g.setRequestHeader(e,t)})),i.isUndefined(t.withCredentials)||(g.withCredentials=!!t.withCredentials),m&&"json"!==m&&(g.responseType=t.responseType),"function"===typeof t.onDownloadProgress&&g.addEventListener("progress",t.onDownloadProgress),"function"===typeof t.onUploadProgress&&g.upload&&g.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(p=function(t){g&&(n(!t||t&&t.type?new f:t),g.abort(),g=null)},t.cancelToken&&t.cancelToken.subscribe(p),t.signal&&(t.signal.aborted?p():t.signal.addEventListener("abort",p))),v||(v=null);var E=d(k);E&&-1===["http","https","file"].indexOf(E)?n(new u("Unsupported protocol "+E+":",u.ERR_BAD_REQUEST,t)):g.send(v)}))}},9435:function(t,e,n){"use strict";var i=n(6642),r=n(5955),a=n(7104),o=n(8186),s=n(7);function c(t){var e=new a(t),n=r(a.prototype.request,e);return i.extend(n,a.prototype,e),i.extend(n,e),n.create=function(e){return c(o(t,e))},n}var h=c(s);h.Axios=a,h.CanceledError=n(6090),h.CancelToken=n(6016),h.isCancel=n(5936),h.VERSION=n(4679).version,h.toFormData=n(8994),h.AxiosError=n(3303),h.Cancel=h.CanceledError,h.all=function(t){return Promise.all(t)},h.spread=n(5431),h.isAxiosError=n(786),t.exports=h,t.exports["default"]=h},6016:function(t,e,n){"use strict";n(1703);var i=n(6090);function r(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;this.promise.then((function(t){if(n._listeners){var e,i=n._listeners.length;for(e=0;e<i;e++)n._listeners[e](t);n._listeners=null}})),this.promise.then=function(t){var e,i=new Promise((function(t){n.subscribe(t),e=t})).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t((function(t){n.reason||(n.reason=new i(t),e(n.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.prototype.subscribe=function(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]},r.prototype.unsubscribe=function(t){if(this._listeners){var e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}},r.source=function(){var t,e=new r((function(e){t=e}));return{token:e,cancel:t}},t.exports=r},6090:function(t,e,n){"use strict";var i=n(3303),r=n(6642);function a(t){i.call(this,null==t?"canceled":t,i.ERR_CANCELED),this.name="CanceledError"}r.inherits(a,i,{__CANCEL__:!0}),t.exports=a},5936:function(t){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},7104:function(t,e,n){"use strict";var i=n(6642),r=n(4360),a=n(999),o=n(6559),s=n(8186),c=n(5047),h=n(6298),l=h.validators;function u(t){this.defaults=t,this.interceptors={request:new a,response:new a}}u.prototype.request=function(t,e){"string"===typeof t?(e=e||{},e.url=t):e=t||{},e=s(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var n=e.transitional;void 0!==n&&h.assertOptions(n,{silentJSONParsing:l.transitional(l.boolean),forcedJSONParsing:l.transitional(l.boolean),clarifyTimeoutError:l.transitional(l.boolean)},!1);var i=[],r=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,i.unshift(t.fulfilled,t.rejected))}));var a,c=[];if(this.interceptors.response.forEach((function(t){c.push(t.fulfilled,t.rejected)})),!r){var u=[o,void 0];Array.prototype.unshift.apply(u,i),u=u.concat(c),a=Promise.resolve(e);while(u.length)a=a.then(u.shift(),u.shift());return a}var f=e;while(i.length){var d=i.shift(),p=i.shift();try{f=d(f)}catch(v){p(v);break}}try{a=o(f)}catch(v){return Promise.reject(v)}while(c.length)a=a.then(c.shift(),c.shift());return a},u.prototype.getUri=function(t){t=s(this.defaults,t);var e=c(t.baseURL,t.url);return r(e,t.params,t.paramsSerializer)},i.forEach(["delete","get","head","options"],(function(t){u.prototype[t]=function(e,n){return this.request(s(n||{},{method:t,url:e,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(t){function e(e){return function(n,i,r){return this.request(s(r||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}u.prototype[t]=e(),u.prototype[t+"Form"]=e(!0)})),t.exports=u},3303:function(t,e,n){"use strict";n(1703);var i=n(6642);function r(t,e,n,i,r){Error.call(this),this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r)}i.inherits(r,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var a=r.prototype,o={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(t){o[t]={value:t}})),Object.defineProperties(r,o),Object.defineProperty(a,"isAxiosError",{value:!0}),r.from=function(t,e,n,o,s,c){var h=Object.create(a);return i.toFlatObject(t,h,(function(t){return t!==Error.prototype})),r.call(h,t.message,e,n,o,s),h.name=t.name,c&&Object.assign(h,c),h},t.exports=r},999:function(t,e,n){"use strict";var i=n(6642);function r(){this.handlers=[]}r.prototype.use=function(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},r.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},r.prototype.forEach=function(t){i.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=r},5047:function(t,e,n){"use strict";var i=n(4777),r=n(2381);t.exports=function(t,e){return t&&!i(e)?r(t,e):e}},6559:function(t,e,n){"use strict";var i=n(6642),r=n(3756),a=n(5936),o=n(7),s=n(6090);function c(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new s}t.exports=function(t){c(t),t.headers=t.headers||{},t.data=r.call(t,t.data,t.headers,t.transformRequest),t.headers=i.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]}));var e=t.adapter||o.adapter;return e(t).then((function(e){return c(t),e.data=r.call(t,e.data,e.headers,t.transformResponse),e}),(function(e){return a(e)||(c(t),e&&e.response&&(e.response.data=r.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},8186:function(t,e,n){"use strict";var i=n(6642);t.exports=function(t,e){e=e||{};var n={};function r(t,e){return i.isPlainObject(t)&&i.isPlainObject(e)?i.merge(t,e):i.isPlainObject(e)?i.merge({},e):i.isArray(e)?e.slice():e}function a(n){return i.isUndefined(e[n])?i.isUndefined(t[n])?void 0:r(void 0,t[n]):r(t[n],e[n])}function o(t){if(!i.isUndefined(e[t]))return r(void 0,e[t])}function s(n){return i.isUndefined(e[n])?i.isUndefined(t[n])?void 0:r(void 0,t[n]):r(void 0,e[n])}function c(n){return n in e?r(t[n],e[n]):n in t?r(void 0,t[n]):void 0}var h={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:c};return i.forEach(Object.keys(t).concat(Object.keys(e)),(function(t){var e=h[t]||a,r=e(t);i.isUndefined(r)&&e!==c||(n[t]=r)})),n}},6806:function(t,e,n){"use strict";var i=n(3303);t.exports=function(t,e,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?e(new i("Request failed with status code "+n.status,[i.ERR_BAD_REQUEST,i.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}},3756:function(t,e,n){"use strict";var i=n(6642),r=n(7);t.exports=function(t,e,n){var a=this||r;return i.forEach(n,(function(n){t=n.call(a,t,e)})),t}},7:function(t,e,n){"use strict";var i=n(6642),r=n(1446),a=n(3303),o=n(8507),s=n(8994),c={"Content-Type":"application/x-www-form-urlencoded"};function h(t,e){!i.isUndefined(t)&&i.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function l(){var t;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(t=n(4951)),t}function u(t,e,n){if(i.isString(t))try{return(e||JSON.parse)(t),i.trim(t)}catch(r){if("SyntaxError"!==r.name)throw r}return(n||JSON.stringify)(t)}var f={transitional:o,adapter:l(),transformRequest:[function(t,e){if(r(e,"Accept"),r(e,"Content-Type"),i.isFormData(t)||i.isArrayBuffer(t)||i.isBuffer(t)||i.isStream(t)||i.isFile(t)||i.isBlob(t))return t;if(i.isArrayBufferView(t))return t.buffer;if(i.isURLSearchParams(t))return h(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var n,a=i.isObject(t),o=e&&e["Content-Type"];if((n=i.isFileList(t))||a&&"multipart/form-data"===o){var c=this.env&&this.env.FormData;return s(n?{"files[]":t}:t,c&&new c)}return a||"application/json"===o?(h(e,"application/json"),u(t)):t}],transformResponse:[function(t){var e=this.transitional||f.transitional,n=e&&e.silentJSONParsing,r=e&&e.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||r&&i.isString(t)&&t.length)try{return JSON.parse(t)}catch(s){if(o){if("SyntaxError"===s.name)throw a.from(s,a.ERR_BAD_RESPONSE,this,null,this.response);throw s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:n(1051)},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(t){f.headers[t]={}})),i.forEach(["post","put","patch"],(function(t){f.headers[t]=i.merge(c)})),t.exports=f},8507:function(t){"use strict";t.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},4679:function(t){t.exports={version:"0.27.2"}},5955:function(t){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return t.apply(e,n)}}},4360:function(t,e,n){"use strict";var i=n(6642);function r(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var a;if(n)a=n(e);else if(i.isURLSearchParams(e))a=e.toString();else{var o=[];i.forEach(e,(function(t,e){null!==t&&"undefined"!==typeof t&&(i.isArray(t)?e+="[]":t=[t],i.forEach(t,(function(t){i.isDate(t)?t=t.toISOString():i.isObject(t)&&(t=JSON.stringify(t)),o.push(r(e)+"="+r(t))})))})),a=o.join("&")}if(a){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+a}return t}},2381:function(t){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},3833:function(t,e,n){"use strict";var i=n(6642);t.exports=i.isStandardBrowserEnv()?function(){return{write:function(t,e,n,r,a,o){var s=[];s.push(t+"="+encodeURIComponent(e)),i.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),i.isString(r)&&s.push("path="+r),i.isString(a)&&s.push("domain="+a),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},4777:function(t){"use strict";t.exports=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}},786:function(t,e,n){"use strict";var i=n(6642);t.exports=function(t){return i.isObject(t)&&!0===t.isAxiosError}},9896:function(t,e,n){"use strict";var i=n(6642);t.exports=i.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(t){var i=t;return e&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=r(window.location.href),function(e){var n=i.isString(e)?r(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return function(){return!0}}()},1446:function(t,e,n){"use strict";var i=n(6642);t.exports=function(t,e){i.forEach(t,(function(n,i){i!==e&&i.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[i])}))}},1051:function(t){t.exports=null},5976:function(t,e,n){"use strict";var i=n(6642),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,a,o={};return t?(i.forEach(t.split("\n"),(function(t){if(a=t.indexOf(":"),e=i.trim(t.substr(0,a)).toLowerCase(),n=i.trim(t.substr(a+1)),e){if(o[e]&&r.indexOf(e)>=0)return;o[e]="set-cookie"===e?(o[e]?o[e]:[]).concat([n]):o[e]?o[e]+", "+n:n}})),o):o}},1874:function(t){"use strict";t.exports=function(t){var e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}},5431:function(t){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},8994:function(t,e,n){"use strict";n(1703);var i=n(6642);function r(t,e){e=e||new FormData;var n=[];function r(t){return null===t?"":i.isDate(t)?t.toISOString():i.isArrayBuffer(t)||i.isTypedArray(t)?"function"===typeof Blob?new Blob([t]):Buffer.from(t):t}function a(t,o){if(i.isPlainObject(t)||i.isArray(t)){if(-1!==n.indexOf(t))throw Error("Circular reference detected in "+o);n.push(t),i.forEach(t,(function(t,n){if(!i.isUndefined(t)){var s,c=o?o+"."+n:n;if(t&&!o&&"object"===typeof t)if(i.endsWith(n,"{}"))t=JSON.stringify(t);else if(i.endsWith(n,"[]")&&(s=i.toArray(t)))return void s.forEach((function(t){!i.isUndefined(t)&&e.append(c,r(t))}));a(t,c)}})),n.pop()}else e.append(o,r(t))}return a(t),e}t.exports=r},6298:function(t,e,n){"use strict";var i=n(4679).version,r=n(3303),a={};["object","boolean","number","function","string","symbol"].forEach((function(t,e){a[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));var o={};function s(t,e,n){if("object"!==typeof t)throw new r("options must be an object",r.ERR_BAD_OPTION_VALUE);var i=Object.keys(t),a=i.length;while(a-- >0){var o=i[a],s=e[o];if(s){var c=t[o],h=void 0===c||s(c,o,t);if(!0!==h)throw new r("option "+o+" must be "+h,r.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new r("Unknown option "+o,r.ERR_BAD_OPTION)}}a.transitional=function(t,e,n){function a(t,e){return"[Axios v"+i+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return function(n,i,s){if(!1===t)throw new r(a(i," has been removed"+(e?" in "+e:"")),r.ERR_DEPRECATED);return e&&!o[i]&&(o[i]=!0,console.warn(a(i," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,i,s)}},t.exports={assertOptions:s,validators:a}},6642:function(t,e,n){"use strict";n(8675),n(3462),n(7380),n(1118);var i=n(5955),r=Object.prototype.toString,a=function(t){return function(e){var n=r.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())}}(Object.create(null));function o(t){return t=t.toLowerCase(),function(e){return a(e)===t}}function s(t){return Array.isArray(t)}function c(t){return"undefined"===typeof t}function h(t){return null!==t&&!c(t)&&null!==t.constructor&&!c(t.constructor)&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var l=o("ArrayBuffer");function u(t){var e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&l(t.buffer),e}function f(t){return"string"===typeof t}function d(t){return"number"===typeof t}function p(t){return null!==t&&"object"===typeof t}function v(t){if("object"!==a(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}var _=o("Date"),m=o("File"),y=o("Blob"),g=o("FileList");function x(t){return"[object Function]"===r.call(t)}function S(t){return p(t)&&x(t.pipe)}function k(t){var e="[object FormData]";return t&&("function"===typeof FormData&&t instanceof FormData||r.call(t)===e||x(t.toString)&&t.toString()===e)}var w=o("URLSearchParams");function b(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function E(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)}function P(t,e){if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),s(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(null,t[r],r,t)}function C(){var t={};function e(e,n){v(t[n])&&v(e)?t[n]=C(t[n],e):v(e)?t[n]=C({},e):s(e)?t[n]=e.slice():t[n]=e}for(var n=0,i=arguments.length;n<i;n++)P(arguments[n],e);return t}function A(t,e,n){return P(e,(function(e,r){t[r]=n&&"function"===typeof e?i(e,n):e})),t}function O(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}function T(t,e,n,i){t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,n&&Object.assign(t.prototype,n)}function I(t,e,n){var i,r,a,o={};e=e||{};do{i=Object.getOwnPropertyNames(t),r=i.length;while(r-- >0)a=i[r],o[a]||(e[a]=t[a],o[a]=!0);t=Object.getPrototypeOf(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e}function D(t,e,n){t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;var i=t.indexOf(e,n);return-1!==i&&i===n}function M(t){if(!t)return null;var e=t.length;if(c(e))return null;var n=new Array(e);while(e-- >0)n[e]=t[e];return n}var R=function(t){return function(e){return t&&e instanceof t}}("undefined"!==typeof Uint8Array&&Object.getPrototypeOf(Uint8Array));t.exports={isArray:s,isArrayBuffer:l,isBuffer:h,isFormData:k,isArrayBufferView:u,isString:f,isNumber:d,isObject:p,isPlainObject:v,isUndefined:c,isDate:_,isFile:m,isBlob:y,isFunction:x,isStream:S,isURLSearchParams:w,isStandardBrowserEnv:E,forEach:P,merge:C,extend:A,trim:b,stripBOM:O,inherits:T,toFlatObject:I,kindOf:a,kindOfTest:o,endsWith:D,toArray:M,isTypedArray:R,isFileList:g}},7629:function(t,e,n){var i;n(1703),n(8675),n(3462),n(7380),n(1118),function(r){"use strict";var a,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,c=Math.floor,h="[BigNumber Error] ",l=h+"Number primitive has more than 15 significant digits: ",u=1e14,f=14,d=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,_=1e9;function m(t){var e,n,i,r=N.prototype={constructor:N,toString:null,valueOf:null},a=new N(1),E=20,P=4,C=-7,A=21,O=-1e7,T=1e7,I=!1,D=1,M=0,R={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},L="0123456789abcdefghijklmnopqrstuvwxyz",B=!0;function N(t,e){var r,a,s,h,u,p,v,_,m=this;if(!(m instanceof N))return new N(t,e);if(null==e){if(t&&!0===t._isBigNumber)return m.s=t.s,void(!t.c||t.e>T?m.c=m.e=null:t.e<O?m.c=[m.e=0]:(m.e=t.e,m.c=t.c.slice()));if((p="number"==typeof t)&&0*t==0){if(m.s=1/t<0?(t=-t,-1):1,t===~~t){for(h=0,u=t;u>=10;u/=10,h++);return void(h>T?m.c=m.e=null:(m.e=h,m.c=[t]))}_=String(t)}else{if(!o.test(_=String(t)))return i(m,_,p);m.s=45==_.charCodeAt(0)?(_=_.slice(1),-1):1}(h=_.indexOf("."))>-1&&(_=_.replace(".","")),(u=_.search(/e/i))>0?(h<0&&(h=u),h+=+_.slice(u+1),_=_.substring(0,u)):h<0&&(h=_.length)}else{if(S(e,2,L.length,"Base"),10==e&&B)return m=new N(t),V(m,E+m.e+1,P);if(_=String(t),p="number"==typeof t){if(0*t!=0)return i(m,_,p,e);if(m.s=1/t<0?(_=_.slice(1),-1):1,N.DEBUG&&_.replace(/^0\.0*|\./,"").length>15)throw Error(l+t)}else m.s=45===_.charCodeAt(0)?(_=_.slice(1),-1):1;for(r=L.slice(0,e),h=u=0,v=_.length;u<v;u++)if(r.indexOf(a=_.charAt(u))<0){if("."==a){if(u>h){h=v;continue}}else if(!s&&(_==_.toUpperCase()&&(_=_.toLowerCase())||_==_.toLowerCase()&&(_=_.toUpperCase()))){s=!0,u=-1,h=0;continue}return i(m,String(t),p,e)}p=!1,_=n(_,e,10,m.s),(h=_.indexOf("."))>-1?_=_.replace(".",""):h=_.length}for(u=0;48===_.charCodeAt(u);u++);for(v=_.length;48===_.charCodeAt(--v););if(_=_.slice(u,++v)){if(v-=u,p&&N.DEBUG&&v>15&&(t>d||t!==c(t)))throw Error(l+m.s*t);if((h=h-u-1)>T)m.c=m.e=null;else if(h<O)m.c=[m.e=0];else{if(m.e=h,m.c=[],u=(h+1)%f,h<0&&(u+=f),u<v){for(u&&m.c.push(+_.slice(0,u)),v-=f;u<v;)m.c.push(+_.slice(u,u+=f));u=f-(_=_.slice(u)).length}else u-=v;for(;u--;_+="0");m.c.push(+_)}}else m.c=[m.e=0]}function F(t,e,n,i){var r,a,o,s,c;if(null==n?n=P:S(n,0,8),!t.c)return t.toString();if(r=t.c[0],o=t.e,null==e)c=g(t.c),c=1==i||2==i&&(o<=C||o>=A)?w(c,o):b(c,o,"0");else if(t=V(new N(t),e,n),a=t.e,c=g(t.c),s=c.length,1==i||2==i&&(e<=a||a<=C)){for(;s<e;c+="0",s++);c=w(c,a)}else if(e-=o,c=b(c,a,"0"),a+1>s){if(--e>0)for(c+=".";e--;c+="0");}else if(e+=a-s,e>0)for(a+1==s&&(c+=".");e--;c+="0");return t.s<0&&r?"-"+c:c}function j(t,e){for(var n,i=1,r=new N(t[0]);i<t.length;i++){if(n=new N(t[i]),!n.s){r=n;break}e.call(r,n)&&(r=n)}return r}function z(t,e,n){for(var i=1,r=e.length;!e[--r];e.pop());for(r=e[0];r>=10;r/=10,i++);return(n=i+n*f-1)>T?t.c=t.e=null:n<O?t.c=[t.e=0]:(t.e=n,t.c=e),t}function V(t,e,n,i){var r,a,o,h,l,d,v,_=t.c,m=p;if(_){t:{for(r=1,h=_[0];h>=10;h/=10,r++);if(a=e-r,a<0)a+=f,o=e,l=_[d=0],v=l/m[r-o-1]%10|0;else if(d=s((a+1)/f),d>=_.length){if(!i)break t;for(;_.length<=d;_.push(0));l=v=0,r=1,a%=f,o=a-f+1}else{for(l=h=_[d],r=1;h>=10;h/=10,r++);a%=f,o=a-f+r,v=o<0?0:l/m[r-o-1]%10|0}if(i=i||e<0||null!=_[d+1]||(o<0?l:l%m[r-o-1]),i=n<4?(v||i)&&(0==n||n==(t.s<0?3:2)):v>5||5==v&&(4==n||i||6==n&&(a>0?o>0?l/m[r-o]:0:_[d-1])%10&1||n==(t.s<0?8:7)),e<1||!_[0])return _.length=0,i?(e-=t.e+1,_[0]=m[(f-e%f)%f],t.e=-e||0):_[0]=t.e=0,t;if(0==a?(_.length=d,h=1,d--):(_.length=d+1,h=m[f-a],_[d]=o>0?c(l/m[r-o]%m[o])*h:0),i)for(;;){if(0==d){for(a=1,o=_[0];o>=10;o/=10,a++);for(o=_[0]+=h,h=1;o>=10;o/=10,h++);a!=h&&(t.e++,_[0]==u&&(_[0]=1));break}if(_[d]+=h,_[d]!=u)break;_[d--]=0,h=1}for(a=_.length;0===_[--a];_.pop());}t.e>T?t.c=t.e=null:t.e<O&&(t.c=[t.e=0])}return t}function H(t){var e,n=t.e;return null===n?t.toString():(e=g(t.c),e=n<=C||n>=A?w(e,n):b(e,n,"0"),t.s<0?"-"+e:e)}return N.clone=m,N.ROUND_UP=0,N.ROUND_DOWN=1,N.ROUND_CEIL=2,N.ROUND_FLOOR=3,N.ROUND_HALF_UP=4,N.ROUND_HALF_DOWN=5,N.ROUND_HALF_EVEN=6,N.ROUND_HALF_CEIL=7,N.ROUND_HALF_FLOOR=8,N.EUCLID=9,N.config=N.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(h+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(n=t[e],S(n,0,_,e),E=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(n=t[e],S(n,0,8,e),P=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&(n=t[e],n&&n.pop?(S(n[0],-_,0,e),S(n[1],0,_,e),C=n[0],A=n[1]):(S(n,-_,_,e),C=-(A=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if(n=t[e],n&&n.pop)S(n[0],-_,-1,e),S(n[1],1,_,e),O=n[0],T=n[1];else{if(S(n,-_,_,e),!n)throw Error(h+e+" cannot be zero: "+n);O=-(T=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if(n=t[e],n!==!!n)throw Error(h+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw I=!n,Error(h+"crypto unavailable");I=n}else I=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(n=t[e],S(n,0,9,e),D=n),t.hasOwnProperty(e="POW_PRECISION")&&(n=t[e],S(n,0,_,e),M=n),t.hasOwnProperty(e="FORMAT")){if(n=t[e],"object"!=typeof n)throw Error(h+e+" not an object: "+n);R=n}if(t.hasOwnProperty(e="ALPHABET")){if(n=t[e],"string"!=typeof n||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(h+e+" invalid: "+n);B="0123456789"==n.slice(0,10),L=n}}return{DECIMAL_PLACES:E,ROUNDING_MODE:P,EXPONENTIAL_AT:[C,A],RANGE:[O,T],CRYPTO:I,MODULO_MODE:D,POW_PRECISION:M,FORMAT:R,ALPHABET:L}},N.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!N.DEBUG)return!0;var e,n,i=t.c,r=t.e,a=t.s;t:if("[object Array]"=={}.toString.call(i)){if((1===a||-1===a)&&r>=-_&&r<=_&&r===c(r)){if(0===i[0]){if(0===r&&1===i.length)return!0;break t}if(e=(r+1)%f,e<1&&(e+=f),String(i[0]).length==e){for(e=0;e<i.length;e++)if(n=i[e],n<0||n>=u||n!==c(n))break t;if(0!==n)return!0}}}else if(null===i&&null===r&&(null===a||1===a||-1===a))return!0;throw Error(h+"Invalid BigNumber: "+t)},N.maximum=N.max=function(){return j(arguments,r.lt)},N.minimum=N.min=function(){return j(arguments,r.gt)},N.random=function(){var t=9007199254740992,e=Math.random()*t&2097151?function(){return c(Math.random()*t)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(t){var n,i,r,o,l,u=0,d=[],v=new N(a);if(null==t?t=E:S(t,0,_),o=s(t/f),I)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(o*=2));u<o;)l=131072*n[u]+(n[u+1]>>>11),l>=9e15?(i=crypto.getRandomValues(new Uint32Array(2)),n[u]=i[0],n[u+1]=i[1]):(d.push(l%1e14),u+=2);u=o/2}else{if(!crypto.randomBytes)throw I=!1,Error(h+"crypto unavailable");for(n=crypto.randomBytes(o*=7);u<o;)l=281474976710656*(31&n[u])+1099511627776*n[u+1]+4294967296*n[u+2]+16777216*n[u+3]+(n[u+4]<<16)+(n[u+5]<<8)+n[u+6],l>=9e15?crypto.randomBytes(7).copy(n,u):(d.push(l%1e14),u+=7);u=o/7}if(!I)for(;u<o;)l=e(),l<9e15&&(d[u++]=l%1e14);for(o=d[--u],t%=f,o&&t&&(l=p[f-t],d[u]=c(o/l)*l);0===d[u];d.pop(),u--);if(u<0)d=[r=0];else{for(r=-1;0===d[0];d.splice(0,1),r-=f);for(u=1,l=d[0];l>=10;l/=10,u++);u<f&&(r-=f-u)}return v.e=r,v.c=d,v}}(),N.sum=function(){for(var t=1,e=arguments,n=new N(e[0]);t<e.length;)n=n.plus(e[t++]);return n},n=function(){var t="0123456789";function n(t,e,n,i){for(var r,a,o=[0],s=0,c=t.length;s<c;){for(a=o.length;a--;o[a]*=e);for(o[0]+=i.indexOf(t.charAt(s++)),r=0;r<o.length;r++)o[r]>n-1&&(null==o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}return function(i,r,a,o,s){var c,h,l,u,f,d,p,v,_=i.indexOf("."),m=E,y=P;for(_>=0&&(u=M,M=0,i=i.replace(".",""),v=new N(r),d=v.pow(i.length-_),M=u,v.c=n(b(g(d.c),d.e,"0"),10,a,t),v.e=v.c.length),p=n(i,r,a,s?(c=L,t):(c=t,L)),l=u=p.length;0==p[--u];p.pop());if(!p[0])return c.charAt(0);if(_<0?--l:(d.c=p,d.e=l,d.s=o,d=e(d,v,m,y,a),p=d.c,f=d.r,l=d.e),h=l+m+1,_=p[h],u=a/2,f=f||h<0||null!=p[h+1],f=y<4?(null!=_||f)&&(0==y||y==(d.s<0?3:2)):_>u||_==u&&(4==y||f||6==y&&1&p[h-1]||y==(d.s<0?8:7)),h<1||!p[0])i=f?b(c.charAt(1),-m,c.charAt(0)):c.charAt(0);else{if(p.length=h,f)for(--a;++p[--h]>a;)p[h]=0,h||(++l,p=[1].concat(p));for(u=p.length;!p[--u];);for(_=0,i="";_<=u;i+=c.charAt(p[_++]));i=b(i,l,c.charAt(0))}return i}}(),e=function(){function t(t,e,n){var i,r,a,o,s=0,c=t.length,h=e%v,l=e/v|0;for(t=t.slice();c--;)a=t[c]%v,o=t[c]/v|0,i=l*a+o*h,r=h*a+i%v*v+s,s=(r/n|0)+(i/v|0)+l*o,t[c]=r%n;return s&&(t=[s].concat(t)),t}function e(t,e,n,i){var r,a;if(n!=i)a=n>i?1:-1;else for(r=a=0;r<n;r++)if(t[r]!=e[r]){a=t[r]>e[r]?1:-1;break}return a}function n(t,e,n,i){for(var r=0;n--;)t[n]-=r,r=t[n]<e[n]?1:0,t[n]=r*i+t[n]-e[n];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(i,r,a,o,s){var h,l,d,p,v,_,m,g,x,S,k,w,b,E,P,C,A,O=i.s==r.s?1:-1,T=i.c,I=r.c;if(!T||!T[0]||!I||!I[0])return new N(i.s&&r.s&&(T?!I||T[0]!=I[0]:I)?T&&0==T[0]||!I?0*O:O/0:NaN);for(g=new N(O),x=g.c=[],l=i.e-r.e,O=a+l+1,s||(s=u,l=y(i.e/f)-y(r.e/f),O=O/f|0),d=0;I[d]==(T[d]||0);d++);if(I[d]>(T[d]||0)&&l--,O<0)x.push(1),p=!0;else{for(E=T.length,C=I.length,d=0,O+=2,v=c(s/(I[0]+1)),v>1&&(I=t(I,v,s),T=t(T,v,s),C=I.length,E=T.length),b=C,S=T.slice(0,C),k=S.length;k<C;S[k++]=0);A=I.slice(),A=[0].concat(A),P=I[0],I[1]>=s/2&&P++;do{if(v=0,h=e(I,S,C,k),h<0){if(w=S[0],C!=k&&(w=w*s+(S[1]||0)),v=c(w/P),v>1){v>=s&&(v=s-1),_=t(I,v,s),m=_.length,k=S.length;while(1==e(_,S,m,k))v--,n(_,C<m?A:I,m,s),m=_.length,h=1}else 0==v&&(h=v=1),_=I.slice(),m=_.length;if(m<k&&(_=[0].concat(_)),n(S,_,k,s),k=S.length,-1==h)while(e(I,S,C,k)<1)v++,n(S,C<k?A:I,k,s),k=S.length}else 0===h&&(v++,S=[0]);x[d++]=v,S[0]?S[k++]=T[b]||0:(S=[T[b]],k=1)}while((b++<E||null!=S[0])&&O--);p=null!=S[0],x[0]||x.splice(0,1)}if(s==u){for(d=1,O=x[0];O>=10;O/=10,d++);V(g,a+(g.e=d+l*f-1)+1,o,p)}else g.e=l,g.r=+p;return g}}(),i=function(){var t=/^(-?)0([xbo])(?=\w[\w.]*$)/i,e=/^([^.]+)\.$/,n=/^\.([^.]+)$/,i=/^-?(Infinity|NaN)$/,r=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(a,o,s,c){var l,u=s?o:o.replace(r,"");if(i.test(u))a.s=isNaN(u)?null:u<0?-1:1;else{if(!s&&(u=u.replace(t,(function(t,e,n){return l="x"==(n=n.toLowerCase())?16:"b"==n?2:8,c&&c!=l?t:e})),c&&(l=c,u=u.replace(e,"$1").replace(n,"0.$1")),o!=u))return new N(u,l);if(N.DEBUG)throw Error(h+"Not a"+(c?" base "+c:"")+" number: "+o);a.s=null}a.c=a.e=null}}(),r.absoluteValue=r.abs=function(){var t=new N(this);return t.s<0&&(t.s=1),t},r.comparedTo=function(t,e){return x(this,new N(t,e))},r.decimalPlaces=r.dp=function(t,e){var n,i,r,a=this;if(null!=t)return S(t,0,_),null==e?e=P:S(e,0,8),V(new N(a),t+a.e+1,e);if(!(n=a.c))return null;if(i=((r=n.length-1)-y(this.e/f))*f,r=n[r])for(;r%10==0;r/=10,i--);return i<0&&(i=0),i},r.dividedBy=r.div=function(t,n){return e(this,new N(t,n),E,P)},r.dividedToIntegerBy=r.idiv=function(t,n){return e(this,new N(t,n),0,1)},r.exponentiatedBy=r.pow=function(t,e){var n,i,r,o,l,u,d,p,v,_=this;if(t=new N(t),t.c&&!t.isInteger())throw Error(h+"Exponent not an integer: "+H(t));if(null!=e&&(e=new N(e)),u=t.e>14,!_.c||!_.c[0]||1==_.c[0]&&!_.e&&1==_.c.length||!t.c||!t.c[0])return v=new N(Math.pow(+H(_),u?2-k(t):+H(t))),e?v.mod(e):v;if(d=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new N(NaN);i=!d&&_.isInteger()&&e.isInteger(),i&&(_=_.mod(e))}else{if(t.e>9&&(_.e>0||_.e<-1||(0==_.e?_.c[0]>1||u&&_.c[1]>=24e7:_.c[0]<8e13||u&&_.c[0]<=9999975e7)))return o=_.s<0&&k(t)?-0:0,_.e>-1&&(o=1/o),new N(d?1/o:o);M&&(o=s(M/f+2))}for(u?(n=new N(.5),d&&(t.s=1),p=k(t)):(r=Math.abs(+H(t)),p=r%2),v=new N(a);;){if(p){if(v=v.times(_),!v.c)break;o?v.c.length>o&&(v.c.length=o):i&&(v=v.mod(e))}if(r){if(r=c(r/2),0===r)break;p=r%2}else if(t=t.times(n),V(t,t.e+1,1),t.e>14)p=k(t);else{if(r=+H(t),0===r)break;p=r%2}_=_.times(_),o?_.c&&_.c.length>o&&(_.c.length=o):i&&(_=_.mod(e))}return i?v:(d&&(v=a.div(v)),e?v.mod(e):o?V(v,M,P,l):v)},r.integerValue=function(t){var e=new N(this);return null==t?t=P:S(t,0,8),V(e,e.e+1,t)},r.isEqualTo=r.eq=function(t,e){return 0===x(this,new N(t,e))},r.isFinite=function(){return!!this.c},r.isGreaterThan=r.gt=function(t,e){return x(this,new N(t,e))>0},r.isGreaterThanOrEqualTo=r.gte=function(t,e){return 1===(e=x(this,new N(t,e)))||0===e},r.isInteger=function(){return!!this.c&&y(this.e/f)>this.c.length-2},r.isLessThan=r.lt=function(t,e){return x(this,new N(t,e))<0},r.isLessThanOrEqualTo=r.lte=function(t,e){return-1===(e=x(this,new N(t,e)))||0===e},r.isNaN=function(){return!this.s},r.isNegative=function(){return this.s<0},r.isPositive=function(){return this.s>0},r.isZero=function(){return!!this.c&&0==this.c[0]},r.minus=function(t,e){var n,i,r,a,o=this,s=o.s;if(t=new N(t,e),e=t.s,!s||!e)return new N(NaN);if(s!=e)return t.s=-e,o.plus(t);var c=o.e/f,h=t.e/f,l=o.c,d=t.c;if(!c||!h){if(!l||!d)return l?(t.s=-e,t):new N(d?o:NaN);if(!l[0]||!d[0])return d[0]?(t.s=-e,t):new N(l[0]?o:3==P?-0:0)}if(c=y(c),h=y(h),l=l.slice(),s=c-h){for((a=s<0)?(s=-s,r=l):(h=c,r=d),r.reverse(),e=s;e--;r.push(0));r.reverse()}else for(i=(a=(s=l.length)<(e=d.length))?s:e,s=e=0;e<i;e++)if(l[e]!=d[e]){a=l[e]<d[e];break}if(a&&(r=l,l=d,d=r,t.s=-t.s),e=(i=d.length)-(n=l.length),e>0)for(;e--;l[n++]=0);for(e=u-1;i>s;){if(l[--i]<d[i]){for(n=i;n&&!l[--n];l[n]=e);--l[n],l[i]+=u}l[i]-=d[i]}for(;0==l[0];l.splice(0,1),--h);return l[0]?z(t,l,h):(t.s=3==P?-1:1,t.c=[t.e=0],t)},r.modulo=r.mod=function(t,n){var i,r,a=this;return t=new N(t,n),!a.c||!t.s||t.c&&!t.c[0]?new N(NaN):!t.c||a.c&&!a.c[0]?new N(a):(9==D?(r=t.s,t.s=1,i=e(a,t,0,3),t.s=r,i.s*=r):i=e(a,t,0,D),t=a.minus(i.times(t)),t.c[0]||1!=D||(t.s=a.s),t)},r.multipliedBy=r.times=function(t,e){var n,i,r,a,o,s,c,h,l,d,p,_,m,g,x,S=this,k=S.c,w=(t=new N(t,e)).c;if(!k||!w||!k[0]||!w[0])return!S.s||!t.s||k&&!k[0]&&!w||w&&!w[0]&&!k?t.c=t.e=t.s=null:(t.s*=S.s,k&&w?(t.c=[0],t.e=0):t.c=t.e=null),t;for(i=y(S.e/f)+y(t.e/f),t.s*=S.s,c=k.length,d=w.length,c<d&&(m=k,k=w,w=m,r=c,c=d,d=r),r=c+d,m=[];r--;m.push(0));for(g=u,x=v,r=d;--r>=0;){for(n=0,p=w[r]%x,_=w[r]/x|0,o=c,a=r+o;a>r;)h=k[--o]%x,l=k[o]/x|0,s=_*h+l*p,h=p*h+s%x*x+m[a]+n,n=(h/g|0)+(s/x|0)+_*l,m[a--]=h%g;m[a]=n}return n?++i:m.splice(0,1),z(t,m,i)},r.negated=function(){var t=new N(this);return t.s=-t.s||null,t},r.plus=function(t,e){var n,i=this,r=i.s;if(t=new N(t,e),e=t.s,!r||!e)return new N(NaN);if(r!=e)return t.s=-e,i.minus(t);var a=i.e/f,o=t.e/f,s=i.c,c=t.c;if(!a||!o){if(!s||!c)return new N(r/0);if(!s[0]||!c[0])return c[0]?t:new N(s[0]?i:0*r)}if(a=y(a),o=y(o),s=s.slice(),r=a-o){for(r>0?(o=a,n=c):(r=-r,n=s),n.reverse();r--;n.push(0));n.reverse()}for(r=s.length,e=c.length,r-e<0&&(n=c,c=s,s=n,e=r),r=0;e;)r=(s[--e]=s[e]+c[e]+r)/u|0,s[e]=u===s[e]?0:s[e]%u;return r&&(s=[r].concat(s),++o),z(t,s,o)},r.precision=r.sd=function(t,e){var n,i,r,a=this;if(null!=t&&t!==!!t)return S(t,1,_),null==e?e=P:S(e,0,8),V(new N(a),t,e);if(!(n=a.c))return null;if(r=n.length-1,i=r*f+1,r=n[r]){for(;r%10==0;r/=10,i--);for(r=n[0];r>=10;r/=10,i++);}return t&&a.e+1>i&&(i=a.e+1),i},r.shiftedBy=function(t){return S(t,-d,d),this.times("1e"+t)},r.squareRoot=r.sqrt=function(){var t,n,i,r,a,o=this,s=o.c,c=o.s,h=o.e,l=E+4,u=new N("0.5");if(1!==c||!s||!s[0])return new N(!c||c<0&&(!s||s[0])?NaN:s?o:1/0);if(c=Math.sqrt(+H(o)),0==c||c==1/0?(n=g(s),(n.length+h)%2==0&&(n+="0"),c=Math.sqrt(+n),h=y((h+1)/2)-(h<0||h%2),c==1/0?n="5e"+h:(n=c.toExponential(),n=n.slice(0,n.indexOf("e")+1)+h),i=new N(n)):i=new N(c+""),i.c[0])for(h=i.e,c=h+l,c<3&&(c=0);;)if(a=i,i=u.times(a.plus(e(o,a,l,1))),g(a.c).slice(0,c)===(n=g(i.c)).slice(0,c)){if(i.e<h&&--c,n=n.slice(c-3,c+1),"9999"!=n&&(r||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(V(i,i.e+E+2,1),t=!i.times(i).eq(o));break}if(!r&&(V(a,a.e+E+2,0),a.times(a).eq(o))){i=a;break}l+=4,c+=4,r=1}return V(i,i.e+E+1,P,t)},r.toExponential=function(t,e){return null!=t&&(S(t,0,_),t++),F(this,t,e,1)},r.toFixed=function(t,e){return null!=t&&(S(t,0,_),t=t+this.e+1),F(this,t,e)},r.toFormat=function(t,e,n){var i,r=this;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=R;else if("object"!=typeof n)throw Error(h+"Argument not an object: "+n);if(i=r.toFixed(t,e),r.c){var a,o=i.split("."),s=+n.groupSize,c=+n.secondaryGroupSize,l=n.groupSeparator||"",u=o[0],f=o[1],d=r.s<0,p=d?u.slice(1):u,v=p.length;if(c&&(a=s,s=c,c=a,v-=a),s>0&&v>0){for(a=v%s||s,u=p.substr(0,a);a<v;a+=s)u+=l+p.substr(a,s);c>0&&(u+=l+p.slice(a)),d&&(u="-"+u)}i=f?u+(n.decimalSeparator||"")+((c=+n.fractionGroupSize)?f.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):f):u}return(n.prefix||"")+i+(n.suffix||"")},r.toFraction=function(t){var n,i,r,o,s,c,l,u,d,v,_,m,y=this,x=y.c;if(null!=t&&(l=new N(t),!l.isInteger()&&(l.c||1!==l.s)||l.lt(a)))throw Error(h+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+H(l));if(!x)return new N(y);for(n=new N(a),d=i=new N(a),r=u=new N(a),m=g(x),s=n.e=m.length-y.e-1,n.c[0]=p[(c=s%f)<0?f+c:c],t=!t||l.comparedTo(n)>0?s>0?n:d:l,c=T,T=1/0,l=new N(m),u.c[0]=0;;){if(v=e(l,n,0,1),o=i.plus(v.times(r)),1==o.comparedTo(t))break;i=r,r=o,d=u.plus(v.times(o=d)),u=o,n=l.minus(v.times(o=n)),l=o}return o=e(t.minus(i),r,0,1),u=u.plus(o.times(d)),i=i.plus(o.times(r)),u.s=d.s=y.s,s*=2,_=e(d,r,s,P).minus(y).abs().comparedTo(e(u,i,s,P).minus(y).abs())<1?[d,r]:[u,i],T=c,_},r.toNumber=function(){return+H(this)},r.toPrecision=function(t,e){return null!=t&&S(t,1,_),F(this,t,e,2)},r.toString=function(t){var e,i=this,r=i.s,a=i.e;return null===a?r?(e="Infinity",r<0&&(e="-"+e)):e="NaN":(null==t?e=a<=C||a>=A?w(g(i.c),a):b(g(i.c),a,"0"):10===t&&B?(i=V(new N(i),E+a+1,P),e=b(g(i.c),i.e,"0")):(S(t,2,L.length,"Base"),e=n(b(g(i.c),a,"0"),10,t,r,!0)),r<0&&i.c[0]&&(e="-"+e)),e},r.valueOf=r.toJSON=function(){return H(this)},r._isBigNumber=!0,null!=t&&N.set(t),N}function y(t){var e=0|t;return t>0||t===e?e:e-1}function g(t){for(var e,n,i=1,r=t.length,a=t[0]+"";i<r;){for(e=t[i++]+"",n=f-e.length;n--;e="0"+e);a+=e}for(r=a.length;48===a.charCodeAt(--r););return a.slice(0,r+1||1)}function x(t,e){var n,i,r=t.c,a=e.c,o=t.s,s=e.s,c=t.e,h=e.e;if(!o||!s)return null;if(n=r&&!r[0],i=a&&!a[0],n||i)return n?i?0:-s:o;if(o!=s)return o;if(n=o<0,i=c==h,!r||!a)return i?0:!r^n?1:-1;if(!i)return c>h^n?1:-1;for(s=(c=r.length)<(h=a.length)?c:h,o=0;o<s;o++)if(r[o]!=a[o])return r[o]>a[o]^n?1:-1;return c==h?0:c>h^n?1:-1}function S(t,e,n,i){if(t<e||t>n||t!==c(t))throw Error(h+(i||"Argument")+("number"==typeof t?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function k(t){var e=t.c.length-1;return y(t.e/f)==e&&t.c[e]%2!=0}function w(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function b(t,e,n){var i,r;if(e<0){for(r=n+".";++e;r+=n);t=r+t}else if(i=t.length,++e>i){for(r=n,e-=i;--e;r+=n);t+=r}else e<i&&(t=t.slice(0,e)+"."+t.slice(e));return t}a=m(),a["default"]=a.BigNumber=a,i=function(){return a}.call(e,n,e,t),void 0===i||(t.exports=i)}()},1820:function(t,e,n){n(1703),function(e,n){t.exports=n()}(0,(function(){"use strict";var t={name:"BBI",shortName:"BBI",series:"price",precision:2,calcParams:[3,6,12,24],shouldCheckParamCount:!0,shouldOhlc:!0,plots:[{key:"bbi",title:"BBI: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=Math.max.apply(null,n),r=[],a=[];return t.map((function(e,o){var s={},c=e.close;if(n.forEach((function(e,n){r[n]=(r[n]||0)+c,e-1>o||(a[n]=r[n]/e,r[n]-=t[o-(e-1)].close)})),o>=i-1){var h=0;a.forEach((function(t){h+=t})),s.bbi=h/4}return s}))}},e={name:"DMA",shortName:"DMA",calcParams:[10,50,10],plots:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=Math.max(n[0],n[1]),r=0,a=0,o=0,s=[];return t.forEach((function(e,c){var h,l,u={},f=e.close;if(r+=f,a+=f,n[0]-1>c||(h=r/n[0],r-=t[c-(n[0]-1)].close),n[1]-1>c||(l=a/n[1],a-=t[c-(n[1]-1)].close),c>=i-1){var d=h-l;u.dma=d,o+=d,i+n[2]-2>c||(u.ama=o/n[2],o-=s[c-(n[2]-1)].dma)}s.push(u)})),s}},n={name:"DMI",shortName:"DMI",calcParams:[14,6],plots:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=0,r=0,a=0,o=0,s=0,c=0,h=0,l=0,u=[];return t.forEach((function(e,f){var d={},p=t[f-1]||e,v=p.close,_=e.high,m=e.low,y=_-m,g=Math.abs(_-v),x=Math.abs(v-m),S=_-p.high,k=p.low-m,w=Math.max(Math.max(y,g),x),b=S>0&&S>k?S:0,E=k>0&&k>S?k:0;if(i+=w,r+=b,a+=E,f>=n[0]-1){f>n[0]-1?(o=o-o/n[0]+w,s=s-s/n[0]+b,c=c-c/n[0]+E):(o=i,s=r,c=a);var P=0,C=0;0!==o&&(P=100*s/o,C=100*c/o),d.pdi=P,d.mdi=C;var A=0;C+P!==0&&(A=Math.abs(C-P)/(C+P)*100),h+=A,2*n[0]-2>f||(d.adx=l=f>2*n[0]-2?(l*(n[0]-1)+A)/n[0]:h/n[0],2*n[0]+n[1]-3>f||(d.adxr=(u[f-(n[1]-1)].adx+l)/2))}u.push(d)})),u}},i={name:"MACD",shortName:"MACD",calcParams:[12,26,9],plots:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,color:function(t,e){var n=(t.current.technicalIndicatorData||{}).macd;return n>0?e.bar.upColor:0>n?e.bar.downColor:e.bar.noChangeColor},isStroke:function(t){return(t.current.technicalIndicatorData||{}).macd>(t.prev.technicalIndicatorData||{}).macd}}],calcTechnicalIndicator:function(t,e){var n,i,r=e.params,a=0,o=0,s=0,c=0,h=Math.max(r[0],r[1]);return t.map((function(t,e){var l={},u=t.close;return a+=u,r[0]-1>e||(n=e>r[0]-1?(2*u+(r[0]-1)*n)/(r[0]+1):a/r[0]),r[1]-1>e||(i=e>r[1]-1?(2*u+(r[1]-1)*i)/(r[1]+1):a/r[1]),h-1>e||(l.dif=o=n-i,s+=o,h+r[2]-2>e||(l.macd=2*(o-(c=e>h+r[2]-2?(2*o+c*(r[2]-1))/(r[2]+1):s/r[2])),l.dea=c)),l}))}},r={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],plots:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=Math.ceil(n[1]/2.5+1),r=Math.ceil(n[2]/2.5+1),a=Math.ceil(n[3]/2.5+1),o=Math.ceil(n[4]/2.5+1),s=0,c=[],h=0,l=[],u=0,f=[],d=0,p=[],v=[];return t.forEach((function(e,_){var m={},y=t[_-1]||e,g=(y.high+y.close+y.low+y.open)/4,x=Math.max(0,e.high-g),S=Math.max(0,g-e.low);n[0]-1>_||(m.cr=0!==S?x/S*100:0,s+=m.cr,h+=m.cr,u+=m.cr,d+=m.cr,n[0]+n[1]-2>_||(c.push(s/n[1]),n[0]+n[1]+i-3>_||(m.ma1=c[c.length-1-i]),s-=v[_-(n[1]-1)].cr),n[0]+n[2]-2>_||(l.push(h/n[2]),n[0]+n[2]+r-3>_||(m.ma2=l[l.length-1-r]),h-=v[_-(n[2]-1)].cr),n[0]+n[3]-2>_||(f.push(u/n[3]),n[0]+n[3]+a-3>_||(m.ma3=f[f.length-1-a]),u-=v[_-(n[3]-1)].cr),n[0]+n[4]-2>_||(p.push(d/n[4]),n[0]+n[4]+o-3>_||(m.ma4=p[p.length-1-o]),d-=v[_-(n[4]-1)].cr)),v.push(m)})),v}},a={name:"AO",shortName:"AO",calcParams:[5,34],shouldCheckParamCount:!0,plots:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,color:function(t,e){return(t.current.technicalIndicatorData||{}).ao>(t.prev.technicalIndicatorData||{}).ao?e.bar.upColor:e.bar.downColor},isStroke:function(t){return(t.current.technicalIndicatorData||{}).ao>(t.prev.technicalIndicatorData||{}).ao}}],calcTechnicalIndicator:function(t,e){var n=e.params,i=Math.max(n[0],n[1]),r=0,a=0,o=0,s=0;return t.map((function(e,c){var h={},l=(e.low+e.high)/2;if(r+=l,a+=l,c>=n[0]-1){o=r/n[0];var u=t[c-(n[0]-1)];r-=(u.low+u.high)/2}if(c>=n[1]-1){s=a/n[1];var f=t[c-(n[1]-1)];a-=(f.low+f.high)/2}return i-1>c||(h.ao=o-s),h}))}},o={name:"CCI",shortName:"CCI",calcParams:[20],plots:[{key:"cci",title:"CCI: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=n[0]-1,r=0,a=[];return t.map((function(e,o){var s={},c=(e.high+e.low+e.close)/3;if(r+=c,a.push(c),o>=i){var h=r/n[0],l=a.slice(o-i,o+1),u=0;l.forEach((function(t){u+=Math.abs(t-h)}));var f=u/n[0];s.cci=0!==f?(c-h)/f/.015:0,r-=(t[o-i].high+t[o-i].low+t[o-i].close)/3}return s}))}},s={name:"RSI",shortName:"RSI",calcParams:[6,12,24],shouldCheckParamCount:!1,plots:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t,e){var n=e+1;return{key:"rsi".concat(n),title:"RSI".concat(n,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var n=e.params,i=e.plots,r=[],a=[];return t.map((function(e,o){var s={},c=e.close-(t[o-1]||e).close;return n.forEach((function(e,n){if(c>0?r[n]=(r[n]||0)+c:a[n]=(a[n]||0)+Math.abs(c),o>=e-1){s[i[n].key]=0!==a[n]?100-100/(1+r[n]/a[n]):0;var h=t[o-(e-1)],l=h.close-(t[o-e]||h).close;l>0?r[n]-=l:a[n]-=Math.abs(l)}})),s}))}};function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER;return t.forEach((function(t){e=Math.max(t.high,e),n=Math.min(t.low,n)})),{hn:e,ln:n}}var h={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],plots:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=[];return t.forEach((function(e,r){var a={},o=e.close;if(r>=n[0]-1){var s=c(t.slice(r-(n[0]-1),r+1)),h=s.ln,l=s.hn-h;a.k=((n[1]-1)*(i[r-1].k||50)+(o-h)/(0===l?1:l)*100)/n[1],a.d=((n[2]-1)*(i[r-1].d||50)+a.k)/n[2],a.j=3*a.k-2*a.d}i.push(a)})),i}},l={name:"WR",shortName:"WR",calcParams:[6,10,14],shouldCheckParamCount:!1,plots:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var n=e.params,i=e.plots;return t.map((function(e,r){var a={},o=e.close;return n.forEach((function(e,n){var s=e-1;if(r>=s){var h=c(t.slice(r-s,r+1)),l=h.hn,u=l-h.ln;a[i[n].key]=0===u?0:(o-l)/u*100}})),a}))}},u={name:"BOLL",shortName:"BOLL",series:"price",calcParams:[20,{value:2,allowDecimal:!0}],precision:2,shouldOhlc:!0,plots:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=n[0]-1,r=0;return t.map((function(e,a){var o={};if(r+=e.close,a>=i){o.mid=r/n[0];var s=function(t,e){var n=t.length,i=0;t.forEach((function(t){var n=t.close-e;i+=n*n}));var r=i>0,a=Math.sqrt((i=Math.abs(i))/n);return r?a:-1*a}(t.slice(a-i,a+1),o.mid);o.up=o.mid+n[1]*s,o.dn=o.mid-n[1]*s,r-=t[a-i].close}return o}))}},f={name:"SAR",shortName:"SAR",series:"price",calcParams:[2,2,20],precision:2,shouldOhlc:!0,plots:[{key:"sar",title:"SAR: ",type:"circle",color:function(t,e){var n=t.current,i=n.kLineData||{};return(i.high+i.low)/2>(n.technicalIndicatorData||{}).sar?e.circle.upColor:e.circle.downColor}}],calcTechnicalIndicator:function(t,e){var n=e.params,i=n[0]/100,r=n[1]/100,a=n[2]/100,o=i,s=-100,c=!1,h=0;return t.map((function(e,n){var l=h,u=e.high,f=e.low;if(c){(-100===s||u>s)&&(s=u,o=Math.min(o+r,a)),h=l+o*(s-l);var d=Math.min(t[Math.max(1,n)-1].low,f);h>e.low?(h=s,o=i,s=-100,c=!c):h>d&&(h=d)}else{(-100===s||s>f)&&(s=f,o=Math.min(o+r,a)),h=l+o*(s-l);var p=Math.max(t[Math.max(1,n)-1].high,u);e.high>h?(h=s,o=0,s=-100,c=!c):p>h&&(h=p)}return{sar:h}}))}},d={technicalIndicatorExtensions:{},shapeExtensions:{},addTechnicalIndicatorTemplate:function(t){var e=this;t&&[].concat(t).forEach((function(t){t.name&&(e.technicalIndicatorExtensions[t.name]=t)}))},addShapeTemplate:function(t){var e=this;t&&[].concat(t).forEach((function(t){t.name&&(e.shapeExtensions[t.name]=t)}))}};function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function y(t,e){if(k(t)&&k(e))for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&n in t){var i=t[n],r=e[n];k(r)&&k(i)&&!x(r)&&!x(i)?y(i,r):b(e[n])&&(t[n]=e[n])}}function g(t){if(!k(t))return t;var e;for(var n in e=x(t)?[]:{},t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n];e[n]=k(i)?g(i):i}return e}function x(t){return"[object Array]"===Object.prototype.toString.call(t)}function S(t){return t&&"function"==typeof t}function k(t){return!!t&&"object"===m(t)}function w(t){return"number"==typeof t&&!isNaN(t)}function b(t){return null!=t}function E(t){return"boolean"==typeof t}function P(t){return"string"==typeof t}var C="stroke",A="fill",O="dash",T="solid",I="left",D="right",M="normal",R="percentage",L="log",B="candle_solid",N="candle_stroke",F="candle_up_stroke",j="candle_down_stroke",z="ohlc",V="area",H="always",W="follow_cross",Y="rect",U="standard",X="circle",G="rect",q="triangle",$="diamond",K="custom",Z="point",J="top",Q="bottom",tt={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:O,dashValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:O,dashValue:[2,2]}},candle:{margin:{top:.2,bottom:.1},type:B,bar:{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#999999"},area:{lineSize:2,lineColor:"#2196F3",value:"close",backgroundColor:[{offset:0,color:"rgba(33, 150, 243, 0.01)"},{offset:1,color:"rgba(33, 150, 243, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:"#76808F",textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,color:"#76808F",textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888",line:{show:!0,style:O,dashValue:[4,4],size:1},text:{show:!0,size:12,paddingLeft:2,paddingTop:2,paddingRight:2,paddingBottom:2,color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:H,showType:U,labels:["时间: ","开: ","收: ","高: ","低: ","成交量: "],values:null,defaultValue:"n/a",rect:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:6,offsetLeft:8,offsetTop:8,offsetRight:8,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",backgroundColor:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:8,marginTop:6,marginRight:8,marginBottom:0}}},technicalIndicator:{margin:{top:.2,bottom:.1},bar:{upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"},line:{size:1,dashValue:[2,2],colors:["#FF9600","#9D65C9","#2196F3","#E11D74","#01C5C4"]},circle:{upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"},lastValueMark:{show:!1,text:{show:!1,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:3,paddingTop:2,paddingRight:3,paddingBottom:2,borderRadius:2}},tooltip:{showRule:H,showType:U,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginTop:6,marginRight:8,marginBottom:0,marginLeft:8}}},xAxis:{show:!0,height:null,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",paddingTop:3,paddingBottom:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,width:null,type:M,position:D,inside:!1,reverse:!1,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:3,paddingRight:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:O,dashValue:[4,2],size:1,color:"#76808F"},text:{show:!0,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderColor:"#686D76",borderRadius:2,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:O,dashValue:[4,2],size:1,color:"#76808F"},text:{show:!0,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderRadius:2,borderColor:"#686D76",backgroundColor:"#686D76"}}},shape:{point:{backgroundColor:"#2196F3",borderColor:"rgba(33, 150, 243, 0.35)",borderSize:1,radius:5,activeBackgroundColor:"#2196F3",activeBorderColor:"rgba(33, 150, 243, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:T,color:"#2196F3",size:1,dashValue:[2,2]},polygon:{style:C,stroke:{style:T,size:1,color:"#2196F3",dashValue:[2,2]},fill:{color:"#2196F3"}},arc:{style:C,stroke:{style:T,size:1,color:"#2196F3",dashValue:[2,2]},fill:{color:"#2196F3"}},text:{style:A,color:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",offset:[0,0]}},annotation:{position:J,offset:[20,0],symbol:{type:$,size:8,color:"#2196F3",activeSize:10,activeColor:"#FF9600"}},tag:{position:Z,offset:0,line:{show:!0,style:O,dashValue:[4,2],size:1,color:"#2196F3"},text:{color:"#FFFFFF",backgroundColor:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderRadius:2,borderSize:1,borderColor:"#2196F3"},mark:{offset:0,color:"#FFFFFF",backgroundColor:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderRadius:2,borderSize:1,borderColor:"#2196F3"}}};function et(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"--";if(k(t)){var i=t[e];if(b(i))return i}return n}function nt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"MM-DD hh:mm";if(w(e)){var i=t.format(new Date(e)),r=i.split(", "),a=r[0].split("/"),o={YYYY:a[2],MM:a[0],DD:a[1],"hh:mm":"24"===r[1].match(/^[\d]{2}/)[0]?r[1].replace(/^[\d]{2}/,"00"):r[1]};return n.replace(/YYYY|MM|DD|(hh:mm)/g,(function(t){return o[t]}))}return"--"}function it(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=+t;return(n||0===n)&&w(n)?n.toFixed(e):"".concat(n)}function rt(t){return w(+t)?t>1e9?"".concat(+(t/1e9).toFixed(3),"B"):t>1e6?"".concat(+(t/1e6).toFixed(3),"M"):t>1e3?"".concat(+(t/1e3).toFixed(3),"K"):t:"--"}function at(t,e,n){var i=0,r=0;for(r=t.length-1;i!==r;){var a=Math.floor((r+i)/2),o=r-i,s=t[a][e];if(n===t[i][e])return i;if(n===t[r][e])return r;if(n===s)return a;if(n>s?i=a:r=a,2>=o)break}return i}function ot(t,e){return null==e&&(e=10),+(t=(+t).toFixed(e=Math.min(Math.max(0,e),20)))}function st(t){return Math.log(t)/Math.log(10)}function ct(t){return Math.pow(10,t)}var ht={ZOOM:"zoom",SCROLL:"scroll",CROSSHAIR:"crosshair",TOOLTIP:"tooltip",PANE_DRAG:"pane_drag"};function lt(t){return Object.values(ht).indexOf(t)>-1}var ut=function(){function t(e){p(this,t),this._chartStore=e,this._dateTimeFormat=new Intl.DateTimeFormat("en",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalDataSpace=0,this._dataSpace=6,this._barSpace=this._calcBarSpace(),this._offsetRightSpace=50,this._offsetRightBarCount=this._offsetRightSpace/this._dataSpace,this._leftMinVisibleBarCount=2,this._rightMinVisibleBarCount=2,this._from=0,this._to=0,this._preOffsetRightBarCount=0}return _(t,[{key:"_calcBarSpace",value:function(){return Math.max(1,Math.min(Math.floor(.82*this._dataSpace),Math.floor(this._dataSpace)-1))}},{key:"adjustFromTo",value:function(){var t=this._chartStore.dataList().length,e=this._totalDataSpace/this._dataSpace,n=e-Math.min(this._leftMinVisibleBarCount,t);this._offsetRightBarCount>n&&(this._offsetRightBarCount=n);var i=-t+Math.min(this._rightMinVisibleBarCount,t);i>this._offsetRightBarCount&&(this._offsetRightBarCount=i),this._to=Math.round(this._offsetRightBarCount+t+.5),this._from=Math.round(this._to-e)-1,this._to>t&&(this._to=t),0>this._from&&(this._from=0),this._chartStore.adjustVisibleDataList(),0===this._from&&this._more&&!this._loading&&S(this._loadMoreCallback)&&(this._loading=!0,this._loadMoreCallback(et(this._chartStore.dataList()[0],"timestamp")))}},{key:"setMore",value:function(t){this._more=t}},{key:"setLoading",value:function(t){this._loading=t}},{key:"dateTimeFormat",value:function(){return this._dateTimeFormat}},{key:"setTimezone",value:function(t){var e;try{e=new Intl.DateTimeFormat("en",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){}e&&(this._dateTimeFormat=e)}},{key:"timezone",value:function(){return this._dateTimeFormat.resolvedOptions().timeZone}},{key:"dataSpace",value:function(){return this._dataSpace}},{key:"barSpace",value:function(){return this._barSpace}},{key:"halfBarSpace",value:function(){return this._barSpace/2}},{key:"setDataSpace",value:function(t,e){1>t||t>50||this._dataSpace===t||(this._dataSpace=t,this._barSpace=this._calcBarSpace(),e&&e(),this.adjustFromTo(),this._chartStore.crosshairStore().recalculate(!0),this._chartStore.invalidate())}},{key:"setTotalDataSpace",value:function(t){this._totalDataSpace!==t&&(this._totalDataSpace=t,this.adjustFromTo(),this._chartStore.crosshairStore().recalculate(!0))}},{key:"setOffsetRightSpace",value:function(t,e){this._offsetRightSpace=t,this._offsetRightBarCount=t/this._dataSpace,e&&(this.adjustFromTo(),this._chartStore.crosshairStore().recalculate(!0),this._chartStore.invalidate())}},{key:"resetOffsetRightSpace",value:function(){this.setOffsetRightSpace(this._offsetRightSpace)}},{key:"offsetRightSpace",value:function(){return this._offsetRightSpace}},{key:"offsetRightBarCount",value:function(){return this._offsetRightBarCount}},{key:"setOffsetRightBarCount",value:function(t){this._offsetRightBarCount=t}},{key:"setLeftMinVisibleBarCount",value:function(t){this._leftMinVisibleBarCount=t}},{key:"setRightMinVisibleBarCount",value:function(t){this._rightMinVisibleBarCount=t}},{key:"from",value:function(){return this._from}},{key:"to",value:function(){return this._to}},{key:"startScroll",value:function(){this._preOffsetRightBarCount=this._offsetRightBarCount}},{key:"scroll",value:function(t,e){if(this._scrollEnabled){var n=t/this._dataSpace;this._chartStore.actionStore().execute(ht.SCROLL,{barCount:n,distance:t}),this._offsetRightBarCount=this._preOffsetRightBarCount-n,this.adjustFromTo();var i=e||this._chartStore.crosshairStore().get();this._chartStore.crosshairStore().set(i,!0),this._chartStore.invalidate()}}},{key:"getDataByDataIndex",value:function(t){return this._chartStore.dataList()[t]}},{key:"coordinateToFloatIndex",value:function(t){var e=this._chartStore.dataList().length;return Math.round(1e6*(e+this._offsetRightBarCount-(this._totalDataSpace-t)/this._dataSpace))/1e6}},{key:"dataIndexToTimestamp",value:function(t){var e=this.getDataByDataIndex(t);if(e)return e.timestamp}},{key:"timestampToDataIndex",value:function(t){return 0===this._chartStore.dataList().length?0:at(this._chartStore.dataList(),"timestamp",t)}},{key:"dataIndexToCoordinate",value:function(t){var e=this._chartStore.dataList().length;return this._totalDataSpace-(e+this._offsetRightBarCount-t-.5)*this._dataSpace}},{key:"coordinateToDataIndex",value:function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1}},{key:"zoom",value:function(t,e){var n=this;if(this._zoomEnabled){if(!e||!b(e.x)){var i=this._chartStore.crosshairStore().get();e={x:b(i.x)?i.x:this._totalDataSpace/2}}this._chartStore.actionStore().execute(ht.ZOOM,{coordinate:e,scale:t});var r=this.coordinateToFloatIndex(e.x);this.setDataSpace(this._dataSpace+t*(this._dataSpace/10),(function(){n._offsetRightBarCount+=r-n.coordinateToFloatIndex(e.x)}))}}},{key:"setZoomEnabled",value:function(t){this._zoomEnabled=t}},{key:"zoomEnabled",value:function(){return this._zoomEnabled}},{key:"setScrollEnabled",value:function(t){this._scrollEnabled=t}},{key:"scrollEnabled",value:function(){return this._scrollEnabled}},{key:"setLoadMoreCallback",value:function(t){this._loadMoreCallback=t}},{key:"clear",value:function(){this._more=!0,this._loading=!0,this._from=0,this._to=0}}]),t}();function ft(t,e){return ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ft(t,e)}function dt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ft(t,e)}function pt(t,e){if(e&&("object"===m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function vt(t){return vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vt(t)}function _t(t,e,n,i,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,r)}var mt={exports:{}},yt={exports:{}};!function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(yt),function(t){var e=yt.exports.default;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
t.exports=n=function(){return i},t.exports.__esModule=!0,t.exports.default=t.exports;var i={},r=Object.prototype,a=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",h=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var r=Object.create((e&&e.prototype instanceof p?e:p).prototype),a=new P(i||[]);return r._invoke=function(t,e,n){var i="suspendedStart";return function(r,a){if("executing"===i)throw Error("Generator is already running");if("completed"===i){if("throw"===r)throw a;return A()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=w(o,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var c=f(t,e,n);if("normal"===c.type){if(i=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),r}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=u;var d={};function p(){}function v(){}function _(){}var m={};l(m,s,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(C([])));g&&g!==r&&a.call(g,s)&&(m=g);var x=_.prototype=p.prototype=Object.create(m);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,n){function i(r,o,s,c){var h=f(t[r],t,o);if("throw"!==h.type){var l=h.arg,u=l.value;return u&&"object"==e(u)&&a.call(u,"__await")?n.resolve(u.__await).then((function(t){i("next",t,s,c)}),(function(t){i("throw",t,s,c)})):n.resolve(u).then((function(t){l.value=t,s(l)}),(function(t){return i("throw",t,s,c)}))}c(h.arg)}var r;this._invoke=function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=f(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function C(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(a.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return v.prototype=_,l(x,"constructor",_),l(_,"constructor",v),v.displayName=l(_,h,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,l(t,h,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},S(k.prototype),l(k.prototype,c,(function(){return this})),i.AsyncIterator=k,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var o=new k(u(t,e,n,r),a);return i.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(x),l(x,h,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},i.values=C,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return o.type="throw",o.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return n("end");if(this.prev>=r.tryLoc){var s=a.call(r,"catchLoc"),c=a.call(r,"finallyLoc");if(s&&c){if(r.catchLoc>this.prev)return n(r.catchLoc,!0);if(r.finallyLoc>this.prev)return n(r.finallyLoc)}else if(s){if(r.catchLoc>this.prev)return n(r.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(r.finallyLoc>this.prev)return n(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(this.prev>=i.tryLoc&&a.call(i,"finallyLoc")&&i.finallyLoc>this.prev){var r=i;break}}r&&("break"===t||"continue"===t)&&e>=r.tryLoc&&r.finallyLoc>=e&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;E(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},i}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(mt);var gt=mt.exports(),xt=gt;try{regeneratorRuntime=gt}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=gt:Function("r","regeneratorRuntime = r")(gt)}var St="line",kt="bar",wt="circle",bt={PRICE:"price",VOLUME:"volume",NORMAL:"normal"};function Et(t,e,n,i,r,a){var o=a.color,s=a.isStroke,c=a.isDashed,h={prev:{kLineData:t[n-1],technicalIndicatorData:e[n-1]},current:{kLineData:t[n],technicalIndicatorData:e[n]},next:{kLineData:t[n+1],technicalIndicatorData:e[n+1]}};return b(i.color)&&(o=S(i.color)?i.color(h,r)||a.color:i.color||a.color),b(i.isStroke)&&(s=S(i.isStroke)?i.isStroke(h):i.isStroke),b(i.isDashed)&&(c=S(i.isDashed)?i.isDashed(h):i.isDashed),{color:o,isStroke:s,isDashed:c}}var Pt=function(){function t(e){var n=e.name,i=e.shortName,r=e.series,a=e.calcParams,o=e.plots,s=e.precision,c=e.shouldCheckParamCount,h=e.shouldOhlc,l=e.shouldFormatBigNumber,u=e.minValue,f=e.maxValue,d=e.styles,v=e.extendData;p(this,t),this.name=n||"",this.shortName=b(i)?i:n,this.series=-1!==Object.values(bt).indexOf(r)?r:bt.NORMAL,this.precision=w(s)&&s>=0?s:4,this._precisionFlag=!1,this.calcParams=x(a)?a:[],this.plots=x(o)?o:[],this.shouldCheckParamCount=!E(c)||c,this.shouldOhlc=!!E(h)&&h,this.shouldFormatBigNumber=!!E(l)&&l,this.minValue=u,this.maxValue=f,this.styles=d,this.extendData=v,this.result=[]}var e,n;return _(t,[{key:"_createParams",value:function(t){return t.map((function(t){return k(t)?t.value:t}))}},{key:"setShortName",value:function(t){return!(!b(t)||this.shortName===t)&&(this.shortName=t,!0)}},{key:"setPrecision",value:function(t,e){return!(!w(t)||0>t||e&&(!e||this._precisionFlag))&&(this.precision=parseInt(t,10),e||(this._precisionFlag=!0),!0)}},{key:"setCalcParams",value:function(t){if(!x(t))return!1;if(this.shouldCheckParamCount&&t.length!==this.calcParams.length)return!1;for(var e=[],n=0;t.length>n;n++){var i=t[n],r=void 0,a=void 0;k(i)?(r=i.value,a=i.allowDecimal):(r=i,a=!1);var o=this.calcParams[n];if(k(o)&&E(o.allowDecimal)&&(a=o.allowDecimal),!w(r)||!a&&parseInt(r,10)!==r)return!1;e.push({allowDecimal:a,value:r})}this.calcParams=e;var s=this.regeneratePlots(this._createParams(e));return s&&x(s)&&(this.plots=s),!0}},{key:"setShouldOhlc",value:function(t){return!(!E(t)||this.shouldOhlc===t)&&(this.shouldOhlc=t,!0)}},{key:"setShouldFormatBigNumber",value:function(t){return!(!E(t)||this.shouldFormatBigNumber===t)&&(this.shouldFormatBigNumber=t,!0)}},{key:"setStyles",value:function(t,e){return!!k(t)&&(this.styles||(this.styles={margin:g(e.margin),bar:g(e.bar),line:g(e.line),circle:g(e.circle)}),y(this.styles,t),!0)}},{key:"setExtendData",value:function(t){return void 0!==t&&this.extendData!==t&&(this.extendData=t,!0)}},{key:"calc",value:(e=xt.mark((function t(e){return xt.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.calcTechnicalIndicator(e,{params:this._createParams(this.calcParams),plots:this.plots,extendData:this.extendData});case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:this.result=t.t0;case 6:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(t){_t(a,i,r,o,s,"next",t)}function s(t){_t(a,i,r,o,s,"throw",t)}o(void 0)}))},function(t){return n.apply(this,arguments)})},{key:"calcTechnicalIndicator",value:function(t,e){}},{key:"regeneratePlots",value:function(t){}}]),t}();function Ct(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return At(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?At(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return t.length>i?{done:!1,value:t[i++]}:{done:!0}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);e>n;n++)i[n]=t[n];return i}function Ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var Tt=function(){function t(e){p(this,t),this._chartStore=e,this._templates=this._createTemplates(),this._instances=new Map}return _(t,[{key:"_createTechInfo",value:function(t){return{name:t.name,shortName:t.shortName,series:t.series,calcParams:t.calcParams,shouldCheckParamCount:t.shouldCheckParamCount,shouldOhlc:t.shouldOhlc,shouldFormatBigNumber:t.shouldFormatBigNumber,precision:t.precision,styles:t.styles,plots:t.plots,result:t.result||[]}}},{key:"_createTemplates",value:function(){var t={},e=d.technicalIndicatorExtensions;for(var n in e){var i=this._createTemplateInstance(e[n]);i&&(t[n]=i)}return t}},{key:"_createTemplateInstance",value:function(t){var e,n=t.name,i=t.shortName,r=t.series,a=t.calcParams,o=t.plots,s=t.precision,c=t.shouldCheckParamCount,h=t.shouldOhlc,l=t.shouldFormatBigNumber,u=t.minValue,f=t.maxValue,d=t.styles,v=t.extendData,m=t.calcTechnicalIndicator,x=t.regeneratePlots,w=t.createToolTipDataSource,b=t.render;if(!n||!S(m))return null;if(k(d)){var E=this._chartStore.styleOptions().technicalIndicator;y(e={margin:g(E.margin),bar:g(E.bar),line:g(E.line),circle:g(E.circle)},d)}var P=function(t){dt(m,t);var d=Ot(m);function m(){return p(this,m),d.call(this,{name:n,shortName:i,series:r,calcParams:a,plots:o,precision:s,shouldCheckParamCount:c,shouldOhlc:h,shouldFormatBigNumber:l,minValue:u,maxValue:f,defaultStyles:e,extendData:v})}return _(m)}(Pt);return P.prototype.calcTechnicalIndicator=m,S(x)&&(P.prototype.regeneratePlots=x),S(w)&&(P.prototype.createToolTipDataSource=w),S(b)&&(P.prototype.render=b),new P}},{key:"addTemplate",value:function(t){var e=this;t.forEach((function(t){var n=e._createTemplateInstance(t||{});n&&(e._templates[n.name]=n)}))}},{key:"hasTemplate",value:function(t){return!!this._templates[t]}},{key:"getTemplateInfo",value:function(t){if(!b(t)){var e={};for(var n in this._templates)e[n]=this._createTechInfo(this._templates[n]);return e}var i=this._templates[t];return i?this._createTechInfo(i):{}}},{key:"addInstance",value:function(t,e,n){var i=e.name,r=e.calcParams,a=e.precision,o=e.shouldOhlc,s=e.shouldFormatBigNumber,c=e.styles,h=e.extendData,l=this._instances.get(t);if(!l||!l.has(i)){l||(l=new Map,this._instances.set(t,l));var u=this._templates[i],f=Object.create(Object.getPrototypeOf(u));for(var d in u)Object.prototype.hasOwnProperty.call(u,d)&&(f[d]=u[d]);return f.setCalcParams(r),f.setPrecision(a),f.setShouldOhlc(o),f.setShouldFormatBigNumber(s),f.setStyles(c,this._chartStore.styleOptions().technicalIndicator),f.setExtendData(h),n||l.clear(),l.set(i,f),f.calc(this._chartStore.dataList())}}},{key:"instances",value:function(t){return this._instances.get(t)||new Map}},{key:"removeInstance",value:function(t,e){var n=!1;if(this._instances.has(t)){var i=this._instances.get(t);b(e)?i.has(e)&&(i.delete(e),n=!0):(i.clear(),n=!0),0===i.size&&this._instances.delete(t)}return n}},{key:"hasInstance",value:function(t){return this._instances.has(t)}},{key:"calcInstance",value:function(t,e){var n=this,i=[];if(b(t))if(b(e)){var r=this._instances.get(e);r&&r.has(t)&&i.push(r.get(t).calc(this._chartStore.dataList()))}else this._instances.forEach((function(e){e.has(t)&&i.push(e.get(t).calc(n._chartStore.dataList()))}));else this._instances.forEach((function(t){t.forEach((function(t){i.push(t.calc(n._chartStore.dataList()))}))}));return Promise.all(i)}},{key:"getInstanceInfo",value:function(t,e){var n=this,i=function(t){var i,r=[],a=Ct(t);try{for(a.s();!(i=a.n()).done;){var o=i.value[1];if(o){var s=n._createTechInfo(o);if(o.name===e)return s;r.push(s)}}}catch(t){a.e(t)}finally{a.f()}return r};if(!b(t)){var r={};return this._instances.forEach((function(t,e){r[e]=i(t)})),r}return this._instances.has(t)?i(this._instances.get(t)):{}}},{key:"setSeriesPrecision",value:function(t,e){var n=function(n){n.series===bt.PRICE&&n.setPrecision(t,!0),n.series===bt.VOLUME&&n.setPrecision(e,!0)};for(var i in this._templates)n(this._templates[i]);this._instances.forEach((function(t){t.forEach((function(t){n(t)}))}))}},{key:"override",value:function(t,e){var n=this,i=t.name,r=t.shortName,a=t.calcParams,o=t.precision,s=t.shouldOhlc,c=t.shouldFormatBigNumber,h=t.styles,l=t.extendData,u=this._chartStore.styleOptions().technicalIndicator,f=new Map;if(b(e))this._instances.has(e)&&f.set(e,this._instances.get(e));else{f=this._instances;var d=this._templates[i];d&&(d.setCalcParams(a),d.setShortName(r),d.setPrecision(o),d.setShouldOhlc(s),d.setShouldFormatBigNumber(c),d.setStyles(h,u),d.setExtendData(l))}var p=!1,v=[];if(f.forEach((function(t){if(t.has(i)){var e=t.get(i),f=e.setShortName(r),d=e.setCalcParams(a),_=e.setPrecision(o),m=e.setShouldOhlc(s),y=e.setShouldFormatBigNumber(c),g=e.setStyles(h,u),x=n.setExtendData(l);(f||d||_||m||y||g||x)&&(p=!0),d&&v.push(e.calc(n._chartStore.dataList()))}})),p)return Promise.all(v)}}]),t}();function It(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dt(t,e){e.forEach((function(e){var n=e.key,i=e.fn;S(i)&&(t[n]=i)}))}var Mt=function(){function t(e){var n=e.id,i=e.chartStore,r=e.xAxis,a=e.yAxis;p(this,t),this._id=n,this._chartStore=i,this._xAxis=r,this._yAxis=a,this._styles=null}return _(t,[{key:"draw",value:function(t){}},{key:"setStyles",value:function(t,e){return!!k(t)&&(this._styles||(this._styles=g(e)),y(this._styles,t),!0)}},{key:"id",value:function(){return this._id}},{key:"styles",value:function(){return this._styles}},{key:"setYAxis",value:function(t){t&&(this._yAxis=t)}},{key:"checkEventCoordinateOn",value:function(t){}},{key:"onClick",value:function(t){}},{key:"onRightClick",value:function(t){}},{key:"onMouseEnter",value:function(t){}},{key:"onMouseLeave",value:function(t){}}]),t}();function Rt(t,e,n,i){t.fillStyle=e,t.beginPath(),t.arc(n.x,n.y,i,0,2*Math.PI),t.closePath(),t.fill()}function Lt(t,e,n){var i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),a=Math.abs(n.x-t.x);return Math.abs(i*Math.abs(n.y-t.y)-a*r)/2}function Bt(t,e){var n=t.x-e.x;if(0!==n){var i=(t.y-e.y)/n;return{k:i,b:t.y-i*t.x}}}function Nt(t,e,n){return Ft(Bt(t,e),n)}function Ft(t,e){return t?e.x*t.k+t.b:e.y}function jt(t,e,n){if(!n||!t||!e)return!1;if(t.x===e.x)return 2>Math.abs(n.x-t.x);var i=Bt(t,e),r=Ft(i,n),a=Math.abs(r-n.y);return 4>a*a/(i.k*i.k+1)}function zt(t,e,n){return!!jt(t,e,n)&&(t.x===e.x?e.y>t.y?2>t.y-n.y:2>n.y-t.y:e.x>t.x?2>t.x-n.x:2>n.x-t.x)}function Vt(t,e,n){return!!jt(t,e,n)&&(t.x===e.x?4>Math.abs(t.y-n.y)+Math.abs(e.y-n.y)-Math.abs(t.y-e.y):4>Math.abs(t.x-n.x)+Math.abs(e.x-n.x)-Math.abs(t.x-e.x))}function Ht(t,e,n){if(!n)return!1;var i=n.x-t.x,r=n.y-t.y;return!(i*i+r*r>e*e)}function Wt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[];if(t.length>1)if(t[0].x===t[1].x){var r=0,a=e.y;if(i.push([{x:t[0].x,y:r},{x:t[0].x,y:a}]),t.length>2){i.push([{x:t[2].x,y:r},{x:t[2].x,y:a}]);for(var o=t[0].x-t[2].x,s=0;n>s;s++){var c=o*(s+1);i.push([{x:t[0].x+c,y:r},{x:t[0].x+c,y:a}])}}}else{var h=0,l=e.x,u=Bt(t[0],t[1]),f=u.k,d=u.b;if(i.push([{x:h,y:h*f+d},{x:l,y:l*f+d}]),t.length>2){var p=t[2].y-f*t[2].x;i.push([{x:h,y:h*f+p},{x:l,y:l*f+p}]);for(var v=d-p,_=0;n>_;_++){var m=d+v*(_+1);i.push([{x:h,y:h*f+m},{x:l,y:l*f+m}])}}}return i}function Yt(t,e,n){t.save(),t.lineWidth%2&&t.translate(.5,.5),t.beginPath();var i=!0;e.forEach((function(e){e&&(i?(t.moveTo(e.x,e.y),i=!1):t.lineTo(e.x,e.y))})),n(),t.restore()}function Ut(t,e){Yt(t,e,(function(){t.closePath(),t.stroke()}))}function Xt(t,e){Yt(t,e,(function(){t.closePath(),t.fill()}))}function Gt(t,e,n,i){t.beginPath();var r=t.lineWidth%2?.5:0;t.moveTo(n,e+r),t.lineTo(i,e+r),t.stroke(),t.closePath()}function qt(t,e,n,i){t.beginPath();var r=t.lineWidth%2?.5:0;t.moveTo(e+r,n),t.lineTo(e+r,i),t.stroke(),t.closePath()}function $t(t,e){Yt(t,e,(function(){t.stroke(),t.closePath()}))}function Kt(t){return t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.devicePixelRatio||2}function Zt(t,e){return Math.round(t.measureText(e).width)}function Jt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Helvetica Neue";return"".concat(e," ").concat(t,"px ").concat(n)}function Qt(t,e,n){t.font=Jt(n.size,n.weight,n.family);var i=Zt(t,e);return n.paddingLeft+n.paddingRight+i+2*(n.borderSize||0)}function te(t){return t.paddingTop+t.paddingBottom+t.size+2*(t.borderSize||0)}function ee(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ne(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return t.length>i?{done:!1,value:t[i++]}:{done:!0}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);e>n;n++)i[n]=t[n];return i}function ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var re="other",ae="point",oe="none",se="line",ce="text",he="continuous_line",le="polygon",ue="arc",fe=0,de=1,pe=2,ve={NORMAL:"normal",WEAK_MAGNET:"weak_magnet",STRONG_MAGNET:"strong_magnet"},_e=function(t){dt(n,t);var e=ie(n);function n(t){var i,r=t.id,a=t.name,o=t.totalStep,s=t.chartStore,c=t.xAxis,h=t.yAxis,l=t.points,u=t.styles,f=t.lock,d=t.mode,v=t.data;return p(this,n),(i=e.call(this,{id:r,chartStore:s,xAxis:c,yAxis:h}))._name=a,i._totalStep=o,i._lock=f,i._mode=ve.NORMAL,i.setMode(d),i._data=v,i._drawStep=1,i._points=[],i.setPoints(l),i.setStyles(u,s.styleOptions().shape),i._prevPressPoint=null,i._prevPoints=null,i._coordinates=[],i}return _(n,[{key:"setPoints",value:function(t){if(x(t)&&t.length>0){var e;this._totalStep-1>t.length?(this._drawStep=t.length+1,this._points=g(t),e=t.length):(this._drawStep=-1,this._points=t.slice(0,this._totalStep-1),e=this._totalStep-1);for(var n=0;e>n;n++)this.performEventMoveForDrawing({step:n+2,mode:this._mode,points:this._points,movePoint:this._points[n],xAxis:this._xAxis,yAxis:this._yAxis});return-1===this._drawStep&&this.performEventPressedMove({mode:this._mode,points:this._points,pressPointIndex:this._points.length-1,pressPoint:this._points[this._points.length-1],xAxis:this._xAxis,yAxis:this._yAxis}),!0}}},{key:"_timestampOrDataIndexToCoordinateX",value:function(t){var e=t.timestamp,n=t.dataIndex;return e&&(n=this._chartStore.timeScaleStore().timestampToDataIndex(e)),this._xAxis.convertToPixel(n)}},{key:"_drawLines",value:function(t,e,n,i){t.save(),t.strokeStyle=n.color||i.color,t.lineWidth=n.size||i.size,n.style===O&&t.setLineDash(n.dashValue||i.dashValue),e.forEach((function(e){var n,i;if(e.length>1)switch((n=e[0]).x===(i=e[1]).x?pe:n.y===i.y?de:fe){case fe:$t(t,e);break;case de:Gt(t,e[0].y,e[0].x,e[1].x);break;case pe:qt(t,e[0].x,e[0].y,e[1].y)}})),t.restore()}},{key:"_drawContinuousLines",value:function(t,e,n,i){t.save(),t.strokeStyle=n.color||i.color,t.lineWidth=n.size||i.size,n.style===O&&t.setLineDash(n.dashValue||i.dashValue),e.forEach((function(e){e.length>0&&$t(t,e)})),t.restore()}},{key:"_drawPolygons",value:function(t,e,n,i){var r;if(t.save(),n.style===A)t.fillStyle=(n.fill||i.fill).color,r=Xt;else{var a=n.stroke||i.stroke;a.style===O&&t.setLineDash(a.dashValue),t.lineWidth=a.size,t.strokeStyle=a.color,r=Ut}e.forEach((function(e){e.length>0&&r(t,e)})),t.restore()}},{key:"_drawArcs",value:function(t,e,n,i){if(t.save(),n.style===A)t.fillStyle=(n.fill||i.fill).color;else{var r=n.stroke||i.stroke;r.style===O&&t.setLineDash(r.dashValue),t.lineWidth=r.size,t.strokeStyle=r.color}e.forEach((function(e){var i=e.x,r=e.y,a=e.radius,o=e.startAngle,s=e.endAngle;t.beginPath(),t.arc(i,r,a,o,s),n.style===A?(t.closePath(),t.fill()):(t.stroke(),t.closePath())})),t.restore()}},{key:"_drawText",value:function(t,e,n,i){var r;t.save(),n.style===C?(t.strokeStyle=n.color||i.color,r=t.strokeText):(t.fillStyle=n.color||i.color,r=t.fillText),t.font=Jt(n.size||i.size,n.weight||i.weight,n.family||i.family);var a=n.offset||i.offset||[0,0];e.forEach((function(e){r.call(t,e.text,e.x+a[1],e.y+a[0])})),t.restore()}},{key:"draw",value:function(t){var e=this;this._coordinates=this._points.map((function(t){var n=t.value;return{x:e._timestampOrDataIndexToCoordinateX({timestamp:t.timestamp,dataIndex:t.dataIndex}),y:e._yAxis.convertToPixel(n)}}));var n=this._styles||this._chartStore.styleOptions().shape;if(1!==this._drawStep&&this._coordinates.length>0){var i={width:this._xAxis.width(),height:this._yAxis.height()},r={price:this._chartStore.pricePrecision(),volume:this._chartStore.volumePrecision()};this._shapeDataSources=this.createShapeDataSource({step:this._drawStep,mode:this._mode,points:this._points,coordinates:this._coordinates,viewport:{width:this._xAxis.width(),height:this._yAxis.height()},precision:{price:this._chartStore.pricePrecision(),volume:this._chartStore.volumePrecision()},styles:n,xAxis:this._xAxis,yAxis:this._yAxis,data:this._data})||[],this._shapeDataSources.forEach((function(i){var r=i.styles,a=i.dataSource,o=void 0===a?[]:a;if(i.isDraw)switch(i.type){case se:e._drawLines(t,o,r||n.line,n.line);break;case he:e._drawContinuousLines(t,o,r||n.line,n.line);break;case le:e._drawPolygons(t,o,r||n.polygon,n.polygon);break;case ue:e._drawArcs(t,o,r||n.arc,n.arc);break;case ce:e._drawText(t,o,r||n.text,n.text)}})),this.drawExtend&&(t.save(),this.drawExtend({ctx:t,dataSource:this._shapeDataSources,styles:n,viewport:i,precision:r,mode:this._mode,xAxis:this._xAxis,yAxis:this._yAxis,data:this._data}),t.restore())}var a=this._chartStore.shapeStore().eventOperate();(a.hover.id===this._id&&a.hover.element!==oe||a.click.id===this._id&&a.click.element!==oe||this.isDrawing())&&this._coordinates.forEach((function(i,r){var o=i.x,s=i.y,c=n.point.radius,h=n.point.backgroundColor,l=n.point.borderColor,u=n.point.borderSize;a.hover.id===e._id&&a.hover.element===ae&&r===a.hover.elementIndex&&(c=n.point.activeRadius,h=n.point.activeBackgroundColor,l=n.point.activeBorderColor,u=n.point.activeBorderSize),Rt(t,l,{x:o,y:s},c+u),Rt(t,h,{x:o,y:s},c)}))}},{key:"setLock",value:function(t){this._lock=t}},{key:"name",value:function(){return this._name}},{key:"lock",value:function(){return this._lock}},{key:"totalStep",value:function(){return this._totalStep}},{key:"mode",value:function(){return this._mode}},{key:"setMode",value:function(t){Object.values(ve).indexOf(t)>-1&&(this._mode=t)}},{key:"setData",value:function(t){return void 0!==t&&t!==this._data&&(this._data=t,!0)}},{key:"data",value:function(){return this._data}},{key:"points",value:function(){return this._points}},{key:"isDrawing",value:function(){return-1!==this._drawStep}},{key:"isStart",value:function(){return 1===this._drawStep}},{key:"checkEventCoordinateOn",value:function(t){for(var e=this._styles||this._chartStore.styleOptions().shape,n=this._coordinates.length-1;n>-1;n--)if(Ht(this._coordinates[n],e.point.radius,t))return{id:this._id,element:ae,elementIndex:n,instance:this};if(this._shapeDataSources){var i,r=ee(this._shapeDataSources);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=a.key,s=a.type,c=a.dataSource,h=void 0===c?[]:c;if(a.isCheck)for(var l=0;h.length>l;l++)if(this.checkEventCoordinateOnShape({key:o,type:s,dataSource:h[l],eventCoordinate:t}))return{id:this._id,element:re,elementIndex:l,instance:this}}}catch(t){r.e(t)}finally{r.f()}}}},{key:"_performValue",value:function(t,e,n){var i=this._yAxis.convertFromPixel(t);if(this._mode===ve.NORMAL||"candle_pane"!==n)return i;var r=this._chartStore.timeScaleStore().getDataByDataIndex(e);if(!r)return i;if(i>r.high){if(this._mode===ve.WEAK_MAGNET){var a=this._yAxis.convertToPixel(r.high);return this._yAxis.convertFromPixel(a-8)>i?r.high:i}return r.high}if(r.low>i){if(this._mode===ve.WEAK_MAGNET){var o=this._yAxis.convertToPixel(r.low);return i>this._yAxis.convertFromPixel(o-8)?r.low:i}return r.low}var s=Math.max(r.open,r.close);if(i>s)return r.high-i>i-s?s:r.high;var c=Math.min(r.open,r.close);return c>i?c-i>i-r.low?r.low:c:i-c>s-i?s:c}},{key:"mouseMoveForDrawing",value:function(t,e){var n=this._xAxis.convertFromPixel(t.x),i=this._chartStore.timeScaleStore().dataIndexToTimestamp(n),r=this._performValue(t.y,n,e.paneId);this._points[this._drawStep-1]={timestamp:i,value:r,dataIndex:n},this.performEventMoveForDrawing({step:this._drawStep,mode:this._mode,points:this._points,movePoint:{timestamp:i,value:r,dataIndex:n},xAxis:this._xAxis,yAxis:this._yAxis}),this.onDrawing({id:this._id,step:this._drawStep,points:this._points})}},{key:"mouseLeftButtonDownForDrawing",value:function(){this._drawStep===this._totalStep-1?(this._drawStep=-1,this._chartStore.shapeStore().progressInstanceComplete(),this.onDrawEnd({id:this._id,points:this._points})):this._drawStep++}},{key:"mousePressedPointMove",value:function(t,e){var n=this._chartStore.shapeStore().eventOperate(),i=n.click.elementIndex;if(!this._lock&&n.click.id===this._id&&n.click.element===ae&&-1!==i){var r=this._xAxis.convertFromPixel(t.x),a=this._chartStore.timeScaleStore().dataIndexToTimestamp(r),o=this._performValue(t.y,r,e.paneId);this._points[i].timestamp=a,this._points[i].dataIndex=r,this._points[i].value=o,this.performEventPressedMove({points:this._points,mode:this._mode,pressPointIndex:i,pressPoint:{dataIndex:r,timestamp:a,value:o},xAxis:this._xAxis,yAxis:this._yAxis}),this.onPressedMove({id:this._id,element:ae,points:this._points,event:e})}}},{key:"startPressedOtherMove",value:function(t){var e=this._xAxis.convertFromPixel(t.x),n=this._yAxis.convertFromPixel(t.y);this._prevPressPoint={dataIndex:e,value:n},this._prevPoints=g(this._points)}},{key:"mousePressedOtherMove",value:function(t,e){var n=this;if(!this._lock&&this._prevPressPoint){var i=this._xAxis.convertFromPixel(t.x),r=this._yAxis.convertFromPixel(t.y),a=i-this._prevPressPoint.dataIndex,o=r-this._prevPressPoint.value;this._points=this._prevPoints.map((function(t){b(t.dataIndex)||(t.dataIndex=n._chartStore.timeScaleStore().timestampToDataIndex(t.timestamp));var e=t.dataIndex+a;return{dataIndex:e,value:t.value+o,timestamp:n._chartStore.timeScaleStore().dataIndexToTimestamp(e)}})),this.onPressedMove({id:this._id,element:re,points:this._points,event:e})}}},{key:"onDrawStart",value:function(t){}},{key:"onDrawing",value:function(t){}},{key:"onDrawEnd",value:function(t){}},{key:"onPressedMove",value:function(t){}},{key:"onRemove",value:function(t){}},{key:"checkEventCoordinateOnShape",value:function(t){}},{key:"createShapeDataSource",value:function(t){}},{key:"performEventMoveForDrawing",value:function(t){}},{key:"performEventPressedMove",value:function(t){}}]),n}(Mt),me=1,ye=2,ge=3;function xe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Se(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xe(Object(n),!0).forEach((function(e){It(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ke(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return we(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return t.length>i?{done:!1,value:t[i++]}:{done:!0}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function we(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);e>n;n++)i[n]=t[n];return i}function be(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var Ee=function(){function t(e){p(this,t),this._chartStore=e,this._templates=this._createTemplates(),this._eventOperate={click:{id:"",element:oe,elementIndex:-1},hover:{id:"",element:oe,elementIndex:-1}},this._progressInstance=null,this._pressedInstance=null,this._instances=new Map}return _(t,[{key:"_createTemplates",value:function(){var t={},e=d.shapeExtensions;for(var n in e){var i=this._createTemplateClass(e[n]);i&&(t[n]=i)}return t}},{key:"_createTemplateClass",value:function(t){var e=t.name,n=t.totalStep,i=t.checkEventCoordinateOnShape,r=t.createShapeDataSource,a=t.performEventPressedMove,o=t.performEventMoveForDrawing,s=t.drawExtend;if(!(e&&w(n)&&S(i)&&S(r)))return null;var c=function(t){dt(r,t);var i=be(r);function r(t){var a=t.id,o=t.chartStore,s=t.xAxis,c=t.yAxis,h=t.points,l=t.styles,u=t.lock,f=t.mode,d=t.data;return p(this,r),i.call(this,{id:a,name:e,totalStep:n,chartStore:o,xAxis:s,yAxis:c,points:h,styles:l,lock:u,mode:f,data:d})}return _(r)}(_e);return c.prototype.checkEventCoordinateOnShape=i,c.prototype.createShapeDataSource=r,S(a)&&(c.prototype.performEventPressedMove=a),S(o)&&(c.prototype.performEventMoveForDrawing=o),S(s)&&(c.prototype.drawExtend=s),c}},{key:"addTemplate",value:function(t){var e=this;t.forEach((function(t){var n=e._createTemplateClass(t);n&&(e._templates[t.name]=n)}))}},{key:"getTemplate",value:function(t){return this._templates[t]}},{key:"getInstance",value:function(t){var e,n=ke(this._instances);try{for(n.s();!(e=n.n()).done;){var i=(e.value[1]||[]).find((function(e){return e.id()===t}));if(i)return i}}catch(t){n.e(t)}finally{n.f()}return null}},{key:"hasInstance",value:function(t){return!!this.getInstance(t)}},{key:"addInstance",value:function(t,e){t.isDrawing()?this._progressInstance={paneId:e,instance:t,fixed:b(e)}:(this._instances.has(e)||this._instances.set(e,[]),this._instances.get(e).push(t)),this._chartStore.invalidate(me)}},{key:"progressInstance",value:function(){return this._progressInstance||{}}},{key:"progressInstanceComplete",value:function(){var t=this.progressInstance(),e=t.instance,n=t.paneId;e&&!e.isDrawing()&&(this._instances.has(n)||this._instances.set(n,[]),this._instances.get(n).push(e),this._progressInstance=null)}},{key:"updateProgressInstance",value:function(t,e){var n=this.progressInstance(),i=n.instance;i&&!n.fixed&&(i.setYAxis(t),this._progressInstance.paneId=e)}},{key:"pressedInstance",value:function(){return this._pressedInstance||{}}},{key:"updatePressedInstance",value:function(t,e,n){this._pressedInstance=t?{instance:t,paneId:e,element:n}:null}},{key:"instances",value:function(t){return this._instances.get(t)||[]}},{key:"setInstanceOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,n=t.styles,i=t.lock,r=t.mode,a=t.data,o=t.points,s=this._chartStore.styleOptions().shape,c=!1,h=function(t){t.setLock(i),t.setMode(r),(t.setStyles(n,s)||t.setData(a)||t.setPoints(o))&&(c=!0)};if(b(e)){var l=this.getInstance(e);l&&h(l)}else this._instances.forEach((function(t){return t.forEach(h)}));c&&this._chartStore.invalidate(me)}},{key:"getInstanceInfo",value:function(t){var e=function(t){return{name:t.name(),id:t.id(),totalStep:t.totalStep(),lock:t.lock(),mode:t.mode(),points:t.points(),styles:t.styles(),data:t.data()}},n=this.progressInstance();if(!b(t)){var i={};return this._instances.forEach((function(t,r){i[r]=t.map((function(t){return e(t)})),n.paneId===r&&n.instance&&i[r].push(e(n.instance))})),i}if(n.instance&&n.instance.id()===t)return e(n.instance);var r=this.getInstance(t);return r?e(r):null}},{key:"removeInstance",value:function(t){var e=!1,n=this.progressInstance().instance;if(!n||b(t)&&n.id()!==t||(n.onRemove({id:n.id()}),this._progressInstance=null,e=!0),b(t)){var i,r=ke(this._instances);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=a[1]||[],s=o.findIndex((function(e){return e.id()===t}));if(s>-1){o[s].onRemove({id:o[s].id()}),o.splice(s,1),0===o.length&&this._instances.delete(a[0]),e=!0;break}}}catch(t){r.e(t)}finally{r.f()}}else this._instances.forEach((function(t){t.length>0&&t.forEach((function(t){t.onRemove({id:t.id()})}))})),this._instances.clear(),e=!0;e&&this._chartStore.invalidate(me)}},{key:"eventOperate",value:function(){return this._eventOperate}},{key:"setEventOperate",value:function(t){var e,n,i=this._eventOperate,r=i.hover,a=i.click;return!t.hover||r.id===t.hover.id&&r.element===t.hover.element&&r.elementIndex===t.hover.elementIndex||(this._eventOperate.hover=Se({},t.hover),e=!0),!t.click||a.id===t.click.id&&a.element===t.click.element&&a.elementIndex===t.click.elementIndex||(this._eventOperate.click=Se({},t.click),n=!0),e||n}},{key:"isEmpty",value:function(){return 0===this._instances.size&&!this.progressInstance().instance}},{key:"isDrawing",value:function(){var t=this.progressInstance().instance;return t&&t.isDrawing()}},{key:"isPressed",value:function(){return!!this.pressedInstance().instance}}]),t}();function Pe(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ce(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ce(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return t.length>i?{done:!1,value:t[i++]}:{done:!0}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ce(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);e>n;n++)i[n]=t[n];return i}function Ae(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var Oe=function(){function t(e){p(this,t),this._chartStore=e,this._annotations=new Map,this._visibleAnnotations=new Map,this._eventOperate={id:""}}return _(t,[{key:"eventOperate",value:function(){return this._eventOperate}},{key:"setEventOperate",value:function(t){t&&this._eventOperate.id!==t.id&&(this._eventOperate=function(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ae(Object(n),!0).forEach((function(e){It(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t))}},{key:"createVisibleAnnotations",value:function(){var t=this;this._visibleAnnotations.clear(),this._annotations.size>0&&this._chartStore.visibleDataList().forEach((function(e){var n=e.data,i=e.x;t._annotations.forEach((function(e,r){if(e.size>0){var a=e.get(n.timestamp)||[];if(a.length>0){var o,s=Pe(a);try{for(s.s();!(o=s.n()).done;){var c=o.value;c.createSymbolCoordinate(i),t._visibleAnnotations.has(r)?t._visibleAnnotations.get(r).push(c):t._visibleAnnotations.set(r,[c])}}catch(t){s.e(t)}finally{s.f()}}}}))}))}},{key:"add",value:function(t,e){var n=this;this._annotations.has(e)||this._annotations.set(e,new Map),t.forEach((function(t){var i=n._annotations.get(e);i.has(t.id())?i.get(t.id()).push(t):i.set(t.id(),[t])})),this.createVisibleAnnotations(),this._chartStore.invalidate(me)}},{key:"get",value:function(t){return this._visibleAnnotations.get(t)}},{key:"remove",value:function(t,e){var n=!1;if(b(t)){if(this._annotations.has(t))if(b(e)){var i=this._annotations.get(t);[].concat(e).forEach((function(t){var e=t.timestamp;i.has(e)&&(n=!0,i.delete(e))})),0===i.size&&this._annotations.delete(t),n&&this.createVisibleAnnotations()}else n=!0,this._annotations.delete(t),this._visibleAnnotations.delete(t)}else n=!0,this._annotations.clear(),this._visibleAnnotations.clear();n&&this._chartStore.invalidate(me)}},{key:"isEmpty",value:function(){return 0===this._visibleAnnotations.size}}]),t}(),Te=function(){function t(e){p(this,t),this._chartStore=e,this._tags=new Map}return _(t,[{key:"_getById",value:function(t,e){var n=this.get(e);return n?n.get(t):null}},{key:"has",value:function(t,e){return!!this._getById(t,e)}},{key:"update",value:function(t,e,n){var i=this._getById(t,e);return!!i&&i.update(n)}},{key:"get",value:function(t){return this._tags.get(t)}},{key:"add",value:function(t,e){this._tags.has(e)||this._tags.set(e,new Map);var n=this._tags.get(e);t.forEach((function(t){n.set(t.id(),t)})),this._chartStore.invalidate(me)}},{key:"remove",value:function(t,e){var n=!1;if(b(t)){if(this._tags.has(t))if(b(e)){var i=this._tags.get(t);[].concat(e).forEach((function(t){i.has(t)&&(n=!0,i.delete(t))})),0===i.size&&this._tags.delete(t)}else n=!0,this._tags.delete(t)}else n=!0,this._tags.clear();n&&this._chartStore.invalidate(me)}}]),t}();function Ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function De(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ie(Object(n),!0).forEach((function(e){It(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Me=function(){function t(e){p(this,t),this._chartStore=e,this._crosshair={}}return _(t,[{key:"set",value:function(t,e){var n,i,r=this._chartStore.dataList(),a=t||{},o=r[i=b(a.x)?0>(n=this._chartStore.timeScaleStore().coordinateToDataIndex(a.x))?0:n>r.length-1?r.length-1:n:n=r.length-1],s=this._chartStore.timeScaleStore().dataIndexToCoordinate(n),c=this._crosshair.x,h=this._crosshair.y,l=this._crosshair.paneId;this._crosshair=De(De({},a),{},{realX:s,kLineData:o,realDataIndex:n,dataIndex:i}),o&&this._chartStore.crosshairChange(this._crosshair),c===a.x&&h===a.y&&l===a.paneId||e||this._chartStore.invalidate(me)}},{key:"recalculate",value:function(t){this.set(this._crosshair,t)}},{key:"get",value:function(){return this._crosshair}}]),t}(),Re=function(){function t(){p(this,t),this._observers=[]}return _(t,[{key:"subscribe",value:function(t){0>this._observers.indexOf(t)&&this._observers.push(t)}},{key:"unsubscribe",value:function(t){var e=this._observers.indexOf(t);e>-1?this._observers.splice(e,1):this._observers=[]}},{key:"execute",value:function(t){this._observers.forEach((function(e){e(t)}))}},{key:"hasObservers",value:function(){return this._observers.length>0}}]),t}(),Le=function(){function t(){p(this,t),this._delegates=new Map}return _(t,[{key:"execute",value:function(t,e){this.has(t)&&this._delegates.get(t).execute(e)}},{key:"has",value:function(t){return this._delegates.has(t)&&this._delegates.get(t).hasObservers()}},{key:"subscribe",value:function(t,e){this._delegates.has(t)||this._delegates.set(t,new Re),this._delegates.get(t).subscribe(e)}},{key:"unsubscribe",value:function(t,e){if(lt(t)){var n=this._delegates.get(t);return n.unsubscribe(e),n.hasObservers()||this._delegates.delete(t),!0}return!1}}]),t}(),Be=function(){function t(e,n){p(this,t),this._handler=n,this._styleOptions=g(tt),y(this._styleOptions,e),this._pricePrecision=2,this._volumePrecision=0,this._dataList=[],this._visibleDataList=[],this._dragPaneFlag=!1,this._timeScaleStore=new ut(this),this._technicalIndicatorStore=new Tt(this),this._shapeStore=new Ee(this),this._annotationStore=new Oe(this),this._tagStore=new Te(this),this._crosshairStore=new Me(this),this._actionStore=new Le}return _(t,[{key:"adjustVisibleDataList",value:function(){this._visibleDataList=[];for(var t=this._timeScaleStore.from(),e=this._timeScaleStore.to(),n=t;e>n;n++){var i=this._dataList[n],r=this._timeScaleStore.dataIndexToCoordinate(n);this._visibleDataList.push({index:n,x:r,data:i})}this._annotationStore.createVisibleAnnotations()}},{key:"styleOptions",value:function(){return this._styleOptions}},{key:"applyStyleOptions",value:function(t){y(this._styleOptions,t)}},{key:"pricePrecision",value:function(){return this._pricePrecision}},{key:"volumePrecision",value:function(){return this._volumePrecision}},{key:"setPriceVolumePrecision",value:function(t,e){this._pricePrecision=t,this._volumePrecision=e,this._technicalIndicatorStore.setSeriesPrecision(t,e)}},{key:"dataList",value:function(){return this._dataList}},{key:"visibleDataList",value:function(){return this._visibleDataList}},{key:"addData",value:function(t,e,n){if(k(t)){if(x(t)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(!E(n)||n);var i=0===this._dataList.length;this._dataList=t.concat(this._dataList),i&&this._timeScaleStore.resetOffsetRightSpace(),this._timeScaleStore.adjustFromTo()}else if(e<this._dataList.length)this._dataList[e]=t,this.adjustVisibleDataList();else{this._dataList.push(t);var r=this._timeScaleStore.offsetRightBarCount();0>r&&this._timeScaleStore.setOffsetRightBarCount(--r),this._timeScaleStore.adjustFromTo()}this._crosshairStore.recalculate(!0)}}},{key:"clearDataList",value:function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear()}},{key:"timeScaleStore",value:function(){return this._timeScaleStore}},{key:"technicalIndicatorStore",value:function(){return this._technicalIndicatorStore}},{key:"shapeStore",value:function(){return this._shapeStore}},{key:"annotationStore",value:function(){return this._annotationStore}},{key:"tagStore",value:function(){return this._tagStore}},{key:"crosshairStore",value:function(){return this._crosshairStore}},{key:"actionStore",value:function(){return this._actionStore}},{key:"invalidate",value:function(t){this._handler.invalidate(t)}},{key:"crosshairChange",value:function(t){this._handler.crosshair(t)}},{key:"dragPaneFlag",value:function(){return this._dragPaneFlag}},{key:"setDragPaneFlag",value:function(t){this._dragPaneFlag=t}}]),t}();function Ne(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vt(t)););return t}function Fe(){return Fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=Ne(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(3>arguments.length?t:n):r.value}},Fe.apply(this,arguments)}function je(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement(t);for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n.style[i]=e[i]);return n}var ze="content",Ve="yAxis",He=function(){function t(e){p(this,t),this._height=-1,this._container=e.container,this._chartStore=e.chartStore,this._initBefore(e),this._initElement(),this._mainWidget=this._createMainWidget(this._element,e),this._yAxisWidget=this._createYAxisWidget(this._element,e)}return _(t,[{key:"_initBefore",value:function(t){}},{key:"_initElement",value:function(){this._element=je("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"});var t=this._container.lastChild;t?this._container.insertBefore(this._element,t):this._container.appendChild(this._element)}},{key:"_createMainWidget",value:function(t,e){}},{key:"_createYAxisWidget",value:function(t,e){}},{key:"container",value:function(t){switch(t){case ze:return this._mainWidget.container();case Ve:return this._yAxisWidget.container();default:return this._element}}},{key:"width",value:function(){return this._element.offsetWidth}},{key:"setWidth",value:function(t,e){this._mainWidget.setWidth(t),this._yAxisWidget&&this._yAxisWidget.setWidth(e)}},{key:"height",value:function(){return this._height}},{key:"setHeight",value:function(t){this._height=t,this._mainWidget.setHeight(t),this._yAxisWidget&&this._yAxisWidget.setHeight(t)}},{key:"setOffsetLeft",value:function(t,e){this._mainWidget.setOffsetLeft(t),this._yAxisWidget&&this._yAxisWidget.setOffsetLeft(e)}},{key:"layout",value:function(){this._element.offsetHeight!==this._height&&(this._element.style.height="".concat(this._height,"px")),this._mainWidget.layout(),this._yAxisWidget&&this._yAxisWidget.layout()}},{key:"invalidate",value:function(t){this._yAxisWidget&&this._yAxisWidget.invalidate(t),this._mainWidget.invalidate(t)}},{key:"createHtml",value:function(t){var e=t.id,n=t.content,i=t.style;return t.position===Ve?this._yAxisWidget&&this._yAxisWidget.createHtml({id:e,content:n,style:i}):this._mainWidget.createHtml({id:e,content:n,style:i})}},{key:"removeHtml",value:function(t){this._yAxisWidget&&this._yAxisWidget.removeHtml(t),this._mainWidget.removeHtml(t)}},{key:"getImage",value:function(t){var e=this._element.offsetWidth,n=this._element.offsetHeight,i=je("canvas",{width:"".concat(e,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=i.getContext("2d"),a=Kt(i);i.width=e*a,i.height=n*a,r.scale(a,a);var o=this._mainWidget.getElement(),s=o.offsetWidth,c=o.offsetHeight,h=parseInt(o.style.left,10);if(r.drawImage(this._mainWidget.getImage(t),h,0,s,c),this._yAxisWidget){var l=this._yAxisWidget.getElement(),u=l.offsetWidth,f=l.offsetHeight,d=parseInt(l.style.left,10);r.drawImage(this._yAxisWidget.getImage(t),d,0,u,f)}return i}},{key:"destroy",value:function(){this._container.removeChild(this._element)}}]),t}();function We(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var Ye=function(){function t(e){p(this,t),this._width=0,this._height=0,this._initElement(e.container),this._mainView=this._createMainView(this._element,e),this._overlayView=this._createOverlayView(this._element,e),this._htmlBaseId=0,this._htmls=new Map}return _(t,[{key:"_initElement",value:function(t){this._element=je("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box"}),t.appendChild(this._element)}},{key:"_createMainView",value:function(t,e){}},{key:"_createOverlayView",value:function(t,e){}},{key:"container",value:function(){return this._element}},{key:"createHtml",value:function(t){var e=t.id,n=t.content,i=t.style,r=je("div",function(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?We(Object(n),!0).forEach((function(e){It(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({boxSizing:"border-box",position:"absolute",zIndex:12},void 0===i?{}:i));if(P(n)){var a=n.replace(/(^\s*)|(\s*$)/g,"");r.innerHTML=a}else r.appendChild(n);var o=e||"html_".concat(++this._htmlBaseId);return this._htmls.has(o)?this._element.replaceChild(r,this._htmls.get(o)):this._element.appendChild(r),this._htmls.set(o,r),o}},{key:"removeHtml",value:function(t){var e=this;t?[].concat(t).forEach((function(t){var n=e._htmls.get(t);n&&(e._element.removeChild(n),e._htmls.delete(t))})):(this._htmls.forEach((function(t){e._element.removeChild(t)})),this._htmls.clear())}},{key:"getElement",value:function(){return this._element}},{key:"setWidth",value:function(t){this._width=t,this._mainView.setWidth(t),this._overlayView.setWidth(t)}},{key:"setHeight",value:function(t){this._height=t,this._mainView.setHeight(t),this._overlayView.setHeight(t)}},{key:"setOffsetLeft",value:function(t){this._element.style.left="".concat(t,"px")}},{key:"layout",value:function(){this._element.offsetWidth!==this._width&&(this._element.style.width="".concat(this._width,"px")),this._element.offsetHeight!==this._height&&(this._element.style.height="".concat(this._height,"px")),this._mainView.layout(),this._overlayView.layout()}},{key:"invalidate",value:function(t){switch(t){case me:this._overlayView.flush();break;case ye:case ge:this._mainView.flush(),this._overlayView.flush()}}},{key:"getImage",value:function(t){var e=je("canvas",{width:"".concat(this._width,"px"),height:"".concat(this._height,"px"),boxSizing:"border-box"}),n=e.getContext("2d"),i=Kt(e);return e.width=this._width*i,e.height=this._height*i,n.scale(i,i),n.drawImage(this._mainView.getImage(),0,0,this._width,this._height),t&&this._overlayView&&n.drawImage(this._overlayView.getImage(),0,0,this._width,this._height),e}}]),t}();function Ue(t){return window.requestAnimationFrame?window.requestAnimationFrame(t):window.setTimeout(t,20)}function Xe(t){window.cancelAnimationFrame||clearTimeout(t),window.cancelAnimationFrame(t)}var Ge=function(){function t(e,n){p(this,t),this._chartStore=n,this._initCanvas(e)}return _(t,[{key:"_initCanvas",value:function(t){this._canvas=je("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._ctx=this._canvas.getContext("2d"),t.appendChild(this._canvas)}},{key:"_redraw",value:function(t){this._ctx.clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetHeight),t&&t(),this._draw()}},{key:"_draw",value:function(){}},{key:"setWidth",value:function(t){this._width=t}},{key:"setHeight",value:function(t){this._height=t}},{key:"layout",value:function(){var t=this;this._height!==this._canvas.offsetHeight||this._width!==this._canvas.offsetWidth?this._redraw((function(){var e=Kt(t._canvas);t._canvas.style.width="".concat(t._width,"px"),t._canvas.style.height="".concat(t._height,"px"),t._canvas.width=Math.floor(t._width*e),t._canvas.height=Math.floor(t._height*e),t._ctx.scale(e,e)})):this.flush()}},{key:"flush",value:function(){var t=this;this.requestAnimationId&&(Xe(this.requestAnimationId),this.requestAnimationId=null),this.requestAnimationId=Ue((function(){t._redraw()}))}},{key:"getImage",value:function(){return this._canvas}}]),t}();function qe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var $e=function(t){dt(n,t);var e=qe(n);function n(t,i,r,a,o){var s;return p(this,n),(s=e.call(this,t,i))._xAxis=r,s._yAxis=a,s._paneId=o,s}return _(n,[{key:"_draw",value:function(){this._ctx.globalCompositeOperation="destination-over",this._drawContent()}},{key:"_drawContent",value:function(){this._drawTechs(),this._drawGrid()}},{key:"_drawGrid",value:function(){var t=this,e=this._chartStore.styleOptions().grid;if(e.show){var n=e.horizontal;this._ctx.save(),n.show&&(this._ctx.strokeStyle=n.color,this._ctx.lineWidth=n.size,this._ctx.setLineDash(n.style===O?n.dashValue:[]),this._yAxis.ticks().forEach((function(e){Gt(t._ctx,e.y,0,t._width)})));var i=e.vertical;i.show&&(this._ctx.strokeStyle=i.color,this._ctx.lineWidth=i.size,this._ctx.setLineDash(i.style===O?i.dashValue:[]),this._xAxis.ticks().forEach((function(e){qt(t._ctx,e.x,0,t._height)}))),this._ctx.restore()}}},{key:"_drawTechs",value:function(){var t=this;this._ctx.globalCompositeOperation="source-over";var e=this._chartStore.timeScaleStore().to(),n=this._chartStore.styleOptions().technicalIndicator;this._chartStore.technicalIndicatorStore().instances(this._paneId).forEach((function(i){var r=i.plots,a=[],o=t._chartStore.dataList(),s=i.result,c=i.styles||n;i.render&&(t._ctx.save(),i.render({ctx:t._ctx,dataSource:{from:t._chartStore.timeScaleStore().from(),to:e,kLineDataList:t._chartStore.dataList(),technicalIndicatorDataList:s},viewport:{width:t._width,height:t._height,dataSpace:t._chartStore.timeScaleStore().dataSpace(),barSpace:t._chartStore.timeScaleStore().barSpace()},styles:c,xAxis:t._xAxis,yAxis:t._yAxis}),t._ctx.restore());var h=c.line.colors||[],l=h.length,u=[],f=[],d=t._yAxis.isCandleYAxis();t._ctx.lineWidth=1,t._drawGraphics((function(n,p,v,_,m){var y=s[p]||{},g=0;i.shouldOhlc&&!d&&t._drawCandleBar(n,_,m,v,c.bar,z),r.forEach((function(i){var r=y[i.key],d=t._yAxis.convertToPixel(r);switch(i.type){case wt:if(b(r)){var v=Et(o,s,p,i,c,{color:c.circle.noChangeColor,isStroke:!0});t._drawCircle({x:n,y:d,radius:_,color:v.color,isStroke:v.isStroke})}break;case kt:if(b(r)){var m;m=b(i.baseValue)?i.baseValue:t._yAxis.min();var x=t._yAxis.convertToPixel(m),S=Math.abs(x-d),k={x:n-_,width:2*_,height:Math.max(1,S)};k.y=d>x?x:1>S?x-1:d;var w=Et(o,s,p,i,c,{color:c.bar.noChangeColor});k.color=w.color,k.isStroke=w.isStroke,t._drawBar(k)}break;case St:var E=null;if(b(r)){E=Et(o,s,p,i,c,{color:h[g%l]});var P={x:n,y:d},C=u[g];f[g]||(f[g]=[]),f[g].push(P),C&&(C.color!==E.color||C.isDashed!==E.isDashed)&&(a.push({color:C.color,isDashed:C.isDashed,coordinates:f[g]}),f[g]=[P]),p===e-1&&a.push({color:E.color,isDashed:E.isDashed,coordinates:f[g]})}u[g]=E,g++}}))}),(function(){t._drawLines(a,c)}))})),this._ctx.globalCompositeOperation="destination-over"}},{key:"_drawGraphics",value:function(t,e){var n=this._chartStore.visibleDataList(),i=this._chartStore.timeScaleStore().barSpace(),r=this._chartStore.timeScaleStore().halfBarSpace();n.forEach((function(e,n){t(e.x,e.index,e.data,r,i,n)})),e&&e()}},{key:"_drawLines",value:function(t,e){var n=this;this._ctx.lineWidth=e.line.size,t.forEach((function(t){n._ctx.strokeStyle=t.color,n._ctx.setLineDash(t.isDashed?e.line.dashValue:[]),$t(n._ctx,t.coordinates)}))}},{key:"_drawBar",value:function(t){t.isStroke?(this._ctx.strokeStyle=t.color,this._ctx.strokeRect(t.x+.5,t.y,t.width-1,t.height)):(this._ctx.fillStyle=t.color,this._ctx.fillRect(t.x,t.y,t.width,t.height))}},{key:"_drawCircle",value:function(t){this._ctx.strokeStyle=t.color,this._ctx.fillStyle=t.color,this._ctx.beginPath(),this._ctx.arc(t.x,t.y,t.radius,2*Math.PI,0,!0),t.isStroke?this._ctx.stroke():this._ctx.fill(),this._ctx.closePath()}},{key:"_drawCandleBar",value:function(t,e,n,i,r,a){var o=i.open,s=i.close,c=i.high,h=i.low;s>o?(this._ctx.strokeStyle=r.upColor,this._ctx.fillStyle=r.upColor):o>s?(this._ctx.strokeStyle=r.downColor,this._ctx.fillStyle=r.downColor):(this._ctx.strokeStyle=r.noChangeColor,this._ctx.fillStyle=r.noChangeColor);var l=this._yAxis.convertToPixel(o),u=this._yAxis.convertToPixel(s),f=[l,u,this._yAxis.convertToPixel(c),this._yAxis.convertToPixel(h)];f.sort((function(t,e){return t-e})),this._ctx.fillRect(t-.5,f[0],1,f[1]-f[0]),this._ctx.fillRect(t-.5,f[2],1,f[3]-f[2]);var d=Math.max(1,f[2]-f[1]);switch(a){case B:this._ctx.fillRect(t-e,f[1],n,d);break;case N:this._ctx.strokeRect(t-e+.5,f[1],n-1,d);break;case F:s>o?this._ctx.strokeRect(t-e+.5,f[1],n-1,d):this._ctx.fillRect(t-e,f[1],n,d);break;case j:s>o?this._ctx.fillRect(t-e,f[1],n,d):this._ctx.strokeRect(t-e+.5,f[1],n-1,d);break;default:this._ctx.fillRect(t-.5,f[0],1,f[3]-f[0]),this._ctx.fillRect(t-e,l,e,1),this._ctx.fillRect(t,u,e,1)}}}]),n}(Ge);function Ke(t,e,n,i,r){t.fillStyle=e,t.fillText(r,n,i)}function Ze(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var Je=function(t){dt(n,t);var e=Ze(n);function n(t,i,r,a,o){var s;return p(this,n),(s=e.call(this,t,i))._xAxis=r,s._yAxis=a,s._paneId=o,s}return _(n,[{key:"_draw",value:function(){this._ctx.textBaseline="alphabetic",this._drawTag(),this._drawShape(),this._drawAnnotation();var t=this._chartStore.crosshairStore().get();if(t.kLineData){var e=this._chartStore.styleOptions().crosshair;t.paneId===this._paneId&&this._drawCrosshairLine(e,"horizontal",t.y,0,this._width,Gt),t.paneId&&this._drawCrosshairLine(e,"vertical",t.realX,0,this._height,qt),this._drawTooltip(t,this._chartStore.technicalIndicatorStore().instances(this._paneId))}}},{key:"_drawAnnotation",value:function(){var t=this,e=this._chartStore.annotationStore().get(this._paneId);e&&e.forEach((function(e){e.draw(t._ctx)}))}},{key:"_drawTag",value:function(){var t=this,e=this._chartStore.tagStore().get(this._paneId);e&&e.forEach((function(e){e.drawMarkLine(t._ctx)}))}},{key:"_drawShape",value:function(){var t=this;this._chartStore.shapeStore().instances(this._paneId).forEach((function(e){e.draw(t._ctx)}));var e=this._chartStore.shapeStore().progressInstance();e.paneId===this._paneId&&e.instance.draw(this._ctx)}},{key:"_drawTooltip",value:function(t,e){var n=this._chartStore.styleOptions().technicalIndicator;this._drawBatchTechToolTip(t,e,n,0,this._shouldDrawTooltip(t,n.tooltip))}},{key:"_drawCrosshairLine",value:function(t,e,n,i,r,a){var o=t[e],s=o.line;t.show&&o.show&&s.show&&(this._ctx.save(),this._ctx.lineWidth=s.size,this._ctx.strokeStyle=s.color,s.style===O&&this._ctx.setLineDash(s.dashValue),a(this._ctx,n,i,r),this._ctx.restore())}},{key:"_drawBatchTechToolTip",value:function(t,e,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0;if(!a)return 0;var o=n.tooltip,s=r,c=s;return e.forEach((function(e){s+=o.text.marginTop+i._drawTechTooltip(t,e,n,s)+o.text.marginBottom})),s-c}},{key:"_drawTechTooltip",value:function(t,e,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=n.tooltip,o=a.text,s=o.marginLeft,c=o.marginRight,h=o.size,l=o.color,u=0,f=o.marginTop+r,d=h,p=this._getTechTooltipData(t,e,n);if(this._ctx.textBaseline="top",this._ctx.font=Jt(h,o.weight,o.family),a.showName){var v=p.name,_=Zt(this._ctx,v);Ke(this._ctx,l,u+=s,f,v),u+=_,a.showParams||(u+=c)}if(a.showParams){var m=p.calcParamText,y=Zt(this._ctx,m);a.showName||(u+=s),Ke(this._ctx,l,u,f,m),u+=y+c}return p.values.forEach((function(t){u+=s;var e="".concat(t.title).concat(t.value),n=Zt(i._ctx,e);u+n>i._width&&(u=s,d+=h+1,f+=h+1),Ke(i._ctx,t.color||o.color,u,f,e),u+=n+c})),d}},{key:"_shouldDrawTooltip",value:function(t,e){var n=e.showRule;return n===H||n===W&&!!t.paneId}},{key:"_getTechTooltipData",value:function(t,e,n){var i=this._chartStore.dataList(),r=e.result,a="",o=e.calcParams;if(o.length>0){var s=o.map((function(t){return k(t)?t.value:t}));a="(".concat(s.join(","),")")}var c=[];if(S(e.createToolTipDataSource))c=e.createToolTipDataSource({dataSource:{from:this._chartStore.timeScaleStore().from(),to:this._chartStore.timeScaleStore().to(),kLineDataList:this._chartStore.dataList(),technicalIndicatorDataList:r},viewport:{width:this._width,height:this._height,dataSpace:this._chartStore.timeScaleStore().dataSpace(),barSpace:this._chartStore.timeScaleStore().barSpace()},crosshair:t,technicalIndicator:e,xAxis:this._xAxis,yAxis:this._yAxis,defaultStyles:n})||[];else{var h=e.styles||n,l=r[t.dataIndex],u=e.precision,f=e.shouldFormatBigNumber,d=h.line.colors||[],p=d.length,v=0;e.plots.forEach((function(e){var a={};switch(e.type){case wt:a={color:h.circle.noChangeColor};break;case kt:a={color:h.bar.noChangeColor};break;case St:a={color:d[v%p]||n.tooltip.text.color},v++}var o=Et(i,r,t.dataIndex,e,h,a),s={};if(b(e.title)){var _=(l||{})[e.key];b(_)&&(_=it(_,u),f&&(_=rt(_))),s.title=e.title,s.value=_||n.tooltip.defaultValue,s.color=o.color,c.push(s)}}))}return{values:c,name:e.shortName,calcParamText:a}}}]),n}(Ge);function Qe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var tn=function(t){dt(n,t);var e=Qe(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"_createMainView",value:function(t,e){return new $e(t,e.chartStore,e.xAxis,e.yAxis,e.paneId)}},{key:"_createOverlayView",value:function(t,e){return new Je(t,e.chartStore,e.xAxis,e.yAxis,e.paneId)}}]),n}(Ye);function en(t,e,n,i,r,a,o,s,c){rn(t,e,r,a,o,s,c),nn(t,n,i,r,a,o,s,c)}function nn(t,e,n,i,r,a,o,s){t.lineWidth=n,t.strokeStyle=e,an(t,i,r,a,o,s),t.stroke()}function rn(t,e,n,i,r,a,o){t.fillStyle=e,an(t,n,i,r,a,o),t.fill()}function an(t,e,n,i,r,a){t.beginPath(),t.moveTo(e+a,n),t.arcTo(e+i,n,e+i,n+r,a),t.arcTo(e+i,n+r,e,n+r,a),t.arcTo(e,n+r,e,n,a),t.arcTo(e,n,e+i,n,a),t.closePath()}function on(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function sn(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?on(Object(n),!0).forEach((function(e){It(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function cn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var hn=function(t){dt(n,t);var e=cn(n);function n(t,i,r,a){var o;return p(this,n),(o=e.call(this,t,i))._yAxis=r,o._paneId=a,o}return _(n,[{key:"_draw",value:function(){var t=this._chartStore.styleOptions().yAxis;t.show&&(this._drawAxisLine(t),this._drawTickLines(t),this._drawTickLabels(t),this._drawTechLastValue(),this._drawLastPriceLabel())}},{key:"_drawAxisLine",value:function(t){var e,n=t.axisLine;n.show&&(this._ctx.strokeStyle=n.color,this._ctx.lineWidth=n.size,e=this._yAxis.isFromYAxisZero()?0:this._width-1,qt(this._ctx,e,0,this._height))}},{key:"_drawTickLines",value:function(t){var e=this,n=t.tickLine;if(n.show){this._ctx.lineWidth=n.size,this._ctx.strokeStyle=n.color;var i,r,a=n.length;this._yAxis.isFromYAxisZero()?(i=0,t.axisLine.show&&(i+=t.axisLine.size),r=i+a):(i=this._width,t.axisLine.show&&(i-=t.axisLine.size),r=i-a),this._yAxis.ticks().forEach((function(t){Gt(e._ctx,t.y,i,r)}))}}},{key:"_drawTickLabels",value:function(t){var e=this,n=t.tickText;if(n.show){var i,r=t.tickLine,a=r.show,o=r.length;this._yAxis.isFromYAxisZero()?(i=n.paddingLeft,t.axisLine.show&&(i+=t.axisLine.size),a&&(i+=o),this._ctx.textAlign="left"):(i=this._width-n.paddingRight,t.axisLine.show&&(i-=t.axisLine.size),a&&(i-=o),this._ctx.textAlign="right"),this._ctx.textBaseline="middle",this._ctx.font=Jt(n.size,n.weight,n.family),this._ctx.fillStyle=n.color,this._yAxis.ticks().forEach((function(t){e._ctx.fillText(t.v,i,t.y)})),this._ctx.textAlign="left"}}},{key:"_drawTechLastValue",value:function(){var t=this,e=this._chartStore.styleOptions().technicalIndicator,n=e.lastValueMark;if(n.show&&n.text.show){var i=this._chartStore.technicalIndicatorStore().instances(this._paneId),r=this._chartStore.dataList();i.forEach((function(i){var a=i.result||[],o=a.length,s=a[o-1]||{},c={prev:{kLineData:r[o-2],technicalIndicatorData:a[o-2]},current:{kLineData:r[o-1],technicalIndicatorData:s},next:{kLineData:null,technicalIndicatorData:null}},h=i.precision,l=i.styles||e,u=l.line.colors||[],f=u.length,d=0;i.plots.forEach((function(e){var r,a=s[e.key];switch(e.type){case wt:r=e.color&&e.color(c,l)||l.circle.noChangeColor;break;case kt:r=e.color&&e.color(c,l)||l.bar.noChangeColor;break;case St:r=u[d%f],d++}b(a)&&t._drawMarkLabel(a,h,i.shouldFormatBigNumber,sn(sn({},n.text),{},{backgroundColor:r}))}))}))}}},{key:"_drawLastPriceLabel",value:function(){if(this._yAxis.isCandleYAxis()){var t=this._chartStore.styleOptions().candle.priceMark,e=t.last;if(t.show&&e.show&&e.text.show){var n=this._chartStore.dataList(),i=n[n.length-1];if(i){var r,a=i.close,o=i.open;r=a>o?e.upColor:o>a?e.downColor:e.noChangeColor,this._drawMarkLabel(a,this._chartStore.pricePrecision(),!1,sn(sn({},e.text),{},{backgroundColor:r}))}}}}},{key:"_drawMarkLabel",value:function(t,e,n,i){var r,a=i.size,o=i.weight,s=i.family,c=i.color,h=i.backgroundColor,l=i.borderRadius,u=i.paddingLeft,f=i.paddingTop,d=i.paddingRight,p=i.paddingBottom,v=this._yAxis.convertToNicePixel(t);if(this._yAxis.yAxisType()===R){var _=((this._chartStore.visibleDataList()[0]||{}).data||{}).close;r="".concat(((t-_)/_*100).toFixed(2),"%")}else r=it(t,e),n&&(r=rt(r));this._ctx.font=Jt(a,o,s);var m,y=Zt(this._ctx,r)+u+d,g=f+a+p;m=this._yAxis.isFromYAxisZero()?0:this._width-y,rn(this._ctx,h,m,v-f-a/2,y,g,l),this._ctx.textBaseline="middle",Ke(this._ctx,c,m+u,v,r)}}]),n}(Ge);function ln(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var un=function(t){dt(n,t);var e=ln(n);function n(t,i,r,a){var o;return p(this,n),(o=e.call(this,t,i))._yAxis=r,o._paneId=a,o}return _(n,[{key:"_draw",value:function(){this._ctx.textBaseline="middle",this._drawTag(),this._drawCrossHairLabel()}},{key:"_drawTag",value:function(){var t=this,e=this._chartStore.tagStore().get(this._paneId);e&&e.forEach((function(e){e.drawText(t._ctx)}))}},{key:"_drawCrossHairLabel",value:function(){var t=this._chartStore.crosshairStore().get();if(t.paneId===this._paneId&&0!==this._chartStore.dataList().length){var e=this._chartStore.styleOptions().crosshair,n=e.horizontal,i=n.text;if(e.show&&n.show&&i.show){var r,a,o=this._yAxis.convertFromPixel(t.y);if(this._yAxis.yAxisType()===R){var s=(this._chartStore.visibleDataList()[0]||{}).data||{};r="".concat(((o-s.close)/s.close*100).toFixed(2),"%")}else{var c=this._chartStore.technicalIndicatorStore().instances(this._paneId),h=0,l=!1;this._yAxis.isCandleYAxis()?h=this._chartStore.pricePrecision():c.forEach((function(t){h=Math.max(t.precision,h),l||(l=t.shouldFormatBigNumber)})),r=it(o,h),l&&(r=rt(r))}var u=i.borderSize,f=Qt(this._ctx,r,i),d=te(i);a=this._yAxis.isFromYAxisZero()?0:this._width-f,en(this._ctx,i.backgroundColor,i.borderColor,u,a,t.y-u-i.paddingTop-i.size/2,f,d,i.borderRadius),Ke(this._ctx,i.color,a+u+i.paddingLeft,t.y,r)}}}}]),n}(Ge);function fn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var dn=function(t){dt(n,t);var e=fn(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"_createMainView",value:function(t,e){return new hn(t,e.chartStore,e.yAxis,e.paneId)}},{key:"_createOverlayView",value:function(t,e){return new un(t,e.chartStore,e.yAxis,e.paneId)}}]),n}(Ye),pn=function(){function t(e){p(this,t),this._chartStore=e,this._width=0,this._height=0,this._cacheMinValue=0,this._cacheMaxValue=0,this._minValue=0,this._maxValue=0,this._range=0,this._ticks=[],this._initMeasureCanvas()}return _(t,[{key:"_initMeasureCanvas",value:function(){var t=je("canvas"),e=Kt(t);this._measureCtx=t.getContext("2d"),this._measureCtx.scale(e,e)}},{key:"min",value:function(){return this._minValue}},{key:"max",value:function(){return this._maxValue}},{key:"width",value:function(){return this._width}},{key:"height",value:function(){return this._height}},{key:"setWidth",value:function(t){this._width=t}},{key:"setHeight",value:function(t){this._height=t}},{key:"ticks",value:function(){return this._ticks}},{key:"computeAxis",value:function(t){var e=this._optimalMinMax(this._computeMinMax());return this._minValue=e.min,this._maxValue=e.max,this._range=e.range,!(this._cacheMinValue===e.min&&this._cacheMaxValue===e.max&&!t)&&(this._cacheMinValue=e.min,this._cacheMaxValue=e.max,this._ticks=this._optimalTicks(this._computeTicks()),!0)}},{key:"_computeMinMax",value:function(){}},{key:"_optimalMinMax",value:function(t){}},{key:"_computeTicks",value:function(){var t=[];if(this._range>=0){var e=this._computeInterval(this._range),n=e.interval,i=e.precision,r=ot(Math.ceil(this._minValue/n)*n,i),a=ot(Math.floor(this._maxValue/n)*n,i),o=0,s=r;if(0!==n)for(;a>=s;)t[o]={v:s.toFixed(i)},++o,s+=n}return t}},{key:"_optimalTicks",value:function(t){}},{key:"_computeInterval",value:function(t){var e,n,i,r,a=(n=Math.floor(st(e=t/8)),i=ct(n),e=(1.5>(r=e/i)?1:2.5>r?2:3.5>r?3:4.5>r?4:5.5>r?5:6.5>r?6:8)*i,-20>n?e:+e.toFixed(0>n?-n:0)),o=function(t){var e=""+t,n=e.indexOf("e");if(n>0){var i=+e.slice(n+1);return 0>i?-i:0}var r=e.indexOf(".");return 0>r?0:e.length-1-r}(a);return{interval:a,precision:o}}}]),t}();function vn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var _n=function(t){dt(n,t);var e=vn(n);function n(t,i,r){var a;return p(this,n),(a=e.call(this,t))._realRange=0,a._isCandleYAxis=i,a._paneId=r,a}return _(n,[{key:"_computeMinMax",value:function(){var t,e=this,n=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER],i=[],r=!1,a=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;this._chartStore.technicalIndicatorStore().instances(this._paneId).forEach((function(n){if(r||(r=n.shouldOhlc),s=Math.min(s,n.precision),w(n.minValue)&&(a=Math.min(a,n.minValue)),w(n.maxValue)&&(o=Math.max(o,n.maxValue)),n.styles){t||(t={top:0,bottom:0});var c=n.styles.margin;w(c.top)&&(t.top=Math.max(1>c.top?c.top:c.top/e._height,t.top)),w(c.bottom)&&(t.bottom=Math.max(1>c.bottom?c.bottom:c.bottom/e._height,t.bottom))}i.push({plots:n.plots,result:n.result})}));var c=4;if(this._isCandleYAxis){var h=this._chartStore.pricePrecision();c=s!==Number.MAX_SAFE_INTEGER?Math.min(s,h):h}else s!==Number.MAX_SAFE_INTEGER&&(c=s);var l=this._chartStore.visibleDataList(),u=this._chartStore.styleOptions().candle,f=u.type===V,d=u.area.value,p=this._isCandleYAxis&&!f||!this._isCandleYAxis&&r;return l.forEach((function(t){var r=t.index,a=t.data;p&&(n[0]=Math.min(n[0],a.low),n[1]=Math.max(n[1],a.high)),e._isCandleYAxis&&f&&(n[0]=Math.min(n[0],a[d]),n[1]=Math.max(n[1],a[d])),i.forEach((function(t){var e=t.result[r]||{};t.plots.forEach((function(t){var i=e[t.key];b(i)&&(n[0]=Math.min(n[0],i),n[1]=Math.max(n[1],i))}))}))})),n[0]!==Number.MAX_SAFE_INTEGER&&n[1]!==Number.MIN_SAFE_INTEGER?(n[0]=Math.min(a,n[0]),n[1]=Math.max(o,n[1])):(n[0]=0,n[1]=10),{min:n[0],max:n[1],precision:c,specifyMin:a,specifyMax:o,techGap:t}}},{key:"_optimalMinMax",value:function(t){var e,n,i=t.precision,r=t.specifyMin,a=t.specifyMax,o=t.techGap,s=t.min,c=t.max,h=this.yAxisType();switch(h){case R:var l=(this._chartStore.visibleDataList()[0]||{}).data||{};w(l.close)&&(s=(s-l.close)/l.close*100,c=(c-l.close)/l.close*100),e=.01;break;case L:s=st(s),c=st(c),e=.05*ct(-i);break;default:e=ct(-i)}if(s===c||e>Math.abs(s-c)){var u=r===s,f=a===c;s=u?s:f?s-8*e:s-4*e,c=f?c:u?c+8*e:c+4*e}var d,p=.2;w((n=this._isCandleYAxis?this._chartStore.styleOptions().candle.margin:o?{top:0,bottom:0}:this._chartStore.styleOptions().technicalIndicator.margin).top)&&(d=1>n.top?n.top:n.top/this._height,p=o?Math.max(o.top,d):d);var v,_=.1;w(n.bottom)&&(v=1>n.bottom?n.bottom:n.bottom/this._height,_=o?Math.max(o.bottom,v):v);var m=Math.abs(c-s);return m=Math.abs((c+=m*p)-(s-=m*_)),this._realRange=h===L?Math.abs(ct(c)-ct(s)):m,{min:s,max:c,range:m}}},{key:"_optimalTicks",value:function(t){var e=this,n=[],i=this.yAxisType(),r=this._chartStore.technicalIndicatorStore().instances(this._paneId),a=0,o=!1;this._isCandleYAxis?a=this._chartStore.pricePrecision():r.forEach((function(t){a=Math.max(a,t.precision),o||(o=t.shouldFormatBigNumber)}));var s,c,h=this._chartStore.styleOptions().xAxis.tickText.size;return i===L&&(s=this._computeInterval(this._realRange)),t.forEach((function(t){var r,l=t.v,u=e._innerConvertToPixel(+l);switch(i){case R:r="".concat(it(l,2),"%");break;case L:r=ot(ct(l),s.precision),u=e._innerConvertToPixel(st(r)),r=it(r,a);break;default:r=it(l,a),o&&(r=rt(r))}u>h&&e._height-h>u&&(c&&Math.abs(c-u)>2*h||!c)&&(n.push({v:r,y:u}),c=u)})),n}},{key:"_innerConvertToPixel",value:function(t){var e=(t-this._minValue)/this._range;return this.isReverse()?Math.round(e*this._height):Math.round((1-e)*this._height)}},{key:"isCandleYAxis",value:function(){return this._isCandleYAxis}},{key:"yAxisType",value:function(){return this._isCandleYAxis?this._chartStore.styleOptions().yAxis.type:M}},{key:"isReverse",value:function(){return this._isCandleYAxis&&this._chartStore.styleOptions().yAxis.reverse}},{key:"isFromYAxisZero",value:function(){var t=this._chartStore.styleOptions().yAxis;return t.position===I&&t.inside||t.position===D&&!t.inside}},{key:"getSelfWidth",value:function(){var t=this,e=this._chartStore.styleOptions(),n=e.yAxis,i=n.width;if(w(i))return i;var r=0;if(n.show&&(n.axisLine.show&&(r+=n.axisLine.size),n.tickLine.show&&(r+=n.tickLine.length),n.tickText.show)){var a=0;this._measureCtx.font=Jt(n.tickText.size,n.tickText.weight,n.tickText.family),this._ticks.forEach((function(e){a=Math.max(a,Zt(t._measureCtx,e.v))})),r+=n.tickText.paddingLeft+n.tickText.paddingRight+a}var o=e.crosshair,s=0;if(o.show&&o.horizontal.show&&o.horizontal.text.show){var c=this._chartStore.technicalIndicatorStore().instances(this._paneId),h=0,l=!1;c.forEach((function(t){h=Math.max(t.precision,h),l||(l=t.shouldFormatBigNumber)})),this._measureCtx.font=Jt(o.horizontal.text.size,o.horizontal.text.weight,o.horizontal.text.family);var u=2;if(this.yAxisType()!==R)if(this._isCandleYAxis){var f=this._chartStore.pricePrecision(),d=e.technicalIndicator.lastValueMark;u=d.show&&d.text.show?Math.max(h,f):f}else u=h;var p=it(this._maxValue,u);l&&(p=rt(p)),s+=o.horizontal.text.paddingLeft+o.horizontal.text.paddingRight+2*o.horizontal.text.borderSize+Zt(this._measureCtx,p)}return Math.max(r,s)}},{key:"convertFromPixel",value:function(t){var e=(this.isReverse()?t/this._height:1-t/this._height)*this._range+this._minValue;switch(this.yAxisType()){case R:var n=(this._chartStore.visibleDataList()[0]||{}).data||{};if(w(n.close))return n.close*e/100+n.close;break;case L:return ct(e);default:return e}}},{key:"convertToPixel",value:function(t){var e;switch(this.yAxisType()){case R:var n=(this._chartStore.visibleDataList()[0]||{}).data||{};w(n.close)&&(e=(t-n.close)/n.close*100);break;case L:e=st(t);break;default:e=t}return this._innerConvertToPixel(e)}},{key:"convertToNicePixel",value:function(t){var e=this.convertToPixel(t);return Math.round(Math.max(.05*this._height,Math.min(e,.98*this._height)))}}]),n}(pn);function mn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var yn=function(t){dt(n,t);var e=mn(n);function n(t){var i;return p(this,n),(i=e.call(this,t))._minHeight=30,i._initHeight(t),i}return _(n,[{key:"_initBefore",value:function(t){this._id=t.id,this._yAxis=this._createYAxis(t)}},{key:"_initHeight",value:function(t){var e=t.height,n=t.minHeight;if(b(n)&&this.setMinHeight(n),b(e)){var i=this.minHeight();this.setHeight(i>e?i:e)}}},{key:"_createYAxis",value:function(t){return new _n(t.chartStore,!1,t.id)}},{key:"_createMainWidget",value:function(t,e){return new tn({container:t,chartStore:e.chartStore,xAxis:e.xAxis,yAxis:this._yAxis,paneId:e.id})}},{key:"_createYAxisWidget",value:function(t,e){return new dn({container:t,chartStore:e.chartStore,yAxis:this._yAxis,paneId:e.id})}},{key:"minHeight",value:function(){return this._minHeight}},{key:"setMinHeight",value:function(t){this._minHeight=t}},{key:"setHeight",value:function(t){Fe(vt(n.prototype),"setHeight",this).call(this,t),this._yAxis.setHeight(t)}},{key:"setWidth",value:function(t,e){Fe(vt(n.prototype),"setWidth",this).call(this,t,e),this._yAxis.setWidth(e)}},{key:"id",value:function(){return this._id}},{key:"yAxis",value:function(){return this._yAxis}}]),n}(He);function gn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var xn=function(t){dt(n,t);var e=gn(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"_drawContent",value:function(){var t=this._chartStore.styleOptions().candle;this._drawLastPriceLine(t.priceMark),t.type===V?this._drawArea(t):(this._drawHighLowPrice(t.priceMark),this._drawCandle(t)),this._drawTechs(),this._drawGrid()}},{key:"_drawArea",value:function(t){var e=this,n=[],i=[],r=Number.MAX_SAFE_INTEGER,a=t.area;this._drawGraphics((function(t,o,s,c,h,l){var u=s[a.value];if(w(u)){var f=e._yAxis.convertToPixel(u);if(0===l){var d=t-c;i.push({x:d,y:e._height}),i.push({x:d,y:f}),n.push({x:d,y:f})}n.push({x:t,y:f}),i.push({x:t,y:f}),r=Math.min(r,f)}}),(function(){var t=i.length;if(t>0){var o=i[t-1],s=e._chartStore.timeScaleStore().halfBarSpace(),c=o.x+s;n.push({x:c,y:o.y}),i.push({x:c,y:o.y}),i.push({x:c,y:e._height})}if(n.length>0&&(e._ctx.lineWidth=a.lineSize,e._ctx.strokeStyle=a.lineColor,$t(e._ctx,n)),i.length>0){var h=a.backgroundColor;if(x(h)){var l=e._ctx.createLinearGradient(0,e._height,0,r);try{h.forEach((function(t){l.addColorStop(t.offset,t.color)}))}catch(t){}e._ctx.fillStyle=l}else e._ctx.fillStyle=h;Xt(e._ctx,i)}}))}},{key:"_drawCandle",value:function(t){var e=this;this._drawGraphics((function(n,i,r,a,o){e._drawCandleBar(n,a,o,r,t.bar,t.type)}))}},{key:"_drawHighLowPrice",value:function(t){if(t.show&&(t.high.show||t.low.show)){var e={price:Number.MIN_SAFE_INTEGER,pos:-1},n={price:Number.MAX_SAFE_INTEGER,pos:-1};this._chartStore.visibleDataList().forEach((function(t){var i=t.index,r=t.data,a=et(r,"high",Number.MIN_SAFE_INTEGER);a>e.price&&(e.price=a,e.pos=i);var o=et(r,"low",Number.MAX_SAFE_INTEGER);n.price>o&&(n.price=o,n.pos=i)}));var i=this._yAxis.convertToPixel(e.price);e.y=i;var r=this._yAxis.convertToPixel(n.price);n.y=r;var a=[],o=[];r>i?(a=[-2,-5],o=[2,5]):(a=[2,5],o=[-2,-5]);var s=this._chartStore.pricePrecision();this._ctx.textAlign="left",this._ctx.lineWidth=1,this._ctx.textBaseline="middle",this._drawRealHighLowPrice(t.high,a,s,e),this._drawRealHighLowPrice(t.low,o,s,n)}}},{key:"_drawRealHighLowPrice",value:function(t,e,n,i){if(t.show){var r=i.price,a=i.y,o=this._xAxis.convertToPixel(i.pos),s=a+e[0];this._ctx.strokeStyle=t.color,this._ctx.fillStyle=t.color,$t(this._ctx,[{x:o-2,y:s+e[0]},{x:o,y:s},{x:o+2,y:s+e[0]}]);var c=s+e[1];$t(this._ctx,[{x:o,y:s},{x:o,y:c},{x:o+5,y:c}]),this._ctx.font=Jt(t.textSize,t.textWeight,t.textFamily);var h=it(r,n);this._ctx.fillText(h,o+5+t.textMargin,c)}}},{key:"_drawLastPriceLine",value:function(t){var e=t.last;if(t.show&&e.show&&e.line.show){var n=this._chartStore.dataList(),i=n[n.length-1];if(i){var r,a=i.close,o=i.open,s=this._yAxis.convertToNicePixel(a);r=a>o?e.upColor:o>a?e.downColor:e.noChangeColor,this._ctx.save(),this._ctx.strokeStyle=r,this._ctx.lineWidth=e.line.size,e.line.style===O&&this._ctx.setLineDash(e.line.dashValue),Gt(this._ctx,s,0,this._width),this._ctx.restore()}}}}]),n}($e);function Sn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var kn=function(t){dt(n,t);var e=Sn(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"_drawTooltip",value:function(t,e){var n=this._chartStore.styleOptions(),i=n.candle,r=i.tooltip,a=n.technicalIndicator,o=a.tooltip,s=this._shouldDrawTooltip(t,r),c=this._shouldDrawTooltip(t,o);if(r.showType===Y&&o.showType===Y)this._drawCandleTooltipWithRect(t,e,i,s,a,0,c);else if(r.showType===U){var h=this._drawCandleTooltipWithStandard(t.kLineData,i,s);o.showType===U?this._drawBatchTechToolTip(t,e,a,s?h+r.text.marginTop:0,c):this._drawCandleTooltipWithRect(t,e,i,!1,a,h,c)}else{var l=this._drawBatchTechToolTip(t,e,a,0,c);this._drawCandleTooltipWithRect(t,e,i,s,a,l,!1)}}},{key:"_drawCandleTooltipWithStandard",value:function(t,e,n){var i=this;if(!n)return 0;var r=this._getCandleTooltipData(t,e),a=e.tooltip,o=a.text.marginLeft,s=a.text.marginRight,c=a.text.size,h=a.text.color,l=a.labels;this._ctx.textBaseline="top",this._ctx.font=Jt(c,a.text.weight,a.text.family);var u=o,f=a.text.marginTop,d=c;return l.forEach((function(t,e){var n,l,p=Zt(i._ctx,t),v=r[e]||a.defaultValue;k(v)?(n=v.value||a.defaultValue,l=v.color||h):(l=h,n=v);var _=Zt(i._ctx,n);u+p+_>i._width&&(u=o,d+=c+1,f+=c+1),Ke(i._ctx,h,u,f,t),Ke(i._ctx,l,u+p,f,n),u+=p+_+o+s})),d}},{key:"_drawCandleTooltipWithRect",value:function(t,e,n,i,r,a,o){var s=this;if(i||o){var c=n.tooltip,h=c.labels,l=this._getCandleTooltipData(t.kLineData,n),u=c.text.marginLeft,f=c.text.marginRight,d=c.text.marginTop,p=c.text.marginBottom,v=c.text.size,_=c.text.color,m=c.rect,y=m.borderSize,g=m.paddingLeft,x=m.paddingRight,S=m.paddingTop,w=m.paddingBottom,E=m.offsetLeft,P=m.offsetRight,C=0,A=0,O=0;this._ctx.save(),this._ctx.textBaseline="top",i&&(this._ctx.font=Jt(v,c.text.weight,c.text.family),h.forEach((function(t,e){var n,i=l[e];n=k(i)?i.value||c.defaultValue:i;var r="".concat(t).concat(n),a=Zt(s._ctx,r)+u+f;C=Math.max(C,a)})),O+=(p+d+v)*h.length);var T=r.tooltip,M=T.text.marginLeft,R=T.text.marginRight,L=T.text.marginTop,B=T.text.marginBottom,N=T.text.size,F=[];if(e.forEach((function(e){F.push(s._getTechTooltipData(t,e,r))})),o&&(this._ctx.font=Jt(N,T.text.weight,T.text.family),F.forEach((function(t){t.values.forEach((function(t){var e=t.title,n=t.value;if(b(e)){var i="".concat(e).concat(n),r=Zt(s._ctx,i)+M+R;C=Math.max(C,r),O+=L+B+N}}))}))),0!==(A+=C)&&0!==O){A+=2*y+g+x,O+=2*y+S+w;var j,z=this._chartStore.styleOptions();this._width/2>t.realX?(j=this._width-P-A,z.yAxis.inside&&z.yAxis.position===D&&(j-=this._yAxis.width())):(j=E,z.yAxis.inside&&z.yAxis.position===I&&(j+=this._yAxis.width()));var V=a+m.offsetTop,H=m.borderRadius;rn(this._ctx,m.backgroundColor,j,V,A,O,H),nn(this._ctx,m.borderColor,y,j,V,A,O,H);var W=j+y+g+u,Y=V+y+S;if(i&&(this._ctx.font=Jt(v,c.text.weight,c.text.family),h.forEach((function(t,e){Y+=d,s._ctx.textAlign="left",Ke(s._ctx,_,W,Y,t);var n,i,r=l[e];k(r)?(i=r.color||_,n=r.value||c.defaultValue):(i=_,n=r||c.defaultValue),s._ctx.textAlign="right",Ke(s._ctx,i,j+A-y-f-x,Y,n),Y+=v+p}))),o){var U=j+y+g+M;this._ctx.font=Jt(N,T.text.weight,T.text.family),F.forEach((function(t){t.values.forEach((function(t){Y+=L,s._ctx.textAlign="left",s._ctx.fillStyle=t.color||T.text.color,s._ctx.fillText(t.title,U,Y),s._ctx.textAlign="right",s._ctx.fillText(t.value,j+A-y-R-x,Y),Y+=N+B}))}))}this._ctx.restore()}}}},{key:"_getCandleTooltipData",value:function(t,e){var n=this,i=e.tooltip.values,r=[];if(i)S(i)?r=i(t,e)||[]:x(i)&&(r=i);else{var a=this._chartStore.pricePrecision(),o=this._chartStore.volumePrecision();(r=[et(t,"timestamp"),et(t,"open"),et(t,"close"),et(t,"high"),et(t,"low"),et(t,"volume")]).forEach((function(t,e){switch(e){case 0:r[e]=nt(n._chartStore.timeScaleStore().dateTimeFormat(),t,"YYYY-MM-DD hh:mm");break;case r.length-1:r[e]=rt(it(t,o));break;default:r[e]=it(t,a)}}))}return r}}]),n}(Je);function wn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var bn=function(t){dt(n,t);var e=wn(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"_createMainView",value:function(t,e){return new xn(t,e.chartStore,e.xAxis,e.yAxis,e.paneId)}},{key:"_createOverlayView",value:function(t,e){return new kn(t,e.chartStore,e.xAxis,e.yAxis,e.paneId)}}]),n}(tn);function En(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var Pn=function(t){dt(n,t);var e=En(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"_createYAxis",value:function(t){return new _n(t.chartStore,!0,t.id)}},{key:"_createMainWidget",value:function(t,e){return new bn({container:t,chartStore:e.chartStore,xAxis:e.xAxis,yAxis:this._yAxis,paneId:e.id})}}]),n}(yn);function Cn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var An=function(t){dt(n,t);var e=Cn(n);function n(t,i,r){var a;return p(this,n),(a=e.call(this,t,i))._xAxis=r,a}return _(n,[{key:"_draw",value:function(){var t=this._chartStore.styleOptions().xAxis;t.show&&(this._drawAxisLine(t),this._drawTickLines(t),this._drawTickLabels(t))}},{key:"_drawAxisLine",value:function(t){var e=t.axisLine;e.show&&(this._ctx.strokeStyle=e.color,this._ctx.lineWidth=e.size,Gt(this._ctx,0,0,this._width))}},{key:"_drawTickLines",value:function(t){var e=this,n=t.tickLine;if(n.show){this._ctx.lineWidth=n.size,this._ctx.strokeStyle=n.color;var i=t.axisLine.show?t.axisLine.size:0,r=i+n.length;this._xAxis.ticks().forEach((function(t){qt(e._ctx,t.x,i,r)}))}}},{key:"_drawTickLabels",value:function(t){var e=t.tickText;if(e.show){var n=t.tickLine;this._ctx.textBaseline="top",this._ctx.font=Jt(e.size,e.weight,e.family),this._ctx.textAlign="center",this._ctx.fillStyle=e.color;var i=e.paddingTop;t.axisLine.show&&(i+=t.axisLine.size),n.show&&(i+=n.length);for(var r=this._xAxis.ticks(),a=r.length,o=0;a>o;o++)this._ctx.fillText(r[o].v,r[o].x,i)}}}]),n}(Ge);function On(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var Tn=function(t){dt(n,t);var e=On(n);function n(t,i,r){var a;return p(this,n),(a=e.call(this,t,i))._xAxis=r,a}return _(n,[{key:"_draw",value:function(){this._drawCrosshairLabel()}},{key:"_drawCrosshairLabel",value:function(){var t=this._chartStore.crosshairStore().get();if(t.paneId){var e=this._chartStore.styleOptions().crosshair,n=e.vertical,i=n.text;if(e.show&&n.show&&i.show&&t.dataIndex===t.realDataIndex){var r=t.kLineData.timestamp,a=nt(this._chartStore.timeScaleStore().dateTimeFormat(),r,"YYYY-MM-DD hh:mm"),o=i.paddingLeft,s=i.paddingRight,c=i.paddingTop,h=i.borderSize,l=Qt(this._ctx,a,i),u=te(i),f=l-2*h-o-s,d=t.realX-f/2;o+h>d?d=o+h:d>this._width-f-h-s&&(d=this._width-f-h-s),en(this._ctx,i.backgroundColor,i.borderColor,h,d-h-o,0,l,u,i.borderRadius),this._ctx.textBaseline="top",Ke(this._ctx,i.color,d,h+c,a)}}}}]),n}(Ge);function In(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var Dn=function(t){dt(n,t);var e=In(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"_createMainView",value:function(t,e){return new An(t,e.chartStore,e.xAxis)}},{key:"_createOverlayView",value:function(t,e){return new Tn(t,e.chartStore,e.xAxis)}}]),n}(Ye);function Mn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var Rn=function(t){dt(n,t);var e=Mn(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"_computeMinMax",value:function(){return{min:this._chartStore.timeScaleStore().from(),max:this._chartStore.timeScaleStore().to()-1}}},{key:"_optimalMinMax",value:function(t){var e=t.min,n=t.max;return{min:e,max:n,range:n-e+1}}},{key:"_optimalTicks",value:function(t){var e=[],n=t.length,i=this._chartStore.dataList();if(n>0){var r=this._chartStore.timeScaleStore().dateTimeFormat(),a=this._chartStore.styleOptions().xAxis.tickText;this._measureCtx.font=Jt(a.size,a.weight,a.family);var o=Zt(this._measureCtx,"00-00 00:00"),s=this.convertToPixel(parseInt(t[0].v,10)),c=1;if(n>1){var h=this.convertToPixel(parseInt(t[1].v,10)),l=Math.abs(h-s);o>l&&(c=Math.ceil(o/l))}for(var u=0;n>u;u+=c){var f=parseInt(t[u].v,10),d=i[f].timestamp,p=nt(r,d,"hh:mm");0!==u&&(p=this._optimalTickLabel(r,d,i[parseInt(t[u-c].v,10)].timestamp)||p);var v=this.convertToPixel(f);e.push({v:p,x:v,oV:d})}if(1===e.length)e[0].v=nt(r,e[0].oV,"YYYY-MM-DD hh:mm");else{var _=e[0].oV,m=e[1].oV;if(e[2]){var y=e[2].v;/^[0-9]{2}-[0-9]{2}$/.test(y)?e[0].v=nt(r,_,"MM-DD"):/^[0-9]{4}-[0-9]{2}$/.test(y)?e[0].v=nt(r,_,"YYYY-MM"):/^[0-9]{4}$/.test(y)&&(e[0].v=nt(r,_,"YYYY"))}else e[0].v=this._optimalTickLabel(r,_,m)||e[0].v}}return e}},{key:"_optimalTickLabel",value:function(t,e,n){var i=nt(t,e,"YYYY"),r=nt(t,e,"YYYY-MM"),a=nt(t,e,"MM-DD");return i!==nt(t,n,"YYYY")?i:r!==nt(t,n,"YYYY-MM")?r:a!==nt(t,n,"MM-DD")?a:null}},{key:"getSelfHeight",value:function(){var t=this._chartStore.styleOptions(),e=t.xAxis,n=e.height;if(w(n))return n;var i=t.crosshair,r=0;e.show&&(e.axisLine.show&&(r+=e.axisLine.size),e.tickLine.show&&(r+=e.tickLine.length),e.tickText.show&&(r+=e.tickText.paddingTop+e.tickText.paddingBottom+e.tickText.size));var a=0;return i.show&&i.vertical.show&&i.vertical.text.show&&(a+=i.vertical.text.paddingTop+i.vertical.text.paddingBottom+2*i.vertical.text.borderSize+i.vertical.text.size),Math.max(r,a)}},{key:"convertFromPixel",value:function(t){return this._chartStore.timeScaleStore().coordinateToDataIndex(t)}},{key:"convertToPixel",value:function(t){return this._chartStore.timeScaleStore().dataIndexToCoordinate(t)}}]),n}(pn);function Ln(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var Bn=function(t){dt(n,t);var e=Ln(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"_initBefore",value:function(){this._xAxis=new Rn(this._chartStore)}},{key:"_createMainWidget",value:function(t,e){return new Dn({container:t,chartStore:e.chartStore,xAxis:this._xAxis})}},{key:"xAxis",value:function(){return this._xAxis}},{key:"setWidth",value:function(t,e){Fe(vt(n.prototype),"setWidth",this).call(this,t,e),this._xAxis.setWidth(t)}},{key:"setHeight",value:function(t){Fe(vt(n.prototype),"setHeight",this).call(this,t),this._xAxis.setHeight(t)}}]),n}(He),Nn="mouse",Fn="touch";function jn(t){return t.type===Fn}function zn(t){return t.type===Nn}function Vn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Hn(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vn(Object(n),!0).forEach((function(e){It(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Wn=0,Yn=2;function Un(t){return t.getBoundingClientRect()||{left:0,top:0}}function Xn(t){return!!t.touches}function Gn(t){t.cancelable&&t.preventDefault()}function qn(t,e){var n=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(n*n+i*i)}var $n=function(){function t(e,n,i){p(this,t),this._target=e,this._handler=n,this._options=i,this._clickCount=0,this._clickTimeoutId=null,this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartPosition=null,this._moveExceededManhattanDistance=!1,this._cancelClick=!1,this._unsubscribeOutsideEvents=null,this._unsubscribeMousemove=null,this._unsubscribeRoot=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventDragProcess=!1,this._mousePressed=!1,this._init()}return _(t,[{key:"setOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._options=Hn(Hn({},this.options),t)}},{key:"destroy",value:function(){null!==this._unsubscribeOutsideEvents&&(this._unsubscribeOutsideEvents(),this._unsubscribeOutsideEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),this._clearLongTapTimeout(),this._resetClickTimeout()}},{key:"_mouseEnterHandler",value:function(t){var e=this;this._unsubscribeMousemove&&this._unsubscribeMousemove();var n=this._mouseMoveHandler.bind(this),i=this._mouseWheelHandler.bind(this);this._unsubscribeMousemove=function(){e._target.removeEventListener("mousemove",n),e._target.removeEventListener("wheel",i)},this._target.addEventListener("mousemove",n),this._target.addEventListener("wheel",i,{passive:!1}),Xn(t)&&this._mouseMoveHandler(t);var r=this._makeCompatEvent(t);this._processEvent(r,this._handler.mouseEnterEvent)}},{key:"_resetClickTimeout",value:function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null}},{key:"_mouseMoveHandler",value:function(t){if(!this._mousePressed||Xn(t)){var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.mouseMoveEvent)}}},{key:"_mouseWheelHandler",value:function(t){var e=this._makeCompatEvent(t);t.localX=e.localX,t.localY=e.localY,this._processEvent(t,this._handler.mouseWheelEvent)}},{key:"_mouseMoveWithDownHandler",value:function(t){if((!("button"in t)||t.button===Wn)&&null===this._startPinchMiddleCoordinate){var e=Xn(t);if(!this._preventDragProcess||!e){this._pinchPrevented=!0;var n=this._makeCompatEvent(t),i=this._mouseMoveStartPosition,r=Math.abs(i.x-n.pageX),a=Math.abs(i.y-n.pageY),o=r+a>5;if(o||!e){if(o&&!this._moveExceededManhattanDistance&&e){var s=.5*r;a>=s&&!this._options.treatVertTouchDragAsPageScroll||s>a&&!this._options.treatHorzTouchDragAsPageScroll||(this._preventDragProcess=!0)}o&&(this._moveExceededManhattanDistance=!0,this._cancelClick=!0,e&&this._clearLongTapTimeout()),this._preventDragProcess||(this._processEvent(n,this._handler.pressedMouseMoveEvent),e&&Gn(t))}}}}},{key:"_mouseUpHandler",value:function(t){if(!("button"in t)||t.button===Wn){var e=this._makeCompatEvent(t);this._clearLongTapTimeout(),this._mouseMoveStartPosition=null,this._mousePressed=!1,this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),Xn(t)&&this._mouseLeaveHandler(t),this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId&&this._clickCount>1?(this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent),Xn(t)&&(Gn(t),this._mouseLeaveHandler(t),0===t.touches.length&&(this._longTapActive=!1))}}},{key:"_clearLongTapTimeout",value:function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}},{key:"_mouseDownHandler",value:function(t){if(!("button"in t)||t.button===Wn||t.button===Yn){var e=this._makeCompatEvent(t);if("button"in t&&t.button===Yn)this._processEvent(e,this._handler.mouseRightDownEvent);else{this._cancelClick=!1,this._moveExceededManhattanDistance=!1,this._preventDragProcess=!1,Xn(t)&&this._mouseEnterHandler(t),this._mouseMoveStartPosition={x:e.pageX,y:e.pageY},this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null);var n=this._mouseMoveWithDownHandler.bind(this),i=this._mouseUpHandler.bind(this),r=this._target.ownerDocument.documentElement;this._unsubscribeRoot=function(){r.removeEventListener("touchmove",n),r.removeEventListener("touchend",i),r.removeEventListener("mousemove",n),r.removeEventListener("mouseup",i)},r.addEventListener("touchmove",n,{passive:!1}),r.addEventListener("touchend",i,{passive:!1}),this._clearLongTapTimeout(),Xn(t)&&1===t.touches.length?this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),600):(r.addEventListener("mousemove",n),r.addEventListener("mouseup",i)),this._mousePressed=!0,this._processEvent(e,this._handler.mouseDownEvent),this._clickTimeoutId||(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500))}}}},{key:"_init",value:function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e,n=this._target.ownerDocument,i=function(e){t._handler.mouseDownOutsideEvent&&(e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent())};this._unsubscribeOutsideEvents=function(){n.removeEventListener("mousedown",i),n.removeEventListener("touchstart",i)},n.addEventListener("mousedown",i),n.addEventListener("touchstart",i,{passive:!0}),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._mouseDownHandler.bind(this),{passive:!0}),e="ontouchstart"in window||!!(window.DocumentTouch&&document instanceof window.DocumentTouch),"onorientationchange"in window&&(navigator.maxTouchPoints||navigator.msMaxTouchPoints||e)||this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})}},{key:"_initPinch",value:function(){var t=this;void 0===this._handler.pinchStartEvent&&void 0===this._handler.pinchEvent&&void 0===this._handler.pinchEndEvent||(this._target.addEventListener("touchstart",(function(e){return t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddleCoordinate&&void 0!==t._handler.pinchEvent){var n=qn(e.touches[0],e.touches[1]);t._handler.pinchEvent(t._startPinchMiddleCoordinate,n/t._startPinchDistance),Gn(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))}},{key:"_checkPinchState",value:function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)}},{key:"_startPinch",value:function(t){var e=Un(this._target);this._startPinchMiddleCoordinate={x:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,y:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this._startPinchDistance=qn(t[0],t[1]),void 0!==this._handler.pinchStartEvent&&this._handler.pinchStartEvent(),this._clearLongTapTimeout()}},{key:"_stopPinch",value:function(){null!==this._startPinchMiddleCoordinate&&(this._startPinchMiddleCoordinate=null,void 0!==this._handler.pinchEndEvent&&this._handler.pinchEndEvent())}},{key:"_mouseLeaveHandler",value:function(t){this._unsubscribeMousemove&&this._unsubscribeMousemove();var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.mouseLeaveEvent)}},{key:"_longTapHandler",value:function(t){var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.longTapEvent),this._cancelClick=!0,this._longTapActive=!0}},{key:"_processEvent",value:function(t,e){e&&e.call(this._handler,t)}},{key:"_makeCompatEvent",value:function(t){var e;e="touches"in t&&t.touches.length?t.touches[0]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0]:t;var n=Un(this._target);return{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY,localX:e.clientX-n.left,localY:e.clientY-n.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,type:t.type.startsWith("mouse")?Nn:Fn,target:e.target,view:t.view}}}]),t}(),Kn=function(){function t(e,n,i,r,a,o){p(this,t),this._chartStore=n,this._topPaneId=i,this._bottomPaneId=r,this._dragEnabled=a,this._width=0,this._offsetLeft=0,this._dragEventHandler=o,this._dragFlag=!1,this._initElement(e),this._initEvent(a)}return _(t,[{key:"_initElement",value:function(t){this._container=t,this._wrapper=je("div",{margin:"0",padding:"0",position:"relative",boxSizing:"border-box"}),this._element=je("div",{width:"100%",height:"7px",margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box"}),this._wrapper.appendChild(this._element);var e=t.lastChild;e?t.insertBefore(this._wrapper,e):t.appendChild(this._wrapper)}},{key:"_initEvent",value:function(t){t&&(this._element.style.cursor="ns-resize",this._dragEvent=new $n(this._element,{mouseDownEvent:this._mouseDownEvent.bind(this),mouseUpEvent:this._mouseUpEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this),mouseEnterEvent:this._mouseEnterEvent.bind(this),mouseLeaveEvent:this._mouseLeaveEvent.bind(this)},{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0}))}},{key:"_mouseDownEvent",value:function(t){this._dragFlag=!0,this._startY=t.pageY,this._dragEventHandler.startDrag(this._topPaneId,this._bottomPaneId)}},{key:"_mouseUpEvent",value:function(){this._dragFlag=!1,this._chartStore.setDragPaneFlag(!1)}},{key:"_pressedMouseMoveEvent",value:function(t){this._dragEventHandler.drag(t.pageY-this._startY,this._topPaneId,this._bottomPaneId),this._chartStore.setDragPaneFlag(!0),this._chartStore.crosshairStore().set()}},{key:"_mouseEnterEvent",value:function(){var t=this._chartStore.styleOptions().separator;this._element.style.background=t.activeBackgroundColor,this._chartStore.crosshairStore().set()}},{key:"_mouseLeaveEvent",value:function(){this._dragFlag||(this._element.style.background=null,this._chartStore.setDragPaneFlag(!1))}},{key:"height",value:function(){return this._wrapper.offsetHeight}},{key:"setSize",value:function(t,e){this._offsetLeft=t,this._width=e,this.invalidate()}},{key:"setDragEnabled",value:function(t){t!==this._dragEnabled&&(this._dragEnabled=t,t?!this._dragEvent&&this._initEvent(t):(this._element.style.cursor="default",this._dragEvent&&this._dragEvent.destroy(),this._dragEvent=null))}},{key:"topPaneId",value:function(){return this._topPaneId}},{key:"bottomPaneId",value:function(){return this._bottomPaneId}},{key:"updatePaneId",value:function(t,e){b(t)&&(this._topPaneId=t),b(e)&&(this._bottomPaneId=e)}},{key:"invalidate",value:function(){var t=this._chartStore.styleOptions().separator;this._element.style.top="".concat(-Math.floor((7-t.size)/2),"px"),this._wrapper.style.backgroundColor=t.color,this._wrapper.style.height="".concat(t.size,"px"),this._wrapper.style.marginLeft="".concat(t.fill?0:this._offsetLeft,"px"),this._wrapper.style.width=t.fill?"100%":"".concat(this._width,"px")}},{key:"getImage",value:function(){var t=this._chartStore.styleOptions().separator,e=this._wrapper.offsetWidth,n=t.size,i=je("canvas",{width:"".concat(e,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=i.getContext("2d"),a=Kt(i);return i.width=e*a,i.height=n*a,r.scale(a,a),r.fillStyle=t.color,r.fillRect(this._offsetLeft,0,e,n),i}},{key:"destroy",value:function(){this._dragEvent&&this._dragEvent.destroy(),this._container.removeChild(this._wrapper)}}]),t}(),Zn=_((function t(e){p(this,t),this._chartStore=e}));function Jn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var Qn=function(t){dt(n,t);var e=Jn(n);function n(t){var i;return p(this,n),(i=e.call(this,t))._flingStartTime=null,i._flingScrollTimerId=null,i._startScrollCoordinate=null,i._touchCoordinate=null,i._touchCancelCrosshair=!1,i._touchZoomed=!1,i._pinchScale=1,i}return _(n,[{key:"pinchStartEvent",value:function(){this._pinchScale=1,this._touchZoomed=!0}},{key:"pinchEvent",value:function(t,e){var n=5*(e-this._pinchScale);this._pinchScale=e,this._chartStore.timeScaleStore().zoom(n,t)}},{key:"mouseUpEvent",value:function(){this._startScrollCoordinate=null}},{key:"mouseLeaveEvent",value:function(t){var e=this;if(jn(t)){if(this._startScrollCoordinate){var n=(new Date).getTime()-this._flingStartTime,i=(t.localX-this._startScrollCoordinate.x)/(n>0?n:1)*20;200>n&&Math.abs(i)>0&&function t(){e._flingScrollTimerId=Ue((function(){e._chartStore.timeScaleStore().startScroll(),e._chartStore.timeScaleStore().scroll(i),1>Math.abs(i*=.975)?e._flingScrollTimerId&&(Xe(e._flingScrollTimerId),e._flingScrollTimerId=null):t()}))}()}}else this._startScrollCoordinate=null,zn(t)&&this._chartStore.crosshairStore().set()}},{key:"mouseMoveEvent",value:function(t){zn(t)&&this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId})}},{key:"mouseWheelEvent",value:function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(t.cancelable&&t.preventDefault(),0===Math.abs(t.deltaX))return;this._chartStore.timeScaleStore().startScroll(),this._chartStore.timeScaleStore().scroll(-t.deltaX)}else{var e=-t.deltaY/100;if(0===e)return;switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var n=Math.sign(e)*Math.min(1,Math.abs(e));this._chartStore.timeScaleStore().zoom(n,{x:t.localX,y:t.localY})}}}},{key:"mouseClickEvent",value:function(t){jn(t)&&(this._touchCoordinate||this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:t.localX,y:t.localY},this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId})))}},{key:"mouseDownEvent",value:function(t){if(this._flingScrollTimerId&&(Xe(this._flingScrollTimerId),this._flingScrollTimerId=null),this._flingStartTime=(new Date).getTime(),this._startScrollCoordinate={x:t.localX,y:t.localY},this._chartStore.timeScaleStore().startScroll(),jn(t))if(this._touchZoomed=!1,this._touchCoordinate){var e=t.localX-this._touchCoordinate.x,n=t.localY-this._touchCoordinate.y;10>Math.sqrt(e*e+n*n)?(this._touchCoordinate={x:t.localX,y:t.localY},this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId})):(this._touchCancelCrosshair=!0,this._touchCoordinate=null,this._chartStore.crosshairStore().set())}else this._touchCancelCrosshair=!1}},{key:"pressedMouseMoveEvent",value:function(t){var e={x:t.localX,y:t.paneY,paneId:t.paneId};if(jn(t)){if(this._touchCoordinate)return this._touchCoordinate={x:t.localX,y:t.localY},void this._chartStore.crosshairStore().set(e);e=null}if(this._startScrollCoordinate){var n=t.localX-this._startScrollCoordinate.x;this._chartStore.timeScaleStore().scroll(n,e)}}},{key:"longTapEvent",value:function(t){jn(t)&&(this._touchCoordinate={x:t.localX,y:t.localY},this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId}))}}]),n}(Zn);function ti(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ei(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ti(Object(n),!0).forEach((function(e){It(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ti(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ni(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ii(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ii(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return t.length>i?{done:!1,value:t[i++]}:{done:!0}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ii(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);e>n;n++)i[n]=t[n];return i}function ri(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var ai=function(t){dt(n,t);var e=ri(n);function n(t,i){var r;return p(this,n),(r=e.call(this,t))._yAxis=i,r}return _(n,[{key:"_performOverlayMouseHover",value:function(t,e,n,i){var r;if(t){var a,o=ni(t);try{for(o.s();!(a=o.n()).done;)if(r=a.value.checkEventCoordinateOn(n))break}catch(t){o.e(t)}finally{o.f()}r&&e.id===r.id||(e.id&&e.instance&&zn(i)&&e.instance.onMouseLeave({id:e.id,points:e.instance.points(),event:i}),r&&r.id!==e.id&&r.instance&&zn(i)&&r.instance.onMouseEnter({id:r.id,points:r.instance.points(),event:i}))}return r}},{key:"mouseUpEvent",value:function(){this._chartStore.shapeStore().updatePressedInstance()}},{key:"mouseMoveEvent",value:function(t){if(zn(t)){if(this._waitingForMouseMove)return!1;this._waitingForMouseMove=!0;var e,n,i,r={x:t.localX,y:t.paneY},a=this._chartStore.shapeStore().progressInstance(),o=a.instance,s=a.paneId;if(o&&o.isDrawing())t.paneId&&(o.isStart()&&this._chartStore.shapeStore().updateProgressInstance(this._yAxis(t.paneId),t.paneId),s===t.paneId&&o.mouseMoveForDrawing(r,t),e={id:o.id(),element:ae,elementIndex:o.points().length-1}),n={id:"",element:oe,elementIndex:-1};else{var c=this._chartStore.annotationStore().get(t.paneId),h=this._chartStore.shapeStore().instances(t.paneId),l=this._chartStore.shapeStore().eventOperate().hover,u=this._chartStore.annotationStore().eventOperate();e=this._performOverlayMouseHover(h,l,r,t),i=this._performOverlayMouseHover(c,u,r,t)}this._chartStore.shapeStore().setEventOperate({hover:e||{id:"",element:oe,elementIndex:-1},click:n}),this._chartStore.annotationStore().setEventOperate(i||{id:""}),this._waitingForMouseMove=!1}}},{key:"mouseDownEvent",value:function(t){var e,n={x:t.localX,y:t.paneY},i=this._chartStore.shapeStore().progressInstance(),r=i.instance,a={id:"",element:oe,elementIndex:-1},o=i.paneId;if(r&&r.isDrawing())jn(t)&&(r.isStart()&&(this._chartStore.shapeStore().updateProgressInstance(this._yAxis(t.paneId),t.paneId),o=t.paneId),o===t.paneId&&r.mouseMoveForDrawing(n,t)),o===t.paneId&&(r.mouseLeftButtonDownForDrawing(),e={id:r.id(),element:ae,elementIndex:r.points().length-1},a={id:r.id(),element:ae,elementIndex:r.points().length-1});else{var s,c=ni(this._chartStore.shapeStore().instances(t.paneId));try{for(c.s();!(s=c.n()).done;){var h=s.value;if(e=h.checkEventCoordinateOn(n)){this._chartStore.shapeStore().updatePressedInstance(h,t.paneId,e.element),e.element===ae?a=ei({},e):h.startPressedOtherMove(n),h.onClick({id:e.id,points:h.points(),event:t});break}}}catch(t){c.e(t)}finally{c.f()}var l=this._chartStore.annotationStore().get(t.paneId);if(l){var u,f=ni(l);try{for(f.s();!(u=f.n()).done;){var d=u.value,p=d.checkEventCoordinateOn(n);if(p){d.onClick({id:p.id,points:d.points(),event:t});break}}}catch(t){f.e(t)}finally{f.f()}}}this._chartStore.shapeStore().setEventOperate({hover:a,click:e||{id:"",element:oe,elementIndex:-1}})&&this._chartStore.invalidate(me)}},{key:"mouseRightDownEvent",value:function(t){var e,n=this._chartStore.shapeStore().progressInstance().instance;e=n||this._chartStore.shapeStore().instances(t.paneId).find((function(e){return e.checkEventCoordinateOn({x:t.localX,y:t.paneY})})),e&&!e.onRightClick({id:e.id(),points:e.points(),event:t})&&this._chartStore.shapeStore().removeInstance(e.id());var i=this._chartStore.annotationStore().get(t.paneId);if(i){var r=i.find((function(e){return e.checkEventCoordinateOn({x:t.localX,y:t.paneY})}));r&&r.onRightClick({id:r.id(),points:r.points(),event:t})}}},{key:"pressedMouseMoveEvent",value:function(t){var e=this._chartStore.shapeStore().pressedInstance(),n=e.instance;if(n&&e.paneId===t.paneId){var i={x:t.localX,y:t.paneY};e.element===ae?n.mousePressedPointMove(i,t):n.mousePressedOtherMove(i,t),this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId})}}}]),n}(Zn);function oi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var si="Equal",ci="Minus",hi="ArrowLeft",li="ArrowRight",ui=function(t){dt(n,t);var e=oi(n);function n(){return p(this,n),e.apply(this,arguments)}return _(n,[{key:"keyBoardDownEvent",value:function(t){if(t.shiftKey)switch(t.code){case si:this._chartStore.timeScaleStore().zoom(.5);break;case ci:this._chartStore.timeScaleStore().zoom(-.5);break;case hi:this._chartStore.timeScaleStore().startScroll(),this._chartStore.timeScaleStore().scroll(-3*this._chartStore.timeScaleStore().dataSpace());break;case li:this._chartStore.timeScaleStore().startScroll(),this._chartStore.timeScaleStore().scroll(3*this._chartStore.timeScaleStore().dataSpace())}}}]),n}(Zn),fi=function(){function t(e,n,i){p(this,t),this._target=e,this._chartStore=n,this._chartContentLeftRight={},this._chartContentTopBottom={},this._paneContentSize={},this._event=new $n(this._target,{pinchStartEvent:this._pinchStartEvent.bind(this),pinchEvent:this._pinchEvent.bind(this),mouseUpEvent:this._mouseUpEvent.bind(this),mouseClickEvent:this._mouseClickEvent.bind(this),mouseDownEvent:this._mouseDownEvent.bind(this),mouseRightDownEvent:this._mouseRightDownEvent.bind(this),mouseLeaveEvent:this._mouseLeaveEvent.bind(this),mouseMoveEvent:this._mouseMoveEvent.bind(this),mouseWheelEvent:this._mouseWheelEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this),longTapEvent:this._longTapEvent.bind(this)},{treatVertTouchDragAsPageScroll:!0,treatHorzTouchDragAsPageScroll:!1}),this._boundKeyBoardDownEvent=this._keyBoardDownEvent.bind(this),this._target.addEventListener("keydown",this._boundKeyBoardDownEvent),this._boundContextMenuEvent=function(t){t.preventDefault()},this._target.addEventListener("contextmenu",this._boundContextMenuEvent,!1),this._zoomScrollEventHandler=new Qn(n),this._overlayEventHandler=new ai(n,i),this._keyBoardEventHandler=new ui(n)}return _(t,[{key:"_keyBoardDownEvent",value:function(t){this._keyBoardEventHandler.keyBoardDownEvent(t)}},{key:"_pinchStartEvent",value:function(){this._zoomScrollEventHandler.pinchStartEvent()}},{key:"_pinchEvent",value:function(t,e){this._zoomScrollEventHandler.pinchEvent(t,e)}},{key:"_mouseUpEvent",value:function(t){this._checkEventInChartContent(t)&&(this._target.style.cursor="crosshair"),this._zoomScrollEventHandler.mouseUpEvent(t),this._shouldPerformOverlayEvent()&&this._overlayEventHandler.mouseUpEvent(t)}},{key:"_mouseLeaveEvent",value:function(t){this._zoomScrollEventHandler.mouseLeaveEvent(t)}},{key:"_mouseMoveEvent",value:function(t){if(t.target instanceof HTMLCanvasElement)if(this._checkEventInChartContent(t)){this._target.style.cursor="crosshair";var e=this._compatChartEvent(t,!0);this._shouldPerformOverlayEvent()&&this._overlayEventHandler.mouseMoveEvent(e),this._chartStore.dragPaneFlag()||this._zoomScrollEventHandler.mouseMoveEvent(e)}else this._target.style.cursor="default",this._zoomScrollEventHandler.mouseLeaveEvent(t);else this._target.style.cursor="default",this._chartStore.crosshairStore().set()}},{key:"_mouseWheelEvent",value:function(t){this._checkZoomScroll()&&this._checkEventInChartContent(t)&&this._zoomScrollEventHandler.mouseWheelEvent(this._compatChartEvent(t))}},{key:"_mouseClickEvent",value:function(t){this._checkZoomScroll()&&this._checkEventInChartContent(t)&&(this._zoomScrollEventHandler.mouseClickEvent(this._compatChartEvent(t,!0)),this._modifyEventOptions(t))}},{key:"_mouseDownEvent",value:function(t){if(this._checkEventInChartContent(t)){this._target.style.cursor="pointer";var e=this._compatChartEvent(t,!0);this._shouldPerformOverlayEvent()&&this._overlayEventHandler.mouseDownEvent(e),this._checkZoomScroll()&&(this._zoomScrollEventHandler.mouseDownEvent(e),this._modifyEventOptions(t))}}},{key:"_mouseRightDownEvent",value:function(t){this._shouldPerformOverlayEvent()&&this._checkEventInChartContent(t)&&this._overlayEventHandler.mouseRightDownEvent(this._compatChartEvent(t,!0))}},{key:"_pressedMouseMoveEvent",value:function(t){if(this._checkEventInChartContent(t)){var e=this._compatChartEvent(t,!0);this._checkZoomScroll()?(this._zoomScrollEventHandler.pressedMouseMoveEvent(e),this._modifyEventOptions(t)):this._overlayEventHandler.pressedMouseMoveEvent(e)}}},{key:"_longTapEvent",value:function(t){this._checkZoomScroll()&&this._checkEventInChartContent(t)&&(this._zoomScrollEventHandler.longTapEvent(this._compatChartEvent(t,!0)),this._modifyEventOptions(t))}},{key:"_checkZoomScroll",value:function(){return!this._chartStore.dragPaneFlag()&&!this._chartStore.shapeStore().isPressed()&&!this._chartStore.shapeStore().isDrawing()}},{key:"_shouldPerformOverlayEvent",value:function(){return!this._chartStore.shapeStore().isEmpty()||!this._chartStore.annotationStore().isEmpty()}},{key:"_modifyEventOptions",value:function(t){jn(t)&&this._chartStore.crosshairStore().get().paneId?this._event.setOptions({treatVertTouchDragAsPageScroll:!1}):this._event.setOptions({treatVertTouchDragAsPageScroll:!0})}},{key:"_compatChartEvent",value:function(t,e){if(e)for(var n in this._paneContentSize)if(Object.prototype.hasOwnProperty.call(this._paneContentSize,n)){var i=this._paneContentSize[n];if(t.localY>i.contentTop&&i.contentBottom>t.localY){t.paneY=t.localY-i.contentTop,t.paneId=n;break}}return t.localX-=this._chartContentLeftRight.contentLeft,t}},{key:"_checkEventInChartContent",value:function(t){return t.localX>this._chartContentLeftRight.contentLeft&&this._chartContentLeftRight.contentRight>t.localX&&t.localY>this._chartContentTopBottom.contentTop&&this._chartContentTopBottom.contentBottom>t.localY}},{key:"setChartContentLeftRight",value:function(t){this._chartContentLeftRight=t}},{key:"setChartContentTopBottom",value:function(t){this._chartContentTopBottom=t}},{key:"setPaneContentSize",value:function(t){this._paneContentSize=t}},{key:"destroy",value:function(){this._event.destroy(),this._target.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._target.removeEventListener("contextmenu",this._boundContextMenuEvent)}}]),t}();function di(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=0;return function(){var i=Date.now(),r=this,a=arguments;i-n>e&&(t.apply(r,a),n=i)}}function pi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var vi=function(t){dt(n,t);var e=pi(n);function n(t){var i,r=t.id,a=t.point,o=t.chartStore,s=t.xAxis,c=t.yAxis,h=t.styles;return p(this,n),(i=e.call(this,{id:r,chartStore:o,xAxis:s,yAxis:c}))._point=a,i._symbolCoordinate={},i.setStyles(h,o.styleOptions().annotation),i}return _(n,[{key:"_drawSymbol",value:function(t,e,n){var i=this._chartStore.timeScaleStore().barSpace(),r=n.symbol,a=r.size,o=r.activeSize,s=e?w(o)?o:i:w(a)?a:i,c=e?r.activeColor:r.color;switch(r.type){case X:Rt(t,c,this._symbolCoordinate,s/2);break;case G:!function(t,e,n,i,r,a){t.fillStyle=e,t.fillRect(n,i,r,a)}(t,c,this._symbolCoordinate.x-s/2,this._symbolCoordinate.y-s/2,s,s);break;case $:!function(t,e,n,i,r){t.fillStyle=e,t.beginPath(),t.moveTo(n.x-i/2,n.y),t.lineTo(n.x,n.y-r/2),t.lineTo(n.x+i/2,n.y),t.lineTo(n.x,n.y+r/2),t.closePath(),t.fill()}(t,c,this._symbolCoordinate,s,s);break;case q:!function(t,e,n,i,r){t.fillStyle=e,t.beginPath(),t.moveTo(n.x-i/2,n.y+r/2),t.lineTo(n.x,n.y-r/2),t.lineTo(n.x+i/2,n.y+r/2),t.closePath(),t.fill()}(t,c,this._symbolCoordinate,s,s);break;case K:t.save(),this.drawCustomSymbol({ctx:t,point:this._point,coordinate:this._symbolCoordinate,viewport:{width:this._xAxis.width(),height:this._yAxis.height(),barSpace:i},styles:r,isActive:e}),t.restore()}}},{key:"draw",value:function(t){var e=this._styles||this._chartStore.styleOptions().annotation,n=e.offset||[0,0],i=0;switch(e.position){case Z:i=this._yAxis.convertToPixel(this._point.value);break;case J:i=0;break;case Q:i=this._yAxis.height()}this._symbolCoordinate.y=i+n[0];var r=this._id===this._chartStore.annotationStore().eventOperate().id;this._drawSymbol(t,r,e),this.drawExtend&&(t.save(),this.drawExtend({ctx:t,point:this._point,coordinate:this._symbolCoordinate,viewport:{width:this._xAxis.width(),height:this._yAxis.height()},styles:e,isActive:r}),t.restore())}},{key:"checkEventCoordinateOn",value:function(t){var e,n,i,r,a,o=this._chartStore.timeScaleStore().barSpace(),s=(this._styles||this._chartStore.styleOptions().annotation).symbol,c=w(s.size)?s.size:o;switch(s.type){case X:e=Ht(this._symbolCoordinate,c/2,t);break;case G:e=function(t,e,n){return!(t.x>n.x||n.x>e.x||t.y>n.y||n.y>e.y)}({x:this._symbolCoordinate.x-c/2,y:this._symbolCoordinate.y-c/2},{x:this._symbolCoordinate.x+c/2,y:this._symbolCoordinate.y+c/2},t);break;case $:e=(i=c)*(r=c)/2+2>Math.abs((n=this._symbolCoordinate).x-(a=t).x)*r+Math.abs(n.y-a.y)*i;break;case q:e=function(t,e){var n=Lt(t[0],t[1],t[2]),i=Lt(t[0],t[1],e)+Lt(t[0],t[2],e)+Lt(t[1],t[2],e);return 2>Math.abs(n-i)}([{x:this._symbolCoordinate.x-c/2,y:this._symbolCoordinate.y+c/2},{x:this._symbolCoordinate.x,y:this._symbolCoordinate.y-c/2},{x:this._symbolCoordinate.x+c/2,y:this._symbolCoordinate.y+c/2}],t);break;case K:e=this.checkEventCoordinateOnCustomSymbol({eventCoordinate:t,coordinate:this._symbolCoordinate,size:c})}if(e)return{id:this._id,instance:this}}},{key:"createSymbolCoordinate",value:function(t){var e=this._styles||this._chartStore.styleOptions().annotation;this._symbolCoordinate={x:t+(e.offset||[0,0])[1]}}},{key:"points",value:function(){return this._point}},{key:"checkEventCoordinateOnCustomSymbol",value:function(t){}},{key:"drawCustomSymbol",value:function(t){}}]),n}(Mt);function _i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(e){var r=vt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pt(this,n)}}var mi=function(t){dt(n,t);var e=_i(n);function n(t){var i,r=t.id,a=t.point,o=t.text,s=t.mark,c=t.chartStore,h=t.xAxis,l=t.yAxis,u=t.styles;return p(this,n),(i=e.call(this,{id:r,chartStore:c,xAxis:h,yAxis:l}))._point=a||{},i._text=o,i._mark=s,i.setStyles(u,c.styleOptions().tag),i}return _(n,[{key:"update",value:function(t){var e=t.point,n=t.text,i=t.mark,r=t.styles,a=!1;return k(e)&&(this._point=e,a=!0),b(n)&&(this._text=n,a=!0),b(i)&&(this._mark=i,a=!0),this.setStyles(r,this._chartStore.styleOptions().tag)&&(a=!0),a}},{key:"drawMarkLine",value:function(t){var e=this._chartStore.styleOptions(),n=e.yAxis,i=this._styles||e.tag,r=this._getY(i);t.save(),this._drawLine(t,r,i,n),this._drawMark(t,r,i,n),t.restore()}},{key:"drawText",value:function(t){if(b(this._text)){var e=this._chartStore.styleOptions(),n=this._styles||e.tag,i=n.text;t.save();var r,a=Qt(t,this._text,i),o=te(i);r=this._yAxis.isFromYAxisZero()?0:this._yAxis.width()-a;var s=this._getY(n);en(t,i.backgroundColor,i.borderColor,i.borderSize,r,s-o/2,a,o,i.borderRadius),Ke(t,i.color,r+i.paddingLeft,s,this._text),t.restore()}}},{key:"_drawLine",value:function(t,e,n,i){var r=n.line;if(r.show){t.save();var a=Qt(t,this._text,n.text),o=Qt(t,this._mark,n.mark);t.strokeStyle=r.color,t.lineWidth=r.size,r.style===O&&t.setLineDash(r.dashValue);var s=n.mark.offset,c=[],h=b(this._text),l=b(this._mark);i.inside?i.position===I?h&&l?s>0?(c.push([a,a+s]),c.push([a+s+o,this._xAxis.width()])):c.push(Math.min(a,o)>Math.abs(s)?[a+s+o,this._xAxis.width()]:[Math.max(a,o),this._xAxis.width()]):h?c.push([a,this._xAxis.width()]):l?s>0?(c.push([0,s]),c.push([s+o,this._xAxis.width()])):c.push(o>Math.abs(s)?[s+o,this._xAxis.width()]:[0,this._xAxis.width()]):c.push([0,this._xAxis.width()]):h&&l?0>s?(c.push([0,this._xAxis.width()-a+s-o]),c.push([this._xAxis.width()-a+s,this._xAxis.width()-a])):c.push(Math.min(a,o)>s?[0,this._xAxis.width()-a-o+s]:[0,this._xAxis.width()-Math.max(a,o)]):h?c.push([0,this._xAxis.width()-a]):l?0>s?(c.push([0,this._xAxis.width()+s-o]),c.push([this._xAxis.width()+s,this._xAxis.width()])):c.push(o>s?[0,this._xAxis.width()-o+s]:[0,this._xAxis.width()]):c.push([0,this._xAxis.width()]):i.position===I?l?s>0?(c.push([0,s]),c.push([s+o,this._xAxis.width()])):c.push(o>Math.abs(s)?[o+s,this._xAxis.width()]:[0,this._xAxis.width()]):c.push([0,this._xAxis.width()]):l?0>s?(c.push([0,this._xAxis.width()-o+s]),c.push([this._xAxis.width()+s,this._xAxis.width()])):c.push(o>s?[0,this._xAxis.width()-o+s]:[0,this._xAxis.width()]):c.push([0,this._xAxis.width()]),c.forEach((function(n){Gt(t,e,n[0],n[1])})),t.restore()}}},{key:"_drawMark",value:function(t,e,n,i){if(b(this._mark)){var r,a=n.mark,o=Qt(t,this._mark,a),s=te(a);if(i.inside){var c=0;b(this._text)&&(c=Qt(t,this._text,n.text)),r=i.position===I?c:this._xAxis.width()-c-o}else r=i.position===I?0:this._xAxis.width()-o;en(t,a.backgroundColor,a.borderColor,a.borderSize,r+=a.offset,e-s/2,o,s,a.borderRadius),t.textBaseline="middle",t.font=Jt(a.size,a.weight,a.family),Ke(t,a.color,r+a.paddingLeft,e,this._mark)}}},{key:"_getY",value:function(t){var e=t.offset;switch(t.position){case J:return e;case Q:return this._yAxis.height()+e;default:return this._yAxis.convertToNicePixel(this._point.value)+e}}}]),n}(Mt);function yi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return gi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gi(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return t.length>i?{done:!1,value:t[i++]}:{done:!0}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function gi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);e>n;n++)i[n]=t[n];return i}var xi="technical_indicator_pane_",Si="candle_pane",ki=function(){function t(e,n){var i=this;p(this,t),this._initChartContainer(e),this._shapeBaseId=0,this._paneBaseId=0,this._separatorDragStartTopPaneHeight=0,this._separatorDragStartBottomPaneHeight=0,this._chartStore=new Be(n,{invalidate:this._invalidatePane.bind(this),crosshair:this._crosshairObserver.bind(this)}),this._xAxisPane=new Bn({id:"x_axis_pane",container:this._chartContainer,chartStore:this._chartStore}),this._panes=new Map([[Si,new Pn({container:this._chartContainer,chartStore:this._chartStore,xAxis:this._xAxisPane.xAxis(),id:Si})]]),this._separators=new Map,this._chartWidth={},this._chartHeight={},this._chartEvent=new fi(this._chartContainer,this._chartStore,(function(t){return i._panes.get(t).yAxis()})),this.adjustPaneViewport(!0,!0,!0)}return _(t,[{key:"_initChartContainer",value:function(t){this._container=t,this._chartContainer=je("div",{userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent",position:"relative",outline:"none",borderStyle:"none",width:"100%",cursor:"crosshair",boxSizing:"border-box"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)}},{key:"_crosshairObserver",value:function(t){var e=this,n=t.paneId,i=t.dataIndex,r=t.kLineData,a=t.x,o=t.y;if(this._chartStore.actionStore().has(ht.CROSSHAIR)||this._chartStore.actionStore().has(ht.TOOLTIP)){var s={};this._panes.forEach((function(t,n){var a={},o=[];e.chartStore().technicalIndicatorStore().instances(n).forEach((function(t){var e=t.result[i];a[t.name]=e,o.push({name:t.name,data:e})})),s[n]=a,e._chartStore.actionStore().execute(ht.TOOLTIP,{paneId:n,dataIndex:i,kLineData:r,technicalIndicatorData:o})})),n&&this._chartStore.actionStore().execute(ht.CROSSHAIR,{paneId:n,coordinate:{x:a,y:o},dataIndex:i,kLineData:r,technicalIndicatorData:s})}}},{key:"_separatorStartDrag",value:function(t,e){this._separatorDragStartTopPaneHeight=this._panes.get(t).height(),this._separatorDragStartBottomPaneHeight=this._panes.get(e).height()}},{key:"_separatorDrag",value:function(t,e,n){var i=this._panes.get(e),r=this._panes.get(n),a=i.minHeight(),o=r.minHeight(),s=this._separatorDragStartTopPaneHeight+t,c=this._separatorDragStartBottomPaneHeight-t;s>this._separatorDragStartTopPaneHeight+this._separatorDragStartBottomPaneHeight&&(s=this._separatorDragStartTopPaneHeight+this._separatorDragStartBottomPaneHeight,c=0),0>s&&(s=0,c=this._separatorDragStartTopPaneHeight+this._separatorDragStartBottomPaneHeight),a>s&&(c-=o-s,s=a),o>c&&(s-=a-c,c=o),i.setHeight(s),r.setHeight(c),this._chartStore.actionStore().execute(ht.PANE_DRAG,{topPaneId:e,bottomPaneId:n,topPaneHeight:s,bottomPaneHeight:c}),this.adjustPaneViewport(!0,!0,!0,!0,!0)}},{key:"_invalidatePane",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge;if(t===me)this._xAxisPane.invalidate(t),this._panes.forEach((function(e){e.invalidate(t)}));else{var e=!1;this._panes.forEach((function(t){var n=t.yAxis().computeAxis();n&&(e=n)})),this.adjustPaneViewport(!1,e,!0)}}},{key:"_measurePaneHeight",value:function(){var t=this,e=this._chartStore.styleOptions(),n=this._container.offsetHeight,i=e.separator.size,r=i*this._separators.size,a=this._xAxisPane.xAxis().getSelfHeight(),o=n-a-r,s=0;this._panes.forEach((function(t){if(t.id()!==Si){var e=t.height();s+e>o?(t.setHeight(o-s),s=o):s+=e}}));var c=o-s,h={};h.candle_pane={contentTop:0,contentBottom:c};var l=c,u=c;this._panes.get(Si).setHeight(c),this._chartHeight.candle_pane=c,this._panes.forEach((function(e){if(e.id()!==Si){var n=e.height();u+=n+i,h[e.id()]={contentTop:l,contentBottom:u},t._chartHeight[e.id()]=n,l=u}})),this._xAxisPane.setHeight(a),this._chartHeight.xAxis=a,this._chartHeight.total=n,this._chartEvent.setPaneContentSize(h),this._chartEvent.setChartContentTopBottom({contentTop:0,contentBottom:u})}},{key:"_measurePaneWidth",value:function(){var t,e,n,i=this,r=this._chartStore.styleOptions().yAxis,a=r.position===I,o=!r.inside,s=this._container.offsetWidth,c=Number.MIN_SAFE_INTEGER;this._panes.forEach((function(t){c=Math.max(c,t.yAxis().getSelfWidth())})),o?(t=s-c,a?(e=0,n=c):(e=s-c,n=0)):(t=s,n=0,e=a?0:s-c),this._chartStore.timeScaleStore().setTotalDataSpace(t),this._panes.forEach((function(r,a){r.setWidth(t,c),r.setOffsetLeft(n,e);var o=i._separators.get(a);o&&o.setSize(n,t)})),this._chartWidth={content:t,yAxis:c,total:s},this._xAxisPane.setWidth(t,c),this._xAxisPane.setOffsetLeft(n,e),this._chartEvent.setChartContentLeftRight({contentLeft:n,contentRight:n+t})}},{key:"getContainer",value:function(){return this._container}},{key:"adjustPaneViewport",value:function(t,e,n,i,r){t&&this._measurePaneHeight();var a=!1;i&&this._panes.forEach((function(t){var e=t.yAxis().computeAxis(r);a||(a=e)})),(!i&&e||i&&a)&&this._measurePaneWidth(),n&&(this._xAxisPane.xAxis().computeAxis(!0),this._xAxisPane.layout(),this._panes.forEach((function(t){t.layout()})))}},{key:"hasPane",value:function(t){return this._panes.has(t)}},{key:"getPane",value:function(t){return this._panes.get(t)}},{key:"chartStore",value:function(){return this._chartStore}},{key:"removeTechnicalIndicator",value:function(t,e){var n=this;if(this._chartStore.technicalIndicatorStore().removeInstance(t,e)){var i=!1;if(t!==Si&&!this._chartStore.technicalIndicatorStore().hasInstance(t)){i=!0,this._panes.get(t).destroy();var r=this._separators.get(t).topPaneId();this._separators.get(t).destroy(),this._panes.delete(t),this._separators.delete(t),this._separators.forEach((function(t){var e=t.topPaneId();n._separators.has(e)||t.updatePaneId(r)}))}this.adjustPaneViewport(i,!0,!0,!0,!0)}}},{key:"createTechnicalIndicator",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._panes.has(i.id)){var r=this._chartStore.technicalIndicatorStore().addInstance(i.id,t,e);return r&&r.finally((function(t){n.setPaneOptions(i,n._panes.get(i.id).yAxis().computeAxis(!0))})),i.id}var a=i.id||"".concat(xi).concat(++this._paneBaseId),o=!E(i.dragEnabled)||i.dragEnabled;this._separators.set(a,new Kn(this._chartContainer,this._chartStore,Array.from(this._panes.keys()).pop(),a,o,{startDrag:this._separatorStartDrag.bind(this),drag:di(this._separatorDrag.bind(this),50)}));var s=new yn({container:this._chartContainer,chartStore:this._chartStore,xAxis:this._xAxisPane.xAxis(),id:a,height:i.height||100,minHeight:i.minHeight});this._panes.set(a,s);var c=this._chartStore.technicalIndicatorStore().addInstance(a,t,e);return c&&c.finally((function(t){n.adjustPaneViewport(!0,!0,!0,!0,!0)})),a}},{key:"createShape",value:function(t,e,n){var i=e.points,r=e.styles,a=e.lock,o=e.mode,s=e.data,c=e.onDrawStart,h=e.onDrawing,l=e.onDrawEnd,u=e.onClick,f=e.onRightClick,d=e.onPressedMove,p=e.onMouseEnter,v=e.onMouseLeave,_=e.onRemove,m=e.id||"".concat("shape_").concat(++this._shapeBaseId);if(!this._chartStore.shapeStore().hasInstance(m)){var y=null;this.hasPane(n)?y=this._panes.get(n).yAxis():i&&i.length>0&&(n=Si,y=this._panes.get(Si).yAxis());var g=new t({id:m,chartStore:this._chartStore,xAxis:this._xAxisPane.xAxis(),yAxis:y,points:i,styles:r,lock:a,mode:o,data:s});return S(c)&&c({id:m}),Dt(g,[{key:"onDrawing",fn:h},{key:"onDrawEnd",fn:l},{key:"onClick",fn:u},{key:"onRightClick",fn:f},{key:"onPressedMove",fn:d},{key:"onMouseEnter",fn:p},{key:"onMouseLeave",fn:v},{key:"onRemove",fn:_}]),this._chartStore.shapeStore().addInstance(g,n),m}return null}},{key:"createAnnotation",value:function(t,e){var n=this,i=[];t.forEach((function(t){var r=t.point,a=t.styles,o=t.checkEventCoordinateOnCustomSymbol,s=t.drawCustomSymbol,c=t.drawExtend,h=t.onClick,l=t.onRightClick,u=t.onMouseEnter,f=t.onMouseLeave;if(r&&r.timestamp){var d=new vi({id:r.timestamp,chartStore:n._chartStore,point:r,xAxis:n._xAxisPane.xAxis(),yAxis:n._panes.get(e).yAxis(),styles:a});Dt(d,[{key:"drawExtend",fn:c},{key:"drawCustomSymbol",fn:s},{key:"checkEventCoordinateOnCustomSymbol",fn:o},{key:"onClick",fn:h},{key:"onRightClick",fn:l},{key:"onMouseEnter",fn:u},{key:"onMouseLeave",fn:f}]),i.push(d)}})),i.length>0&&this._chartStore.annotationStore().add(i,e)}},{key:"createTag",value:function(t,e){var n=this,i=[],r=!1,a=!1;t.forEach((function(t){var o=t.id,s=t.point,c=t.text,h=t.mark,l=t.styles;if(b(o))if(n._chartStore.tagStore().has(o,e)){var u=n._chartStore.tagStore().update(o,e,{point:s,text:c,mark:h,styles:l});r||(r=u)}else a=!0,i.push(new mi({id:o,point:s,text:c,mark:h,styles:l,chartStore:n._chartStore,xAxis:n._xAxisPane.xAxis(),yAxis:n._panes.get(e).yAxis()}))})),a?this._chartStore.tagStore().add(i,e):r&&this._invalidatePane(me)}},{key:"removeAllHtml",value:function(){this._panes.forEach((function(t){t.removeHtml()})),this._xAxisPane.removeHtml()}},{key:"setPaneOptions",value:function(t,e){var n=e,i=!1;if(t.id!==Si){var r=this._panes.get(t.id);if(r){if(w(t.minHeight)&&t.minHeight>0&&r.setMinHeight(t.minHeight),w(t.height)&&t.height>0){var a=r.minHeight(),o=r.minHeight>t.height?a:t.height;r.height()!==o&&(n=!0,r.setHeight(t.height),i=!0)}E(t.dragEnabled)&&this._separators.get(t.id).setDragEnabled(t.dragEnabled)}}n&&this.adjustPaneViewport(i,!0,!0,!0,!0)}},{key:"setTimezone",value:function(t){this._chartStore.timeScaleStore().setTimezone(t),this._xAxisPane.xAxis().computeAxis(!0),this._xAxisPane.invalidate(ge)}},{key:"convertToPixel",value:function(t,e){var n,i=this,r=e.paneId,a=void 0===r?Si:r,o=e.absoluteYAxis,s=[].concat(t),c=[],h=this._chartStore.styleOptions().separator.size,l=0,u=yi(this._panes.values());try{var f=function(){var t=n.value;if(t.id()===a)return c=s.map((function(e){var n=e.timestamp,r=e.value,a={},s=e.dataIndex;if(b(n)&&(s=i._chartStore.timeScaleStore().timestampToDataIndex(n)),b(s)&&(a.x=i._xAxisPane.xAxis().convertToPixel(s)),b(r)){var c=t.yAxis().convertToPixel(r);a.y=o?l+c:c}return a})),"break";l+=t.height()+h};for(u.s();!(n=u.n()).done;)if("break"===f())break}catch(t){u.e(t)}finally{u.f()}return x(t)?c:c[0]||{}}},{key:"convertFromPixel",value:function(t,e){var n,i=this,r=e.paneId,a=void 0===r?Si:r,o=e.absoluteYAxis,s=[].concat(t),c=[],h=this._chartStore.styleOptions().separator.size,l=0,u=yi(this._panes.values());try{var f=function(){var t=n.value;if(t.id()===a)return c=s.map((function(e){var n=e.x,r=e.y,a={};if(b(n)&&(a.dataIndex=i._xAxisPane.xAxis().convertFromPixel(n),a.timestamp=i._chartStore.timeScaleStore().dataIndexToTimestamp(a.dataIndex)),b(r)){var s=o?r-l:r;a.value=t.yAxis().convertFromPixel(s)}return a})),"break";l+=t.height()+h};for(u.s();!(n=u.n()).done;)if("break"===f())break}catch(t){u.e(t)}finally{u.f()}return x(t)?c:c[0]||{}}},{key:"chartWidth",value:function(){return this._chartWidth}},{key:"chartHeight",value:function(){return this._chartHeight}},{key:"getConvertPictureUrl",value:function(t,e,n){var i=this,r=this._chartContainer.offsetWidth,a=this._chartContainer.offsetHeight,o=je("canvas",{width:"".concat(r,"px"),height:"".concat(a,"px"),boxSizing:"border-box"}),s=o.getContext("2d"),c=Kt(o);o.width=r*c,o.height=a*c,s.scale(c,c),s.fillStyle=n,s.fillRect(0,0,r,a);var h=0;return this._panes.forEach((function(e,n){if(n!==Si){var a=i._separators.get(n);s.drawImage(a.getImage(),0,h,r,a.height()),h+=a.height()}s.drawImage(e.getImage(t),0,h,r,e.height()),h+=e.height()})),s.drawImage(this._xAxisPane.getImage(t),0,h,r,this._xAxisPane.height()),o.toDataURL("image/".concat(e))}},{key:"destroy",value:function(){this._panes.forEach((function(t){t.destroy()})),this._separators.forEach((function(t){t.destroy()})),this._panes.clear(),this._separators.clear(),this._xAxisPane.destroy(),this._container.removeChild(this._chartContainer),this._chartEvent.destroy()}}]),t}(),wi=function(){function t(e,n){p(this,t),this._chartPane=new ki(e,n)}return _(t,[{key:"getDom",value:function(t){if(t){if(!k(t))return null;var e=t.position,n=this._chartPane.getPane(t.paneId);return n&&n.container(e)||null}return this._chartPane.getContainer()}},{key:"getWidth",value:function(){return this._chartPane.chartWidth()}},{key:"getHeight",value:function(){return this._chartPane.chartHeight()}},{key:"setStyleOptions",value:function(t){k(t)&&(this._chartPane.chartStore().applyStyleOptions(t),this._chartPane.adjustPaneViewport(!0,!0,!0,!0,!0))}},{key:"getStyleOptions",value:function(){return g(this._chartPane.chartStore().styleOptions())}},{key:"setPriceVolumePrecision",value:function(t,e){w(t)&&t>=0&&w(e)&&e>=0&&this._chartPane.chartStore().setPriceVolumePrecision(t,e)}},{key:"setTimezone",value:function(t){this._chartPane.setTimezone(t)}},{key:"getTimezone",value:function(){return this._chartPane.chartStore().timeScaleStore().timezone()}},{key:"resize",value:function(){this._chartPane.adjustPaneViewport(!0,!0,!0,!0,!0)}},{key:"setOffsetRightSpace",value:function(t){w(t)&&this._chartPane.chartStore().timeScaleStore().setOffsetRightSpace(t,!0)}},{key:"setLeftMinVisibleBarCount",value:function(t){w(t)&&t>0&&this._chartPane.chartStore().timeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))}},{key:"setRightMinVisibleBarCount",value:function(t){w(t)&&t>0&&this._chartPane.chartStore().timeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))}},{key:"setDataSpace",value:function(t){w(t)&&this._chartPane.chartStore().timeScaleStore().setDataSpace(t)}},{key:"getDataSpace",value:function(){return this._chartPane.chartStore().timeScaleStore().dataSpace()}},{key:"getBarSpace",value:function(){return this._chartPane.chartStore().timeScaleStore().barSpace()}},{key:"clearData",value:function(){this._chartPane.chartStore().clearDataList()}},{key:"getDataList",value:function(){return this._chartPane.chartStore().dataList()}},{key:"applyNewData",value:function(t,e){var n=this;if(x(t)){var i=this._chartPane.chartStore();i.clearDataList(),i.addData(t,0,e),i.technicalIndicatorStore().calcInstance().finally((function(t){n._chartPane.adjustPaneViewport(!1,!0,!0,!0)}))}}},{key:"applyMoreData",value:function(t,e){var n=this;if(x(t)){var i=this._chartPane.chartStore();i.addData(t,0,e),i.technicalIndicatorStore().calcInstance().finally((function(t){n._chartPane.adjustPaneViewport(!1,!0,!0,!0)}))}}},{key:"updateData",value:function(t){var e=this;if(k(t)&&!x(t)){var n=this._chartPane.chartStore(),i=n.dataList(),r=i.length,a=et(t,"timestamp",0),o=et(i[r-1],"timestamp",0);if(a>=o){var s=r;a===o&&(s=r-1),n.addData(t,s),n.technicalIndicatorStore().calcInstance().finally((function(t){e._chartPane.adjustPaneViewport(!1,!0,!0,!0)}))}}}},{key:"loadMore",value:function(t){S(t)&&this._chartPane.chartStore().timeScaleStore().setLoadMoreCallback(t)}},{key:"createTechnicalIndicator",value:function(t,e,n){if(!b(t))return null;var i=k(t)&&!x(t)?t:{name:t};return this._chartPane.chartStore().technicalIndicatorStore().hasTemplate(i.name)?this._chartPane.createTechnicalIndicator(i,e,n):null}},{key:"addTechnicalIndicatorTemplate",value:function(t){if(k(t)){var e=[].concat(t);this._chartPane.chartStore().technicalIndicatorStore().addTemplate(e)}}},{key:"overrideTechnicalIndicator",value:function(t,e){var n=this;if(k(t)&&!x(t)){var i=this._chartPane.chartStore().technicalIndicatorStore().override(t,e);i&&i.then((function(t){n._chartPane.adjustPaneViewport(!1,!0,!0,!0)}))}}},{key:"getTechnicalIndicatorTemplate",value:function(t){return this._chartPane.chartStore().technicalIndicatorStore().getTemplateInfo(t)}},{key:"getTechnicalIndicatorByPaneId",value:function(t,e){return this._chartPane.chartStore().technicalIndicatorStore().getInstanceInfo(t,e)}},{key:"removeTechnicalIndicator",value:function(t,e){this._chartPane.removeTechnicalIndicator(t,e)}},{key:"addShapeTemplate",value:function(t){if(k(t)){var e=[].concat(t);this._chartPane.chartStore().shapeStore().addTemplate(e)}}},{key:"createShape",value:function(t,e){if(!b(t))return null;var n=k(t)&&!x(t)?t:{name:t},i=this._chartPane.chartStore().shapeStore().getTemplate(n.name);return i?this._chartPane.createShape(i,n,e):null}},{key:"getShape",value:function(t){return this._chartPane.chartStore().shapeStore().getInstanceInfo(t)}},{key:"setShapeOptions",value:function(t){k(t)&&!x(t)&&this._chartPane.chartStore().shapeStore().setInstanceOptions(t)}},{key:"removeShape",value:function(t){this._chartPane.chartStore().shapeStore().removeInstance(t)}},{key:"createAnnotation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Si;if(k(t)&&this._chartPane.hasPane(e)){var n=[].concat(t);this._chartPane.createAnnotation(n,e)}}},{key:"removeAnnotation",value:function(t,e){this._chartPane.chartStore().annotationStore().remove(t,e)}},{key:"createTag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Si;if(k(t)&&this._chartPane.hasPane(e)){var n=[].concat(t);this._chartPane.createTag(n,e)}}},{key:"removeTag",value:function(t,e){this._chartPane.chartStore().tagStore().remove(t,e)}},{key:"createHtml",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Si;if(!k(t))return null;if(!(P(t.content)||t.content instanceof HTMLElement))return null;var n=this._chartPane.getPane(e);return n?n.createHtml(t):null}},{key:"removeHtml",value:function(t,e){if(t){var n=this._chartPane.getPane(t);n&&n.removeHtml(e)}else this._chartPane.removeAllHtml()}},{key:"setPaneOptions",value:function(t){k(t)&&this._chartPane.setPaneOptions(t,!1)}},{key:"setZoomEnabled",value:function(t){this._chartPane.chartStore().timeScaleStore().setZoomEnabled(t)}},{key:"isZoomEnabled",value:function(){return this._chartPane.chartStore().timeScaleStore().zoomEnabled()}},{key:"setScrollEnabled",value:function(t){this._chartPane.chartStore().timeScaleStore().setScrollEnabled(t)}},{key:"isScrollEnabled",value:function(){return this._chartPane.chartStore().timeScaleStore().scrollEnabled()}},{key:"scrollByDistance",value:function(t,e){var n=this;if(w(t))if(w(e)&&e>0){this._chartPane.chartStore().timeScaleStore().startScroll();var i=(new Date).getTime();!function r(){var a=((new Date).getTime()-i)/e,o=a>=1,s=o?t:t*a;n._chartPane.chartStore().timeScaleStore().scroll(s),o||Ue(r)}()}else this._chartPane.chartStore().timeScaleStore().startScroll(),this._chartPane.chartStore().timeScaleStore().scroll(t)}},{key:"scrollToRealTime",value:function(t){var e=(this._chartPane.chartStore().timeScaleStore().offsetRightBarCount()-this._chartPane.chartStore().timeScaleStore().offsetRightSpace()/this._chartPane.chartStore().timeScaleStore().dataSpace())*this._chartPane.chartStore().timeScaleStore().dataSpace();this.scrollByDistance(e,t)}},{key:"scrollToDataIndex",value:function(t,e){if(w(t)){var n=(this._chartPane.chartStore().dataList().length-1-t)*this._chartPane.chartStore().timeScaleStore().dataSpace();this.scrollByDistance(n,e)}}},{key:"scrollToTimestamp",value:function(t,e){if(w(t)){var n=at(this._chartPane.chartStore().dataList(),"timestamp",t);this.scrollToDataIndex(n,e)}}},{key:"zoomAtCoordinate",value:function(t,e,n){var i=this;if(w(t))if(w(n)&&n>0){var r=this._chartPane.chartStore().timeScaleStore().dataSpace(),a=r*t-r,o=(new Date).getTime();!function t(){var s=((new Date).getTime()-o)/n,c=s>=1,h=c?a:a*s;i._chartPane.chartStore().timeScaleStore().zoom(h/r,e),c||Ue(t)}()}else this._chartPane.chartStore().timeScaleStore().zoom(t,e)}},{key:"zoomAtDataIndex",value:function(t,e,n){if(w(t)&&w(e)){var i=this._chartPane.chartStore().timeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:i},n)}}},{key:"zoomAtTimestamp",value:function(t,e,n){if(w(t)&&w(e)){var i=at(this._chartPane.chartStore().dataList(),"timestamp",e);this.zoomAtDataIndex(t,i,n)}}},{key:"convertToPixel",value:function(t,e){return this._chartPane.convertToPixel(t,e)}},{key:"convertFromPixel",value:function(t,e){return this._chartPane.convertFromPixel(t,e)}},{key:"subscribeAction",value:function(t,e){lt(t)&&S(e)&&this._chartPane.chartStore().actionStore().subscribe(t,e)}},{key:"unsubscribeAction",value:function(t,e){lt(t)&&this._chartPane.chartStore().actionStore().unsubscribe(t,e)}},{key:"getConvertPictureUrl",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"jpeg",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#FFFFFF";if("png"===e||"jpeg"===e||"bmp"===e)return this._chartPane.getConvertPictureUrl(t,e,n)}},{key:"destroy",value:function(){this._chartPane.destroy()}}]),t}(),bi={},Ei=1,Pi="k_line_chart_",Ci={version:function(){return"8.6.0"},init:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return null;if(!(e=P(t)?document.getElementById(t):t))return null;var i=bi[e.chartId||""];if(i)return i;var r="".concat(Pi).concat(Ei++);return(i=new wi(e,n)).id=r,e.chartId=r,bi[r]=i,i},dispose:function(t){if(t){var e;if(P(t)){var n=document.getElementById(t);e=n&&n.chartId}else e=t instanceof wi?t.id:t&&t.chartId;e&&(bi[e].destroy(),delete bi[e])}},utils:{clone:g,merge:y,isString:P,isNumber:w,isValid:b,isObject:k,isArray:x,isFunction:S,isBoolean:E,formatValue:et,formatPrecision:it,formatBigNumber:rt},extension:d};return Ci.extension.addTechnicalIndicatorTemplate([{name:"AVP",shortName:"AVP",series:"price",precision:2,plots:[{key:"avp",title:"AVP: ",type:"line"}],calcTechnicalIndicator:function(t){var e=0,n=0;return t.map((function(t){var i={};return e+=t.turnover||0,0!==(n+=t.volume||0)&&(i.avp=e/n),i}))}},t,e,n,{name:"EMV",shortName:"EMV",calcParams:[14,9],plots:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=0,r=0,a=[],o=[];return t.forEach((function(e,s){var c={},h=t[s-1]||e,l=e.high,u=e.low,f=e.turnover||0,d=0;0!==f&&(d=((l+u)/2-(h.high+h.low)/2)*(l-u)/f),a.push(d),i+=d,n[0]-1>s||(c.emv=i,i-=a[s-(n[0]-1)],r+=c.emv,n[0]+n[1]-2>s||(c.maEmv=r/n[1],r-=o[s-(n[1]-1)].emv)),o.push(c)})),o}},{name:"EMA",shortName:"EMA",series:"price",calcParams:[6,12,20],precision:2,shouldCheckParamCount:!1,shouldOhlc:!0,plots:[{key:"ema6",title:"EMA6: ",type:"line"},{key:"ema12",title:"EMA12: ",type:"line"},{key:"ema20",title:"EMA20: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t){return{key:"ema".concat(t),title:"EMA".concat(t,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var n=e.params,i=e.plots,r=0,a=[];return t.map((function(t,e){var o={},s=t.close;return r+=s,n.forEach((function(t,n){t-1>e||(a[n]=e>t-1?(2*s+(t-1)*a[n])/(t+1):r/t,o[i[n].key]=a[n])})),o}))}},{name:"MA",shortName:"MA",series:"price",calcParams:[5,10,30,60],precision:2,shouldCheckParamCount:!1,shouldOhlc:!0,plots:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t){return{key:"ma".concat(t),title:"MA".concat(t,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var n=e.params,i=e.plots,r=[];return t.map((function(e,a){var o={},s=e.close;return n.forEach((function(e,n){r[n]=(r[n]||0)+s,e-1>a||(o[i[n].key]=r[n]/e,r[n]-=t[a-(e-1)].close)})),o}))}},i,{name:"SMA",shortName:"SMA",series:"price",calcParams:[12,2],precision:2,plots:[{key:"sma",title:"SMA: ",type:"line"}],shouldCheckParamCount:!0,shouldOhlc:!0,calcTechnicalIndicator:function(t,e){var n=e.params,i=0,r=0;return t.map((function(t,e){var a={},o=t.close;return i+=o,n[0]-1>e||(a.sma=r=e>n[0]-1?(o*n[1]+r*(n[0]-n[1]+1))/(n[0]+1):i/n[0]),a}))}},{name:"TRIX",shortName:"TRIX",calcParams:[12,9],plots:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n,i,r,a=e.params,o=0,s=0,c=0,h=0,l=[];return t.forEach((function(t,e){var u={},f=t.close;if(o+=f,e>=a[0]-1&&(s+=n=e>a[0]-1?(2*f+(a[0]-1)*n)/(a[0]+1):o/a[0],e>=2*a[0]-2&&(c+=i=e>2*a[0]-2?(2*n+(a[0]-1)*i)/(a[0]+1):s/a[0],e>=3*a[0]-3))){var d,p=0;e>3*a[0]-3?p=((d=(2*i+(a[0]-1)*r)/(a[0]+1))-r)/r*100:d=c/a[0],r=d,u.trix=p,h+=p,3*a[0]+a[1]-4>e||(u.maTrix=h/a[1],h-=l[e-(a[1]-1)].trix)}l.push(u)})),l}},{name:"BRAR",shortName:"BRAR",calcParams:[26],plots:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=0,r=0,a=0,o=0;return t.map((function(e,s){var c={},h=e.high,l=e.low,u=e.open,f=(t[s-1]||e).close;if(a+=h-u,o+=u-l,i+=h-f,r+=f-l,s>=n[0]-1){c.ar=0!==o?a/o*100:0,c.br=0!==r?i/r*100:0;var d=t[s-(n[0]-1)],p=d.high,v=d.low,_=d.open,m=(t[s-n[0]]||t[s-(n[0]-1)]).close;i-=p-m,r-=m-v,a-=p-_,o-=_-v}return c}))}},r,{name:"MTM",shortName:"MTM",calcParams:[12,6],plots:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=0,r=[];return t.forEach((function(e,a){var o={};a<n[0]||(o.mtm=e.close-t[a-n[0]].close,i+=o.mtm,n[0]+n[1]-1>a||(o.maMtm=i/n[1],i-=r[a-(n[1]-1)].mtm)),r.push(o)})),r}},{name:"PSY",shortName:"PSY",calcParams:[12,6],plots:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=0,r=0,a=[],o=[];return t.forEach((function(e,s){var c={},h=e.close-(t[s-1]||e).close>0?1:0;a.push(h),i+=h,n[0]-1>s||(c.psy=i/n[0]*100,r+=c.psy,n[0]+n[1]-2>s||(c.maPsy=r/n[1],r-=o[s-(n[1]-1)].psy),i-=a[s-(n[0]-1)]),o.push(c)})),o}},{name:"ROC",shortName:"ROC",calcParams:[12,6],shouldCheckParamCount:!0,plots:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=[],r=0;return t.forEach((function(e,a){var o={};if(a>=n[0]-1){var s=(t[a-n[0]]||t[a-(n[0]-1)]).close;o.roc=0!==s?(e.close-s)/s*100:0,r+=o.roc,n[0]-1+n[1]-1>a||(o.maRoc=r/n[1],r-=i[a-(n[1]-1)].roc)}i.push(o)})),i}},{name:"VR",shortName:"VR",calcParams:[26,6],plots:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=0,r=0,a=0,o=0,s=[];return t.forEach((function(e,c){var h={},l=e.close,u=(t[c-1]||e).close,f=e.volume;if(l>u?i+=f:u>l?r+=f:a+=f,c>=n[0]-1){var d=a/2;h.vr=r+d===0?0:(i+d)/(r+d)*100,o+=h.vr,n[0]+n[1]-2>c||(h.maVr=o/n[1],o-=s[c-(n[1]-1)].vr);var p=t[c-(n[0]-1)],v=t[c-n[0]]||p,_=p.close,m=p.volume;_>v.close?i-=m:v.close>_?r-=m:a-=m}s.push(h)})),s}},a,{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],shouldCheckParamCount:!1,plots:[{key:"bias6",title:"BIAS6: ",type:"line"},{key:"bias12",title:"BIAS12: ",type:"line"},{key:"bias24",title:"BIAS24: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t){return{key:"bias".concat(t),title:"BIAS".concat(t,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var n=e.params,i=e.plots,r=[];return t.map((function(e,a){var o={},s=e.close;return n.forEach((function(e,c){if(r[c]=(r[c]||0)+s,a>=e-1){var h=r[c]/n[c];o[i[c].key]=(s-h)/h*100,r[c]-=t[a-(e-1)].close}})),o}))}},o,s,h,l,u,f,{name:"OBV",shortName:"OBV",calcParams:[30],plots:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calcTechnicalIndicator:function(t,e){var n=e.params,i=0,r=0,a=[];return t.forEach((function(e,o){var s=t[o-1]||e;s.close>e.close?r-=e.volume:e.close>s.close&&(r+=e.volume);var c={obv:r};i+=r,n[0]-1>o||(c.maObv=i/n[0],i-=a[o-(n[0]-1)].obv),a.push(c)})),a}},{name:"PVT",shortName:"PVT",plots:[{key:"pvt",title:"PVT: ",type:"line"}],calcTechnicalIndicator:function(t){var e=0;return t.map((function(n,i){var r={},a=(t[i-1]||n).close,o=0;return 0!==a&&(o=(n.close-a)/a*n.volume),r.pvt=e+=o,r}))}},{name:"VOL",shortName:"VOL",series:"volume",calcParams:[5,10,20],shouldCheckParamCount:!1,shouldFormatBigNumber:!0,precision:0,minValue:0,plots:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma20",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,color:function(t,e){var n=t.current.kLineData||{};return n.close>n.open?e.bar.upColor:n.open>n.close?e.bar.downColor:e.bar.noChangeColor}}],regeneratePlots:function(t){var e=t.map((function(t){return{key:"ma".concat(t),title:"MA".concat(t,": "),type:"line"}}));return e.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,color:function(t,e){var n=t.current.kLineData||{};return n.close>n.open?e.bar.upColor:n.open>n.close?e.bar.downColor:e.bar.noChangeColor}}),e},calcTechnicalIndicator:function(t,e){var n=e.params,i=e.plots,r=[];return t.map((function(e,a){var o=e.volume||0,s={volume:o};return n.forEach((function(e,n){r[n]=(r[n]||0)+o,e-1>a||(s[i[n].key]=r[n]/e,r[n]-=t[a-(e-1)].volume)})),s}))}}]),Ci.extension.addShapeTemplate([{name:"horizontalRayLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return zt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,n={x:0,y:e[0].y};return e[1]&&e[1].x>e[0].x&&(n.x=t.viewport.width),[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[e[0],n]]}]},performEventPressedMove:function(t){var e=t.points,n=t.pressPoint;e[0].value=n.value,e[1].value=n.value},performEventMoveForDrawing:function(t){2===t.step&&(t.points[0].value=t.movePoint.value)}},{name:"horizontalSegment",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Vt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,n=[];return 2===e.length&&(n=[e]),[{type:"line",isDraw:!0,isCheck:!0,dataSource:n}]},performEventPressedMove:function(t){var e=t.points,n=t.pressPoint;e[0].value=n.value,e[1].value=n.value},performEventMoveForDrawing:function(t){2===t.step&&(t.points[0].value=t.movePoint.value)}},{name:"horizontalStraightLine",totalStep:2,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return jt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:0,y:e[0].y},{x:t.viewport.width,y:e[0].y}]]}]}},{name:"verticalRayLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return zt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,n={x:e[0].x,y:0};return e[1]&&e[1].y>e[0].y&&(n.y=t.viewport.height),[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[e[0],n]]}]},performEventPressedMove:function(t){var e=t.points,n=t.pressPoint;e[0].timestamp=n.timestamp,e[0].dataIndex=n.dataIndex,e[1].timestamp=n.timestamp,e[1].dataIndex=n.dataIndex},performEventMoveForDrawing:function(t){var e=t.points,n=t.movePoint;2===t.step&&(e[0].timestamp=n.timestamp,e[0].dataIndex=n.dataIndex)}},{name:"verticalSegment",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Vt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,n=[];return 2===e.length&&(n=[e]),[{type:"line",isDraw:!0,isCheck:!0,dataSource:n}]},performEventPressedMove:function(t){var e=t.points,n=t.pressPoint;e[0].timestamp=n.timestamp,e[0].dataIndex=n.dataIndex,e[1].timestamp=n.timestamp,e[1].dataIndex=n.dataIndex},performEventMoveForDrawing:function(t){var e=t.points,n=t.movePoint;2===t.step&&(e[0].timestamp=n.timestamp,e[0].dataIndex=n.dataIndex)}},{name:"verticalStraightLine",totalStep:2,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return jt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:e[0].x,y:0},{x:e[0].x,y:t.viewport.height}]]}]}},{name:"rayLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return zt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e,n,i,r=t.coordinates,a=t.viewport;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[(e=r[0],n=r[1],i={x:a.width,y:a.height},e&&n?[e,e.x===n.x&&e.y!==n.y?n.y>e.y?{x:e.x,y:i.y}:{x:e.x,y:0}:e.x>n.x?{x:0,y:Nt(e,n,{x:0,y:e.y})}:{x:i.x,y:Nt(e,n,{x:i.x,y:e.y})}]:[])]}]}},{name:"segment",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Vt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,n=[];return 2===e.length&&(n=[e]),[{type:"line",isDraw:!0,isCheck:!0,dataSource:n}]}},{name:"straightLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return jt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,n=t.viewport;return 2>e.length||e[0].x===e[1].x?[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:e[0].x,y:0},{x:e[0].x,y:n.height}]]}]:[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:0,y:Nt(e[0],e[1],{x:0,y:e[0].y})},{x:n.width,y:Nt(e[0],e[1],{x:n.width,y:e[0].y})}]]}]}},{name:"parallelStraightLine",totalStep:4,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return jt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.viewport;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:Wt(t.coordinates,{x:e.width,y:e.height})}]}},{name:"priceChannelLine",totalStep:4,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return jt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.viewport;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:Wt(t.coordinates,{x:e.width,y:e.height},1)}]}},{name:"priceLine",totalStep:2,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return zt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[e[0],{x:t.viewport.width,y:e[0].y}]]},{type:"text",isDraw:!0,isCheck:!1,dataSource:[{x:e[0].x,y:e[0].y,text:t.points[0].value.toFixed(t.precision.price)}]}]}},{name:"fibonacciLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return jt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.points,n=t.coordinates,i=t.precision;if(n.length>0){var r=[],a=[],o=t.viewport.width;if(n.length>1){var s=n[0].y-n[1].y,c=e[0].value-e[1].value;[1,.786,.618,.5,.382,.236,0].forEach((function(t){var h=n[1].y+s*t,l=(e[1].value+c*t).toFixed(i.price);r.push([{x:0,y:h},{x:o,y:h}]),a.push({x:0,y:h,text:"".concat(l," (").concat((100*t).toFixed(1),"%)")})}))}return[{type:"line",isDraw:!0,isCheck:!0,dataSource:r},{type:"text",isDraw:!0,isCheck:!1,dataSource:a}]}return[]}}]),Ci}))},5938:function(t,e,n){"use strict";t.exports=n(1820)},9093:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return I}});var i=n(3396),r=n(7139);const a={class:"common-layout"},o=(0,i._)("h1",null,"均线推演工具",-1),s=(0,i._)("span",{class:"text-gray-500"},"-",-1),c=(0,i.Uk)("加载数据"),h=(0,i._)("div",{id:"technical-indicator-k-line",class:"k-line-chart"},null,-1),l={class:"k-line-chart-menu-container",style:{"margin-top":"10px"}},u=(0,i._)("span",{style:{"padding-right":"10px"}},"主图指标",-1),f=(0,i._)("span",{style:{"padding-right":"10px","padding-left":"12px"}},"副图指标",-1),d=(0,i.Uk)(" copyright © 2022 All rights reserved. ");function p(t,e,n,p,v,_){const m=(0,i.up)("el-header"),y=(0,i.up)("el-input"),g=(0,i.up)("el-col"),x=(0,i.up)("el-form-item"),S=(0,i.up)("el-option"),k=(0,i.up)("el-select"),w=(0,i.up)("el-input-number"),b=(0,i.up)("el-button"),E=(0,i.up)("el-form"),P=(0,i.up)("el-main"),C=(0,i.up)("el-footer"),A=(0,i.up)("el-container");return(0,i.wg)(),(0,i.iD)("div",a,[(0,i.Wm)(A,null,{default:(0,i.w5)((()=>[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[o])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(E,{"label-width":"120px","label-position":"left"},{default:(0,i.w5)((()=>[(0,i.Wm)(x,{label:"交易对"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{span:11},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{modelValue:t.token0,"onUpdate:modelValue":e[0]||(e[0]=e=>t.token0=e),placeholder:"币0"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(g,{span:2,class:"text-center"},{default:(0,i.w5)((()=>[s])),_:1}),(0,i.Wm)(g,{span:11},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{modelValue:t.token1,"onUpdate:modelValue":e[1]||(e[1]=e=>t.token1=e),placeholder:"币1"},null,8,["modelValue"])])),_:1})])),_:1}),(0,i.Wm)(x,{label:"周期"},{default:(0,i.w5)((()=>[(0,i.Wm)(k,{modelValue:t.interval,"onUpdate:modelValue":e[2]||(e[2]=e=>t.interval=e),placeholder:"周期"},{default:(0,i.w5)((()=>[(0,i.Wm)(S,{label:"15分钟",value:"15m"}),(0,i.Wm)(S,{label:"30分钟",value:"30m"}),(0,i.Wm)(S,{label:"1小时",value:"1h"}),(0,i.Wm)(S,{label:"2小时",value:"2h"}),(0,i.Wm)(S,{label:"4小时",value:"4h"}),(0,i.Wm)(S,{label:"6小时",value:"6h"}),(0,i.Wm)(S,{label:"8小时",value:"8h"}),(0,i.Wm)(S,{label:"12小时",value:"12h"}),(0,i.Wm)(S,{label:"1日",value:"1d"}),(0,i.Wm)(S,{label:"3日",value:"3d"}),(0,i.Wm)(S,{label:"周",value:"1w"}),(0,i.Wm)(S,{label:"月",value:"1M"})])),_:1},8,["modelValue"])])),_:1}),(0,i.Wm)(x,{label:"向后推演次数"},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{modelValue:t.deductionCount,"onUpdate:modelValue":e[3]||(e[3]=e=>t.deductionCount=e),min:0,max:300,onChange:_.handleNumberChange},null,8,["modelValue","onChange"])])),_:1}),(0,i.Wm)(x,null,{default:(0,i.w5)((()=>[(0,i.Wm)(b,{type:"primary",onClick:_.initData},{default:(0,i.w5)((()=>[c])),_:1},8,["onClick"])])),_:1})])),_:1}),h,(0,i._)("div",l,[u,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.mainTechnicalIndicatorTypes,(t=>((0,i.wg)(),(0,i.j4)(b,{key:t,onClick:e=>_.setCandleTechnicalIndicator(t)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,r.zw)(t),1)])),_:2},1032,["onClick"])))),128)),f,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.subTechnicalIndicatorTypes,(t=>((0,i.wg)(),(0,i.j4)(b,{key:t,onClick:e=>_.setSubTechnicalIndicator(t)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,r.zw)(t),1)])),_:2},1032,["onClick"])))),128))])])),_:1}),(0,i.Wm)(C,{style:{"margin-top":"200px"}},{default:(0,i.w5)((()=>[d])),_:1})])),_:1})])}var v=n(5938),_=n(6265),m=n.n(_);function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(7629),n(1703);class g extends Error{constructor(t,e,n=g.CODE,i={}){super(t),y(this,"_code",g.CODE),y(this,"_msg",void 0),y(this,"_sourceError",void 0),y(this,"_detail",{}),this.name="BasicException",this._msg=t,this._code=n,this._sourceError=e,this._detail=i}get code(){return this._code}get msg(){return this._msg}get detail(){return this._detail}get sourceError(){return this._sourceError}toString(){return`${this._msg}`}}y(g,"CODE",400);const x=t=>!t||""===t||0===t.length;class S{constructor(){y(this,"logShow",!0),y(this,"errorShow",!0)}setLogShow(t){this.logShow=t}setErrorShow(t){this.errorShow=t}print(...t){this.logShow&&console.log(1===t.length?t[0]:t)}error(...t){this.errorShow&&console.error(t)}}const k=new S;class w{constructor(t){y(this,"baseApi",void 0),this.baseApi=t}async getKline(t,e,n,i){const r={symbol:t,interval:e};x(n)||(r["startTime"]=n),x(i)||(r["endTime"]=i);const a=await this.baseApi.request("https://api.binance.com/api/v3/klines","get",r,{});return a.map((t=>({timestamp:parseInt(t[0],10),open:parseFloat(t[1]),high:parseFloat(t[2]),low:parseFloat(t[3]),close:parseFloat(t[4]),volume:parseFloat(t[5])})))}async getAllKline(t,e){const n="";let i="";const r=[];while(1){const a=await this.getKline(t,e,n,i);if(0==a.length)break;if(i=Number(a[0].timestamp-1).toString(),a.reverse(),r.push(...a),r.length>2e3)break}return r.reverse(),r}}class b{async request(t,e,n,i={headers:{}}){return await new Promise(((r,a)=>{const o=t,s={url:o,method:e,params:void 0,data:void 0,headers:{}};["get","delete"].indexOf(e.toLowerCase())>-1?s.params=n:s.data=n,i.headers&&(s.headers=i.headers),m()(s).then((t=>{k.print(`request success ${e} ${o} data =`,n,"result = ",t.data),r(t.data)})).catch((t=>{k.print(`request error ${e} ${o} data =`,n,"error = ",t);const i="Network Error";a(i)}))}))}getBinanceApi(){return new w(this)}}const E=new b;var P=n(4775),C=n(7462),A={name:"HomeView",data:function(){return{token0:this.$store.state.token0,token1:this.$store.state.token1,interval:this.$store.state.interval,deductionCount:this.$store.state.deductionCount,mainTechnicalIndicatorTypes:["MA","BOLL"],subTechnicalIndicatorTypes:["VOL","MACD","KDJ"]}},mounted:function(){this.kLineChart=(0,v.init)("technical-indicator-k-line"),this.kLineChart.setPriceVolumePrecision(6,6),this.paneId=this.kLineChart.createTechnicalIndicator("VOL",!1),this.initData()},methods:{handleNumberChange(t){this.deductionCount=t},async initData(){const t=P.kN.service({fullscreen:!0});try{this.kLineChart.clearData();let e=await E.getBinanceApi().getAllKline(this.token0+this.token1,this.interval);if(parseInt(this.deductionCount,10)>0&&e.length>10){let t=e[e.length-1],n=e[e.length-2],i=t.timestamp-n.timestamp;for(let r=0;r<parseInt(this.deductionCount,10);r++)e.push({open:t.close,high:t.close,low:t.close,close:t.close,volume:0,timestamp:t.timestamp+i*(r+1)})}this.$store.commit(C.V,{token0:this.token0,token1:this.token1,interval:this.interval,deductionCount:this.deductionCount}),k.print("SHOW",e),this.kLineChart.applyNewData(e)}finally{t.close()}},setCandleTechnicalIndicator:function(t){this.kLineChart.createTechnicalIndicator(t,!1,{id:"candle_pane"})},setSubTechnicalIndicator:function(t){this.kLineChart.createTechnicalIndicator(t,!1,{id:this.paneId})}},unmounted:function(){(0,v.dispose)("technical-indicator-k-line")}},O=n(89);const T=(0,O.Z)(A,[["render",p]]);var I=T}}]);
//# sourceMappingURL=93.289c4c28.js.map